"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9798],{69798:(Se,U,c)=>{c.r(U),c.d(U,{NotificationsModule:()=>be});var B=c(36895),T=c(24006),q=c(65673),H=c(93144),p=c(54463),j=c(32174),u=c(62510),m=c(15861),G=c(35226),V=c.n(G),P=c(42863),S=c(71568),e=c(94650),_=c(47561),E=c(28168),F=c(30578),y=c(42786),g=c(6756),L=c(71238),s=c(32236),O=c(27601),Q=c(65412),C=c(70057),z=c(30958),I=c(37415),x=c(88425),v=c(3848);function K(r,Y){if(1&r){const i=e.EpF();e.TgZ(0,"span",11)(1,"span",12),e.NdJ("click",function(){e.CHM(i);const t=e.oxw();return e.KtG(t.getMobileNotifications("UNREAD"))}),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"span",13),e._uU(5),e.qZA()()}if(2&r){const i=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,2,"COMMON_BUTTONS.BUTTON_UNREAD")),e.xp6(3),e.hij("(",i.unReadCount,")")}}function W(r,Y){if(1&r){const i=e.EpF();e.TgZ(0,"span",14)(1,"span",12),e.NdJ("click",function(){e.CHM(i);const t=e.oxw();return e.KtG(t.getMobileNotifications("READ"))}),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"span",13),e._uU(5),e.qZA()()}if(2&r){const i=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,2,"COMMON_BUTTONS.BUTTON_READ")),e.xp6(3),e.hij("(",i.readCount,")")}}let X=(()=>{class r extends _.O{dialog;commonService;route;translateService;columnheaders;toastController;listingVariables;router;platform;_sharedService;uiUtils;actionSheetController;notificationService;loggerService;dataTable;searchValueChange=new e.vpe;actions;checkboxDefault;data;enterpriseId;fabMobileactions;forceRefresh=!1;lastsync;mobileRoutesArray;noDuplicates=void 0;notificationCount;notificationSubscription;notificationsListData;notificationsMobileListData;show=!1;readCount;routingData;searchString;statObj;status;statusObj;statusOptions;storageSyncDate;sweetAlertDelete;sweetAlertRead;sweetAlertUnRead;syncEnabled=!1;syncFreq;tableColumnheaders;unReadCount;userId;statsObj;createdDate;loginUserDateFormat;moduleDataJson;dataJsonObj={};constructor(i,a,t,o,n,d,l,b,f,h,N,fe,Oe,Te){super(t,a),this.dialog=i,this.commonService=a,this.route=t,this.translateService=o,this.columnheaders=n,this.toastController=d,this.listingVariables=l,this.router=b,this.platform=f,this._sharedService=h,this.uiUtils=N,this.actionSheetController=fe,this.notificationService=Oe,this.loggerService=Te,this.route.queryParams.subscribe(J=>{this.dataJsonObj.queryParamsObj={defaultView:J.default_view,selectedMenuId:J.selectedMenuId,selectedSubMenuId:J.selectedSubMenuId}})}ngOnInit(){document.getElementsByTagName("body"),this.initializeComponent()}initializeComponent(){this.showSpinner(),this.dataJsonObj.pageName=s.hf.NOTIFICATIONS,this.dataJsonObj.advancedSearchObj={},this.dataJsonObj.htmlPageRolesEnumValuesJson={pageEnum:s.hf,pageSettingEnum:s.AM,pageSettingFieldsEnum:s.In},JSON.parse(localStorage.getItem(s.BU.MENU_CLICK_ITEM)),this.dataJsonObj.pageTitle=[{key:"COMMON_FIELDS.ALL",value:"",showSubMenuDisplayName:!1},{key:"COMMON_PAGE_TITLES.NOTIFICATIONS",value:"",showSubMenuDisplayName:!1}],this.commonService.trackView(s.sn.NOTIFICATION_LIST),this.tableColumnheaders=this.columnheaders.getNotificationHeaders(),this.sweetAlertDelete=s.Mi.DELETEBASIC,this.sweetAlertRead=s.Mi.READBASIC,this.sweetAlertUnRead=s.Mi.UNREADBASIC,this.enterpriseId=localStorage.getItem(s.BU.SELECTED_ENTERPRISE),this.userId=localStorage.getItem(s.BU.LOG_IN_USER_ID),this.listingVariables.pageNumbers=1,this.commonService.getMobileViewCondition(this.dataJsonObj.selectedDisplayView)&&(this.status=s.ox.MESSAGE_UNREAD),this.listingVariables.totalRecords=1,this.searchString="";const a=this.commonService.getLoginUserTimeZoneDateFormat();this.loginUserDateFormat=a.dateFormat,this.getModuleJsonData(),this.commonService.currentEvent.subscribe(t=>{"notifications"===t&&(this.forceRefresh=!0)}),this.actions={EDIT:this.roleRightsValidationByPage(s.hf.NOTIFICATIONS,s.AM.ACTIONS,s.In.EDIT),READ:this.roleRightsValidationByPage(s.hf.NOTIFICATIONS,s.AM.ACTIONS,s.In.VIEW),UNREAD:this.roleRightsValidationByPage(s.hf.NOTIFICATIONS,s.AM.ACTIONS,s.In.UNREAD),DELETE:this.roleRightsValidationByPage(s.hf.NOTIFICATIONS,s.AM.ACTIONS,s.In.DELETE),PUBLISH:this.roleRightsValidationByPage(s.hf.NOTIFICATIONS,s.AM.ACTIONS,s.In.PUBLISH),JOINCALL:this.roleRightsValidationByPage(s.hf.NOTIFICATIONS,s.AM.ACTIONS,s.In.JOINCALL),VIEW:this.roleRightsValidationByPage(s.hf.NOTIFICATIONS,s.AM.ACTIONS,s.In.VIEW)},this.getsyncSettings(),this.dataJsonObj.addFiltersList=[],this.dataJsonObj.pageActionsList=[],this.roleRightsValidationByPage(s.hf.NOTIFICATIONS,s.AM.ACTIONS,s.In.CREATE)&&this.dataJsonObj.pageActionsList.push({actionName:"CREATE",displayName:"COMMON_BUTTONS.BUTTON_CREATE",actionType:s.gL.URL,redirectURL:"/notifications/create",queryParams:"",iconClass:"fas fa-plus"}),this.roleRightsValidationByPage(s.hf.NOTIFICATIONS,s.AM.ACTIONS,s.In.FILTERS)}getModuleJsonData(){var i=this;return(0,m.Z)(function*(){i.moduleDataJson=yield i.commonService.getDynamicJson(i.enterpriseId,"module_manager","view")})()}getsyncSettings(){var i=this;return(0,m.Z)(function*(){const a=yield i.commonService.getCacheSettings(s.hf.NOTIFICATIONS);i.syncEnabled=a.cacheEnabled,i.syncFreq=a.syncFreq,i.forceRefresh=a.forceRefresh,i.syncEnabled&&i.getAllRecords()})()}getSearchResults(i){this.listingVariables.pageNumbers=1,this.listingVariables.totalRecords=1,this.searchString=i,this.searchValueChange.emit(i),this.syncEnabled||this.getAllRecords(),this.dataTable&&this.dataTable.reset()}searchClose(){this.listingVariables.pageNumbers=1,this.listingVariables.totalRecords=1,this.searchString="",this.searchValueChange.emit(""),this.syncEnabled||this.getAllRecords(),this.dataTable&&this.dataTable.reset()}ngOnDestroy(){this.notificationSubscription&&(this.notificationSubscription.unsubscribe(),this.notificationSubscription=void 0),this.dataJsonObj.selectedFilter=""}getAllRecords(){try{this.notificationSubscription&&(this.notificationSubscription.unsubscribe(),this.notificationSubscription=void 0);const i=this.commonService.getMobileViewCondition(this.dataJsonObj.selectedDisplayView),a=this.dataJsonObj.selectedFilter?"&filtertype="+this.dataJsonObj.selectedFilter:"";this.showSpinner(),this.notificationSubscription=this.notificationService.getAll(this.searchString,this.listingVariables.pageNumbers,this.listingVariables.rowsPerPage,this.listingVariables.sortOrderColumn,this.enterpriseId,this.status,this.userId,this.syncFreq,!0,this.forceRefresh,this.statsObj,i,a,this.dataJsonObj.advancedSearchObj.inputAdvSearchObj).subscribe(t=>{if(this.hideSpinner(),(this.syncEnabled||this.forceRefresh)&&1===this.listingVariables.pageNumbers&&(this.notificationsMobileListData=[],this.notificationsListData=[]),this.readCount=t.readCount,this.unReadCount=t.unReadCount,t.rows.length>0){this.notificationsListData=[],this.notificationsMobileListData&&this.notificationsMobileListData.length>0||(this.notificationsMobileListData=[]);for(let o=0;o<t.rows.length;o++){t.rows[o].imageDisplay=t.rows[o].created_by&&t.rows[o].created_by.user_image_path&&t.rows[o].created_by.user_image_name?t.rows[o].created_by.user_image_path+"/"+t.rows[o].created_by.user_image_name:null,t.rows[o].display_grid_title=t.rows[o].enterprise.short_name,t.rows[o].page_name="Notifications",t.rows[o].imageName=t.rows[o].created_by?t.rows[o].created_by.f_name+" "+t.rows[o].created_by.l_name:"",t.rows[o].short_name=t.rows[o].enterprise.short_name,t.rows[o].enterprise&&(t.rows[o].enterprise.short_name='<a class="enable" id="enterprise.short_name'+t.rows[o]._id+'"  href="enterprises/enterprises/'+t.rows[o].enterprise.enterprise_id+'/view" >'+t.rows[o].enterprise.short_name),this.createdDate=this.commonService.getDateObj(t.rows[o].createdAt,this.loginUserDateFormat),t.rows[o].createdAt=this.commonService.getDateObj(t.rows[o].createdAt,this.loginUserDateFormat),t.rows[o].object.object_type.page_display_name=this.moduleDataJson&&this.moduleDataJson[t.rows[o].object.object_type.page_id+""]?this.moduleDataJson[t.rows[o].object.object_type.page_id+""].page_display_name:"",t.rows[o].notificationType=this.lookupLanguageTranslations(t.rows[o].notification_type.lookup_id),t.rows[o].notification_status=!0===t.rows[o].is_published?s.v4.PUBLISH:s.v4.DRAFT,t.rows[o].is_published=!!t.rows[o].is_published;for(let l=0;l<t.rows[o].notification_members.length;l++)if(t.rows[o].notification_members[l].user_profile.user_profile_id===parseInt(localStorage.getItem(s.BU.LOG_IN_USER_ID),10)){t.rows[o].user_profile_id=t.rows[o].notification_members[l].user_profile.user_profile_id?t.rows[o].notification_members[l].user_profile.user_profile_id:t.rows[o].notification_members[l].group.group_id,t.rows[o].readStatus=!!t.rows[o].notification_members[l].user_profile.is_read,t.rows[o].read_statusvalue=!!t.rows[o].notification_members[l].user_profile.is_read,t.rows[o].read_status=t.rows[o].notification_members[l].user_profile.is_read?s.v4.READ:s.v4.UNREAD;break}const n={url:`notifications/${t.rows[o]._id}/view`,queryParams:this.dataJsonObj.queryParamsObj?this.dataJsonObj.queryParamsObj:""},d=n.queryParams&&Object.keys(n.queryParams).length>0?`${n.url}?${JSON.stringify(n.queryParams)}`:n.url;t.rows[o].notification_message=`<a class="enable" id="notification_message${t.rows[o]._id}" href=${d}>${t.rows[o].notification_message}`,this.notificationsMobileListData=this.notificationsMobileListData.filter(l=>l._id!==t.rows[o]._id),this.notificationsMobileListData.push(t.rows[o])}t.totalCount&&(this.listingVariables.totalRecords=t.totalCount),1===this.listingVariables.pageNumbers&&(this.listingVariables.totalpages=t.pages),this.dataJsonObj.isLoadMoreClicked?(this.dataJsonObj.isLoadMoreClicked=!1,this.notificationsListData=this.notificationsListData.concat(t.rows)):this.notificationsListData=t.rows,this.dataTable&&this.dataTable.resetHeaderCheckbox(),this.sweetAlertDelete=s.Mi.DELETEBASIC,this.sweetAlertRead=s.Mi.READBASIC,this.sweetAlertUnRead=s.Mi.UNREADBASIC,this._sharedService.emitChangeNotifications("")}else this.notificationsListData=[],this.notificationsMobileListData=[]},t=>{this.hideSpinner(),this.loggerService.setLoggerError(this.constructor.name,"getAllRecords",t)})}catch(i){this.hideSpinner(),this.loggerService.setLoggerError(this.constructor.name,"getAllRecords",i)}}loadPageData(i){this.forceRefresh=i.forceRefresh,this.listingVariables.pageNumbers=i.listingVariables.pageNumbers,"read_status"===this.listingVariables.sortColumn&&(this.listingVariables.sortColumn="read_status.lookup_name"),i.clearMobileData&&(this.notificationsMobileListData=this.noDuplicates),i.isPaginationChange&&(this.dataJsonObj.selectedFilter=i.selectedFilterType,this.dataJsonObj.isLoadMoreClicked=i.isLoadMoreClicked,this.dataJsonObj.advancedSearchObj.inputAdvSearchObj=i.selectedAdvancedSearchObj),this.getAllRecords()}getRedirectNotification(i){const a={read_status:this.statusObj,notification_members:i.notification_members};this.routingData=i,this.notificationService.getStatusUpdate(i._id,a).then(t=>{i.object.object_type.page_display_name===s.hf.Surveys?this.router.navigate(["/surveys/surveys/"+this.routingData.object.object_id+"/mobileview"]):i.object.object_type.page_display_name===s.hf.POLLS?this.router.navigate(["/polls/polls/"+this.routingData.object.object_id+"/mobileview"]):i.object.object_type.page_display_name===s.hf.GROUPS?this.router.navigate(["/groups/groups/"+this.routingData.object.object_id+"/mobileview"]):i.object.object_type.page_display_name===s.hf.EVENT?this.router.navigate(["/events/events/"+this.routingData.object.object_id+"/mobileview"]):i.object.object_type.page_display_name===s.hf.PROJECTS?this.router.navigate(["/donateprojects/donateprojects/"+this.routingData.object.object_id+"/mobileview"]):i.object.object_type.page_display_name===s.hf.POSTS&&this.commonService.redirectToUrl(["..",this.routingData.object.object_id,"view"],!0,!0,this.dataJsonObj.queryParamsObj?this.dataJsonObj.queryParamsObj:"",this.route)}).catch(t=>{this.loggerService.setLoggerError(this.constructor.name,"getRedirectNotification",t)})}toggle(){this.show=!this.show}statusData(i){try{this.statsObj=i.value,this.forceRefresh=!0,this.status="",this.listingVariables.pageNumbers=1,this.notificationsMobileListData=[],this.notificationsListData=[],this.dataTable.reset(),this.getAllRecords()}catch(a){this.loggerService.setLoggerError(this.constructor.name,"statusData",a)}}onActionClicked(i){const o=i.data.object.object_name.split(":")[1];i.action===s.A0.EDIT?(this.router.routeReuseStrategy.clearModuleRouteCache("notifications"),this.router.navigate(["/notifications/"+i.data._id+"/edit"])):i.action===s.A0.DELETE?this.deleteRecord(i.data._id):i.action===s.A0.READ?this.getReadNotifications(i.data):i.action===s.A0.UNREAD?this.getUnReadNotifications(i.data):i.action===s.A0.PUBLISH?this.publishRecord(i.data._id,i.data):i.action===s.A0.JOINCALL?(this.router.routeReuseStrategy.clearModuleRouteCache("notifications"),this.router.navigate(["call/"+o])):i.action===s.A0.VIEW&&this.commonService.redirectToUrl(["..",i.data._id,"view"],!0,!0,this.dataJsonObj.queryParamsObj?this.dataJsonObj.queryParamsObj:"",this.route)}createNotification(){this.router.navigate(["/notifications/create"])}getReadNotifications(i){this.notificationService.getStatusUpdate(i._id,{is_read:!0,notification_members:i.notification_members}).then(t=>{this.uiUtils.displaytoastMessage("COMMON_TOAST_MESSAGES.TOAST_SUCCESS_READ"),this.router.routeReuseStrategy.clearModuleRouteCache("notifications");const n=this.notificationsListData.findIndex(d=>d._id===parseInt(i._id,10));this.notificationsListData[n].read_statusvalue=!0,this.dataTable.statsDataLoad(this.searchString)}).catch(t=>{this.loggerService.setLoggerError(this.constructor.name,"getReadNotifications",t)})}getUnReadNotifications(i){this.notificationService.getStatusUpdate(i._id,{is_read:!1,notification_members:i.notification_members}).then(t=>{this.uiUtils.displaytoastMessage("COMMON_TOAST_MESSAGES.TOAST_SUCCESS_UNREAD"),this.router.routeReuseStrategy.clearModuleRouteCache("notifications");const n=this.notificationsListData.findIndex(d=>d._id===parseInt(i._id,10));this.notificationsListData[n].read_statusvalue=!1,this.dataTable.statsDataLoad(this.searchString),this.checkboxDefault="",this.dataTable&&this.dataTable.resetHeaderCheckbox(),this._sharedService.emitChangeNotifications(""),this.notificationCount=t.result}).catch(t=>{this.loggerService.setLoggerError(this.constructor.name,"getUnReadNotifications",t)})}deleteRecord(i){V().fire({title:"",text:this.translateService.instant("COMMON_CONFIRM_MESSAGES.CONFIRM_RECORD_DELETE"),showCancelButton:!0,cancelButtonText:this.translateService.instant("COMMON_BUTTONS.BUTTON_NO"),confirmButtonText:this.translateService.instant("COMMON_BUTTONS.BUTTON_YES"),customClass:{confirmButton:"btn btn-primary btn-sm mgr-5 mat-raised-button mr-1",cancelButton:"btn btn-danger btn-sm mat-raised-button"}}).then(a=>{a.value?this.notificationService.delete(i).then(t=>{this.uiUtils.displaytoastMessage("COMMON_TOAST_MESSAGES.TOAST_SUCCESS_DELETE"),this.router.routeReuseStrategy.clearModuleRouteCache("notifications"),this.notificationsListData=[],this.notificationsMobileListData=this.noDuplicates,this.dataTable.statsDataLoad(this.searchString),this.getAllRecords(),this.checkboxDefault="",this.dataTable&&this.dataTable.resetHeaderCheckbox()}):(this.checkboxDefault="",this.dataTable&&this.dataTable.resetHeaderCheckbox(),this.getAllRecords())}).catch(a=>{this.loggerService.setLoggerError(this.constructor.name,"deleteRecord",a)})}publishRecord(i,a){V().fire({title:"",text:this.translateService.instant("COMMON_CONFIRM_MESSAGES.CONFIRM_RECORD_PUBLISH"),showCancelButton:!0,cancelButtonText:this.translateService.instant("COMMON_BUTTONS.BUTTON_NO"),confirmButtonText:this.translateService.instant("COMMON_BUTTONS.BUTTON_YES"),customClass:{confirmButton:"btn btn-primary btn-sm mgr-5 mat-raised-button mr-1",cancelButton:"btn btn-danger btn-sm mat-raised-button"}}).then(t=>{t.value?this.notificationService.getPublish(i,{is_published:this.statusObj,enterprise:a.enterprise,object:a.object,notification_type:a.notification_type,created_by:a.created_by._id,updated_by:a.updated_by._id,notification_message:a.notification_message}).then(n=>{this.uiUtils.displaytoastMessage("COMMON_TOAST_MESSAGES.TOAST_SUCCESS_NOTIFICATION_PUBLISH"),this.router.routeReuseStrategy.clearModuleRouteCache("notifications"),this.notificationsListData=[],this.notificationsMobileListData=this.noDuplicates,this.dataTable.statsDataLoad(this.searchString),this.getAllRecords()}):(this.checkboxDefault="",this.dataTable&&this.dataTable.resetHeaderCheckbox(),this.getAllRecords())}).catch(t=>{this.loggerService.setLoggerError(this.constructor.name,"publishRecord",t)})}mobileEventAction(i){try{this.mobileRoutesArray=[],this.roleRightsValidationByPage(s.hf.NOTIFICATIONS,s.AM.ACTIONS,s.In.DELETE)&&this.mobileRoutesArray.push({text:this.translateService.instant("COMMON_BUTTONS.BUTTON_DELETE"),handler:()=>{this.deleteRecord(i._id)}}),this.roleRightsValidationByPage(s.hf.NOTIFICATIONS,s.AM.ACTIONS,s.In.EDIT)&&!i.is_published&&i.user_profile_id===parseInt(localStorage.getItem(s.BU.LOG_IN_USER_ID),10)&&this.mobileRoutesArray.push({text:this.translateService.instant("COMMON_BUTTONS.BUTTON_EDIT"),handler:()=>{this.router.navigate(["/notifications/"+i._id+"/edit"]),this.router.routeReuseStrategy.clearModuleRouteCache("notifications")}}),this.roleRightsValidationByPage(s.hf.NOTIFICATIONS,s.AM.ACTIONS,s.In.PUBLISH)&&!i.is_published&&i.user_profile_id===parseInt(localStorage.getItem(s.BU.LOG_IN_USER_ID),10)&&this.mobileRoutesArray.push({text:this.translateService.instant("COMMON_BUTTONS.BUTTON_PUBLISH"),handler:()=>{this.publishRecord(i._id,i)}}),(this.roleRightsValidationByPage(s.hf.NOTIFICATIONS,s.AM.ACTIONS,s.In.READ)&&!1===i.read_statusvalue||!1===i.readStatus)&&this.mobileRoutesArray.push({text:this.translateService.instant("COMMON_BUTTONS.BUTTON_READ"),handler:()=>{this.getReadNotifications(i)}}),(this.roleRightsValidationByPage(s.hf.NOTIFICATIONS,s.AM.ACTIONS,s.In.UNREAD)&&!0===i.read_statusvalue||!0===i.readStatus)&&this.mobileRoutesArray.push({text:this.translateService.instant("COMMON_BUTTONS.BUTTON_UNREAD"),handler:()=>{this.getUnReadNotifications(i)}}),this.roleRightsValidationByPage(s.hf.NOTIFICATIONS,s.AM.ACTIONS,s.In.VIEW)&&this.mobileRoutesArray.push({text:this.translateService.instant("COMMON_BUTTONS.BUTTON_VIEW"),handler:()=>{this.commonService.redirectToUrl(["..",i.p_id,"view"],!0,!0,this.dataJsonObj.queryParamsObj?this.dataJsonObj.queryParamsObj:"",this.route)}}),this.presentActionSheet(i)}catch(a){this.loggerService.setLoggerError(this.constructor.name,"mobileEventAction",a)}}presentActionSheet(i){var a=this;return(0,m.Z)(function*(){a.mobileRoutesArray.length>0&&(yield(yield a.actionSheetController.create({cssClass:"actionsheet",buttons:a.mobileRoutesArray})).present())})()}getMobileNotifications(i){this.router.routeReuseStrategy.clearModuleRouteCache("notifications"),this.notificationsListData=[],this.notificationsMobileListData=this.noDuplicates,this.status=i,this.listingVariables.pageNumbers=1,this.listingVariables.totalRecords=1,this.forceRefresh=!0,this.getAllRecords()}selectedViewType(i){this.dataJsonObj.selectedDisplayView=i}showSpinner(){this.dataJsonObj.showSpinner=!0}hideSpinner(){this.dataJsonObj.showSpinner=!1}selectedFilterType(i){i?this.dataJsonObj.selectedFilter=i:(this.dataJsonObj.selectedFilter="",this.dataJsonObj.selectedAdvancedSearchObj={})}onPageLevelActionClicked(i){}advancedSearchFilterClicked(i){this.dataJsonObj.selectedAdvancedSearchObj=i}onHeaderItemClick(i){switch(i.type){case"search":this.getSearchResults(i.event);break;case"search_close":this.searchClose();break;case"display_views":this.selectedViewType(i.event);break;case"filters":this.selectedFilterType(i.event);break;case"advanced_search":this.advancedSearchFilterClicked(i.event);break;case"page_actions":this.onPageLevelActionClicked(i.event)}}static \u0275fac=function(a){return new(a||r)(e.Y36(Q.uw),e.Y36(S.v),e.Y36(u.gz),e.Y36(p.sK),e.Y36(P.Y),e.Y36(C.yF),e.Y36(F.v),e.Y36(u.F0),e.Y36(z.t4),e.Y36(L.F),e.Y36(O.s),e.Y36(C.BX),e.Y36(g.g),e.Y36(y.m))};static \u0275cmp=e.Xpm({type:r,selectors:[["app-notifications"]],viewQuery:function(a,t){if(1&a&&e.Gf(E.n,5),2&a){let o;e.iGM(o=e.CRH())&&(t.dataTable=o.first)}},outputs:{searchValueChange:"searchValueChange"},features:[e._Bn([g.g,E.n,P.Y,O.s,F.v]),e.qOj],decls:14,vars:30,consts:[[1,"container-fluid","notifications-list"],[1,"card","bd-0"],["id","stickyHeaderID",1,"card-header","card-header-primary"],[1,"subpage-header-title","w-100",3,"pageName","defaultView","isFabDisplay","pageActionsList","pageTitle","selectedMenuId","selectedSubMenuId","showPageHeaderItems","showDependencySubMenu","headerItemClick"],[1,"d-lg-none","fixed-tabs"],["mat-align-tabs","start",1,"fanguage-tabs"],["mat-tab-label",""],["id","extraPaddingBottomID",1,"card-body","pdt-0"],["id","notification-list",1,"",3,"header","actions","data","totalRecords","listingVariables","totalPages","paginator","mobileListData","expand","statsShow","showRights","statsSearch","selectedDisplayViewType","selectedFilterType","showSpinner","selectedAdvancedSearchObj","pageName","selectedMenuId","selectedSubMenuId","actionClicked","itemClickEvent","redirectionEvent","changeStats","loadPageData"],[1,"mgt-5"],[3,"isFabDisplay","actionsList","selectedAction"],["id","notification-list-unread",1,"fs-13","mg-0","tab-label","d-flex","align-items-center","justify-content-center","parent-tab"],[3,"click"],[1,"mgl-5"],["id","notification-list-read",1,"fs-13","mg-0","tab-label","d-flex","align-items-center","justify-content-center","parent-tab"]],template:function(a,t){1&a&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"app-pageheader",3),e.NdJ("headerItemClick",function(n){return t.onHeaderItemClick(n)}),e.qZA()(),e.TgZ(4,"div",4)(5,"mat-tab-group",5)(6,"mat-tab"),e.YNc(7,K,6,4,"ng-template",6),e.qZA(),e.TgZ(8,"mat-tab"),e.YNc(9,W,6,4,"ng-template",6),e.qZA()()(),e.TgZ(10,"div",7)(11,"app-datatable",8),e.NdJ("actionClicked",function(n){return t.onActionClicked(n)})("itemClickEvent",function(n){return t.getRedirectNotification(n)})("redirectionEvent",function(n){return t.mobileEventAction(n)})("changeStats",function(n){return t.statusData(n)})("loadPageData",function(n){return t.loadPageData(n)}),e.qZA(),e.TgZ(12,"div",9)(13,"app-page-actions",10),e.NdJ("selectedAction",function(n){return t.onPageLevelActionClicked(n)}),e.qZA()()()()()),2&a&&(e.xp6(3),e.Q6J("pageName",t.dataJsonObj.pageName)("defaultView",null==t.dataJsonObj.queryParamsObj?null:t.dataJsonObj.queryParamsObj.defaultView)("isFabDisplay",!1)("pageActionsList",t.dataJsonObj.pageActionsList)("pageTitle",t.dataJsonObj.pageTitle)("selectedMenuId",null==t.dataJsonObj.queryParamsObj?null:t.dataJsonObj.queryParamsObj.selectedMenuId)("selectedSubMenuId",null==t.dataJsonObj.queryParamsObj?null:t.dataJsonObj.queryParamsObj.selectedSubMenuId)("showPageHeaderItems",!0)("showDependencySubMenu",!1),e.xp6(8),e.Q6J("header",t.tableColumnheaders)("actions",t.actions)("data",t.notificationsListData)("totalRecords",t.listingVariables.totalRecords)("listingVariables",t.listingVariables)("totalPages",t.listingVariables.totalpages)("paginator",!0)("mobileListData",t.notificationsMobileListData)("expand",!1)("statsShow",t.show)("showRights",t.roleRightsValidationByPage(t.dataJsonObj.htmlPageRolesEnumValuesJson.pageEnum.NOTIFICATIONS,t.dataJsonObj.htmlPageRolesEnumValuesJson.pageSettingEnum.ACTIONS,t.dataJsonObj.htmlPageRolesEnumValuesJson.pageSettingFieldsEnum.STATS))("statsSearch",t.searchString)("selectedDisplayViewType",t.dataJsonObj.selectedDisplayView)("selectedFilterType",t.dataJsonObj.selectedFilter)("showSpinner",t.dataJsonObj.showSpinner)("selectedAdvancedSearchObj",t.dataJsonObj.selectedAdvancedSearchObj)("pageName",t.dataJsonObj.pageName)("selectedMenuId",null==t.dataJsonObj.queryParamsObj?null:t.dataJsonObj.queryParamsObj.selectedMenuId)("selectedSubMenuId",null==t.dataJsonObj.queryParamsObj?null:t.dataJsonObj.queryParamsObj.selectedSubMenuId),e.xp6(2),e.Q6J("isFabDisplay",!0)("actionsList",t.dataJsonObj.pageActionsList))},dependencies:[E.n,I.q,x.y,v.uD,v.uX,v.SP,p.X$]})}return r})();var D=c(46448),w=c(2387),M=c(56368),R=c(24929),Z=c(11735);function $(r,Y){if(1&r&&(e.TgZ(0,"div",23),e._UZ(1,"app-pageheader",24),e.qZA()),2&r){const i=e.oxw();e.xp6(1),e.Q6J("pageName",i.dataJsonObj.pageName)("pageTitle",i.dataJsonObj.pageTitle)("selectedMenuId",null==i.dataJsonObj.queryParamsObj?null:i.dataJsonObj.queryParamsObj.selectedMenuId)("selectedSubMenuId",null==i.dataJsonObj.queryParamsObj?null:i.dataJsonObj.queryParamsObj.selectedSubMenuId)("showPageHeaderItems",!1)("showDependencySubMenu",!0)("isEditActionEnable",i.dataJsonObj.isEditAction)}}let ee=(()=>{class r extends _.O{formBuilder;route;router;loggerService;commonService;notificationService;_sharedService;navigationService;translateService;createdBy;createdDate;disabled;enterpriseId;lastUpdatedBy;lastUpdatedDate;notificationStatus;notificationsObj=new te;notificationsViewObj;recordID;statusOptions;startDate;loginUserDateFormat;dataJsonObj={};enterpriseTitle=this.getEnterpriseTitle();constructor(i,a,t,o,n,d,l,b,f){super(a,n),this.formBuilder=i,this.route=a,this.router=t,this.loggerService=o,this.commonService=n,this.notificationService=d,this._sharedService=l,this.navigationService=b,this.translateService=f,this.route.params.subscribe(h=>{this.recordID=h.id,this.getRecordById(this.recordID)}),this.route.queryParams.subscribe(h=>{this.dataJsonObj.queryParamsObj={defaultView:h.defaultView,selectedMenuId:h.selectedMenuId,selectedSubMenuId:h.selectedSubMenuId}})}ngOnInit(){document.getElementsByTagName("body"),this.initializeComponent()}initializeComponent(){this.dataJsonObj.pageName=s.hf.NOTIFICATIONS,this.commonService.trackView(s.sn.NOTIFICATION_VIEW);const i=this.commonService.getLoginUserTimeZoneDateFormat();this.loginUserDateFormat=i.dateFormat,this.enterpriseId=localStorage.getItem(s.BU.SELECTED_ENTERPRISE),this.getModuleViewJsonData(),this.dataJsonObj.selectedPage=s.hf.NOTIFICATIONS,this.dataJsonObj.showrecordhistory=this.roleRightsValidationByPage(s.hf.NOTIFICATIONS,s.AM.ACTIONS,s.In.RECORD_HISTORY),this.getDynamicJson([{folderName:"menu_manager",jsonType:"",storingFieldName:"menuDataJson"}])}getDynamicJson(i){var a=this;return(0,m.Z)(function*(){for(let t of i)a.dataJsonObj[t.storingFieldName]=yield a.commonService.getDynamicJson(a.enterpriseId,t.folderName,t.jsonType);a.dataJsonObj.selectedObj={},a.dataJsonObj.selectedObj.recordId=a.recordID,a.dataJsonObj.selectedObj.pageObj=a.dataJsonObj.menuDataJson.filter(t=>t.menu_page.page_name===a.dataJsonObj.selectedPage),a.dataJsonObj.selectedObjEnabled=!0})()}getModuleViewJsonData(){var i=this;return(0,m.Z)(function*(){i.dataJsonObj.moduleViewDataJson=yield i.commonService.getDynamicJson(i.enterpriseId,"module_manager","view")})()}getRecordById(i){try{this.notificationService.get(i).subscribe(a=>{a.notification_type=a.notification_type,this.notificationsViewObj=a,this.dataJsonObj.isEditAction=this.getIsEditAction(this.notificationsViewObj),this.lastUpdatedBy=this.notificationsViewObj.updated_by,this.createdBy=this.notificationsViewObj.created_by,this.enterpriseId=this.notificationsViewObj.enterprise.enterprise_id,this.startDate=this.commonService.getDateObj(this.notificationsViewObj.createdAt,this.loginUserDateFormat),this.notificationStatus=!0===this.notificationsViewObj.is_published?s.v4.PUBLISH:s.v4.DRAFT,this.dataJsonObj.objectTypeValue=this.dataJsonObj.moduleViewDataJson&&this.dataJsonObj.moduleViewDataJson[this.notificationsViewObj.object.object_type.page_id+""]?this.dataJsonObj.moduleViewDataJson[this.notificationsViewObj.object.object_type.page_id+""].page_display_name:"",this.notificationsViewObj.notification_message=this.strip(this.notificationsViewObj.notification_message),this.getReadNotifications(this.recordID,this.notificationsViewObj.notification_members),this.dataJsonObj.pageTitle=[{key:"COMMON_PAGE_TITLES.NOTIFICATION",value:"",showSubMenuDisplayName:!1},{key:"",value:"-",showSubMenuDisplayName:!1},{key:"COMMON_BUTTONS.BUTTON_VIEW",value:"",showSubMenuDisplayName:!1}]},a=>{this.loggerService.setLoggerError(this.constructor.name,"getRecordById",a)})}catch(a){this.loggerService.setLoggerError(this.constructor.name,"getRecordById",a)}}getIsEditAction(i){return!i.is_published&&i.user_profile_id===parseInt(localStorage.getItem(s.BU.LOG_IN_USER_ID),10)}getReadNotifications(i,a){this.notificationsObj.is_read=!0,this.notificationsObj.notification_members=a,this.notificationService.getStatusUpdate(i,this.notificationsObj).then(t=>{this._sharedService.emitChangeNotifications(""),this.router.routeReuseStrategy.clearModuleRouteCache("notifications")},t=>{this.loggerService.setLoggerError(this.constructor.name,"getReadNotifications",t)})}closeButton(){this.commonService.redirectToPreviousUrl()}strip(i){if(void 0!==i)return i.replace(/<(?:.|\n)*?>/gm,"").trim().replace(/\s\s+/g," ")}static \u0275fac=function(a){return new(a||r)(e.Y36(T.qu),e.Y36(u.gz),e.Y36(u.F0),e.Y36(y.m),e.Y36(S.v),e.Y36(g.g),e.Y36(L.F),e.Y36(D.f),e.Y36(p.sK))};static \u0275cmp=e.Xpm({type:r,selectors:[["app-notification-view"]],features:[e._Bn([g.g,S.v]),e.qOj],decls:37,vars:35,consts:[[1,"container-fluid"],[1,"forms-wrapper"],[1,"row","g-0"],[1,"col-md-12"],[1,"card","bdt-0"],["class","card-header card-header-primary","id","stickyHeaderID",4,"ngIf"],[1,"card-body"],[1,"row","form-bs"],[1,"col-md-3"],["disabled","true","id","notification-view-enterprise",3,"label","value"],["disabled","true","id","notification-view-objecttype",3,"label","value"],["disabled","true","id","notification-view-objectname",3,"label","value"],["disabled","true","id","notification-view-notificationtype",3,"label","value"],["disabled","true","id","notification-view-notificationstatus",3,"label","value"],["disabled","true","id","notification-view-createddatetime",3,"label","value"],[1,"col-md-11"],["disabled","true","id","notification-view-messages",3,"label","defaultvalue"],[1,"col-md-1","text-end","mt-2"],["label","Close","id","notification-view-close","className","btn btn-danger btn-sm",3,"buttonOnClick"],[1,"card"],["id","extraPaddingBottomID",1,"card-content"],[3,"multiple"],["id","notification-view-recordhistory",3,"createdBy","lastUpdatedBy","showrecordhistory","creationDate","lastUpdatedDate"],["id","stickyHeaderID",1,"card-header","card-header-primary"],[1,"subpage-header-title","w-100",3,"pageName","pageTitle","selectedMenuId","selectedSubMenuId","showPageHeaderItems","showDependencySubMenu","isEditActionEnable"]],template:function(a,t){1&a&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),e.YNc(5,$,2,7,"div",5),e.TgZ(6,"div",6)(7,"div",7)(8,"div",8),e._UZ(9,"app-input",9),e.ALo(10,"translate"),e.qZA(),e.TgZ(11,"div",8),e._UZ(12,"app-input",10),e.ALo(13,"translate"),e.qZA(),e.TgZ(14,"div",8),e._UZ(15,"app-input",11),e.ALo(16,"translate"),e.qZA(),e.TgZ(17,"div",8),e._UZ(18,"app-input",12),e.ALo(19,"translate"),e.qZA(),e.TgZ(20,"div",8),e._UZ(21,"app-input",13),e.ALo(22,"translate"),e.qZA(),e.TgZ(23,"div",8),e._UZ(24,"app-input",14),e.ALo(25,"translate"),e.qZA(),e.TgZ(26,"div",15),e._UZ(27,"app-textarea",16),e.ALo(28,"translate"),e.qZA(),e.TgZ(29,"div",17)(30,"app-button",18),e.NdJ("buttonOnClick",function(){return t.closeButton()}),e.qZA()()(),e._UZ(31,"div"),e.qZA()()(),e.TgZ(32,"div",3)(33,"div",19)(34,"div",20)(35,"p-accordion",21),e._UZ(36,"app-recordhistory",22),e.qZA()()()()()()()),2&a&&(e.xp6(5),e.Q6J("ngIf",t.notificationsViewObj),e.xp6(4),e.s9C("label",e.lcZ(10,21,t.enterpriseTitle)),e.s9C("value",null==t.notificationsViewObj||null==t.notificationsViewObj.enterprise?null:t.notificationsViewObj.enterprise.short_name),e.xp6(3),e.s9C("label",e.lcZ(13,23,"COMMON_FIELDS.OBJECT_TYPE")),e.s9C("value",null==t.dataJsonObj?null:t.dataJsonObj.objectTypeValue),e.xp6(3),e.s9C("label",e.lcZ(16,25,"COMMON_FIELDS.OBJECT_NAME")),e.s9C("value",null==t.notificationsViewObj||null==t.notificationsViewObj.object?null:t.notificationsViewObj.object.object_name),e.xp6(3),e.s9C("label",e.lcZ(19,27,"NOTIFICATIONS.NOTIFICATION_TYPE")),e.s9C("value",t.lookupLanguageTranslations(null==t.notificationsViewObj?null:t.notificationsViewObj.notification_type.lookup_id)),e.xp6(3),e.s9C("label",e.lcZ(22,29,"COMMON_FIELDS.STATUS")),e.s9C("value",t.notificationStatus),e.xp6(3),e.s9C("label",e.lcZ(25,31,"COMMON_FIELDS.CREATED_DATE_TIME")),e.s9C("value",t.startDate),e.xp6(3),e.s9C("label",e.lcZ(28,33,"COMMON_PAGE_TITLES.MESSAGE")),e.s9C("defaultvalue",null==t.notificationsViewObj?null:t.notificationsViewObj.notification_message),e.xp6(8),e.Q6J("multiple",!0),e.xp6(1),e.Q6J("createdBy",t.createdBy)("lastUpdatedBy",t.lastUpdatedBy)("showrecordhistory",t.dataJsonObj.showrecordhistory)("creationDate",null==t.notificationsViewObj?null:t.notificationsViewObj.createdAt)("lastUpdatedDate",null==t.notificationsViewObj?null:t.notificationsViewObj.updatedAt))},dependencies:[B.O5,j.UQ,w.r,M.a,R.R,Z.W,I.q,p.X$]})}return r})();class te{is_read;notification_members}var ie=c(57936),k=c(9851),ae=c(42919);const se=["objectTypeDropdown"],oe=["objectNameDropdown"],ne=["notificationTextArea"];let re=(()=>{class r extends _.O{formBuilder;route;commonService;notificationService;toastController;uiUtils;enterprisesService;router;loggerService;translateService;navigationService;objectTypeDropdown;objectNameDropdown;notificationTextArea;defaultEnterprise;defaultNotification;defaultObjectName;defaultObjectType;defaultObjectTypeDropdown;enterpriseId;enterpriseName;enterpriseShortName;error;notificationObj=new ce;notificationTypeName;notificationLookup_name;notificationTypeOptions;objectNameObj;objectNameOptions;objectTypeObj;objectTypeOptions;disableSubmitBtn;dataJsonObj={};menuDataJson;applicationPagesJson;enterpriseTitle=this.getEnterpriseTitle();constructor(i,a,t,o,n,d,l,b,f,h,N){super(a,t),this.formBuilder=i,this.route=a,this.commonService=t,this.notificationService=o,this.toastController=n,this.uiUtils=d,this.enterprisesService=l,this.router=b,this.loggerService=f,this.translateService=h,this.navigationService=N}ngOnInit(){document.getElementsByTagName("body"),this.initializeComponent()}initializeComponent(){this.dataJsonObj.pageName=s.hf.NOTIFICATIONS,this.dataJsonObj.pageTitle=[{key:"COMMON_PAGE_TITLES.NOTIFICATION",value:"",showSubMenuDisplayName:!1},{key:"",value:"-",showSubMenuDisplayName:!1},{key:"COMMON_BUTTONS.BUTTON_CREATE",value:"",showSubMenuDisplayName:!1}],this.disableSubmitBtn=!1,this.commonService.trackView(s.sn.NOTIFICATION_CREATE),this.enterpriseId=localStorage.getItem(s.BU.SELECTED_ENTERPRISE),this.getMenusJsonData();const i=JSON.parse(localStorage.getItem(s.BU.USER));this.notificationObj.notification_members=[{"user_profile.user_profile_id":i.user_profile_id}],this.getEnterpriseRecordById(),this.getObjectType(""),this.commonService.getLookupCodesListJson(this.enterpriseId,"list").then(a=>{this.dataJsonObj.lookupCodesListJSON=a,this.getNotificationType()})}getMenusJsonData(){var i=this;return(0,m.Z)(function*(){i.menuDataJson=yield i.commonService.getDynamicJson(i.enterpriseId,"module_manager","list");const a=yield i.commonService.getAllPagesFromModuleManagerJSON(i.menuDataJson);i.applicationPagesJson=a.filter(t=>!0===t.module_settings.is_notifications_enabled)})()}getEnterpriseRecordById(){this.enterprisesService.getEnterprisesViewData(this.enterpriseId).subscribe(i=>{this.enterpriseName=i.enterprise_name,this.defaultEnterprise=i._id,this.enterpriseShortName=i.short_name},i=>{this.loggerService.setLoggerError(this.constructor.name,"getEnterpriseRecordById",i)})}getObjectType(i){this.commonService.getFilteredDynamicJSONData(this.applicationPagesJson,"page_display_name",i).then(a=>{this.objectTypeOptions=a}).catch(a=>{this.loggerService.setLoggerError(this.constructor.name,"getObjectType",a)})}changeObjectType(i){try{this.defaultObjectType=i.NAME,this.defaultObjectTypeDropdown="Messages"===this.defaultObjectType?"conversationmessages":"Attribute Definitions"===this.defaultObjectType?"attributedefs":"Users"===this.defaultObjectType?"userprofiles":this.defaultObjectType.toLowerCase().replace(/\s/g,""),this.getObjectNames(""),this.defaultObjectName="",this.objectNameOptions="",this.objectTypeObj=i}catch(a){this.loggerService.setLoggerError(this.constructor.name,"changeObjectType",a)}}getObjectNames(i){this.notificationService.getObjectNames(this.defaultObjectTypeDropdown,this.enterpriseId,i).then(a=>{this.objectNameOptions=a}).catch(a=>{this.loggerService.setLoggerError(this.constructor.name,"getObjectNames",a)})}changeObjectName(i){try{this.defaultObjectName=i.NAME,this.objectNameObj=i}catch(a){this.loggerService.setLoggerError(this.constructor.name,"changeObjectName",a)}}getNotificationType(){this.commonService.getFilteredLookupCodes(this.dataJsonObj.lookupCodesListJSON[s.ox.NOTIFICATION_TYPES],"").then(i=>{this.notificationTypeOptions=i,this.defaultNotification=i[0].ID,this.notificationTypeName=i[0].NAME,this.notificationLookup_name=i[0].lookup_name}).catch(i=>{this.loggerService.setLoggerError(this.constructor.name,"getNotificationType",i)})}changeNotificationType(i){try{if(i.value){this.defaultNotification=i.value;const a=this.notificationTypeOptions.find(t=>t.ID===parseInt(this.defaultNotification,10));this.notificationTypeName=a.NAME,this.notificationLookup_name=a.lookup_name}}catch(a){this.loggerService.setLoggerError(this.constructor.name,"changeNotificationType",a)}}changeNotificationMessage(i){try{this.notificationObj.notification_message=i.value}catch(a){this.loggerService.setLoggerError(this.constructor.name,"changeNotificationMessage",a)}}createRecord(){try{this.objectTypeDropdown.isValid()&&this.objectNameDropdown.isValid()&&this.notificationTextArea.isValid()&&(this.notificationObj.enterprise={enterprise_id:this.defaultEnterprise,enterprise_name:this.enterpriseName,short_name:this.enterpriseShortName},this.notificationObj.object={object_type:{page_id:this.objectTypeObj.module.page_id,page_name:this.objectTypeObj.module.page_name},object_id:this.objectNameObj.ID,object_name:this.objectNameObj.NAME},this.notificationObj.notification_type={lookup_id:this.defaultNotification,lookup_name:this.notificationLookup_name},this.notificationObj.notification_image_name="",this.notificationObj.notification_image_path="",this.disableSubmitBtn=!0,this.notificationService.create(this.notificationObj).then(o=>{this.uiUtils.displaytoastMessage("COMMON_TOAST_MESSAGES.TOAST_SUCCESS_CREATE"),this.commonService.redirectToPreviousUrl()},o=>{this.commonErrorCodes(JSON.parse(o))}))}catch(i){this.loggerService.setLoggerError(this.constructor.name,"createRecord",i)}}commonErrorCodes(i){409===JSON.parse(i[s.BU.STATUS])&&(this.error=this.translateService.instant("LOOKUPS.LOOKUPS_UNIQUENESS"))}cancelButton(){this.commonService.redirectToPreviousUrl()}static \u0275fac=function(a){return new(a||r)(e.Y36(T.qu),e.Y36(u.gz),e.Y36(S.v),e.Y36(g.g),e.Y36(C.yF),e.Y36(O.s),e.Y36(ie.e),e.Y36(u.F0),e.Y36(y.m),e.Y36(p.sK),e.Y36(D.f))};static \u0275cmp=e.Xpm({type:r,selectors:[["app-notifications-create"]],viewQuery:function(a,t){if(1&a&&(e.Gf(se,5),e.Gf(oe,5),e.Gf(ne,5)),2&a){let o;e.iGM(o=e.CRH())&&(t.objectTypeDropdown=o.first),e.iGM(o=e.CRH())&&(t.objectNameDropdown=o.first),e.iGM(o=e.CRH())&&(t.notificationTextArea=o.first)}},features:[e._Bn([g.g,O.s]),e.qOj],decls:35,vars:37,consts:[[1,"container-fluid"],[1,"forms-wrapper"],[1,"row","g-0"],[1,"col-md-12"],[1,"card","bdt-0"],["id","stickyHeaderID",1,"card-header","card-header-primary"],[1,"subpage-header-title","w-100",3,"pageName","pageTitle","showPageHeaderItems","showDependencySubMenu"],["id","extraPaddingBottomID",1,"card-body"],[1,"row","form-bs"],[1,"col-md-3"],["mandatory","true","disabled","true","id","notification-create-enterprise",3,"label","value"],["mandatory","true","id","notification-create-objecttype",3,"label","options","defaultValue","selectedOption","searchValueChange"],["objectTypeDropdown",""],["mandatory","true","id","notification-create-objectname",3,"label","options","defaultValue","selectedOption","searchValueChange"],["objectNameDropdown",""],["mandatory","true","id","notification-create-notificationtype",3,"label","options","defaultValue","valueChange"],[1,"col-lg-10","col-md-9"],["mandatory","true","id","notification-create-notificationmessage",3,"label","maxlength","valueChange"],["notificationTextArea",""],[1,"col-lg-2","col-md-3","text-end","mt-2"],["className","btn btn-primary btn-sm","id","notification-create-submit",1,"mgr-5",3,"label","disabled","buttonOnClick"],["className","btn btn-danger btn-sm","id","notification-create-cancle",3,"label","buttonOnClick"],[1,"text-danger","text-center"]],template:function(a,t){1&a&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5),e._UZ(6,"app-pageheader",6),e.qZA(),e.TgZ(7,"div",7)(8,"div",8)(9,"div",9),e._UZ(10,"app-input",10),e.ALo(11,"translate"),e.qZA(),e.TgZ(12,"div",9)(13,"app-dropdown-search",11,12),e.NdJ("selectedOption",function(n){return t.changeObjectType(n)})("searchValueChange",function(n){return t.getObjectType(n)}),e.ALo(15,"translate"),e.qZA()(),e.TgZ(16,"div",9)(17,"app-dropdown-search",13,14),e.NdJ("selectedOption",function(n){return t.changeObjectName(n)})("searchValueChange",function(n){return t.getObjectNames(n)}),e.ALo(19,"translate"),e.qZA()(),e.TgZ(20,"div",9)(21,"app-dropdown-singleselect",15),e.NdJ("valueChange",function(n){return t.changeNotificationType(n)}),e.ALo(22,"translate"),e.qZA()(),e.TgZ(23,"div",16)(24,"app-textarea",17,18),e.NdJ("valueChange",function(n){return t.changeNotificationMessage(n)}),e.ALo(26,"translate"),e.qZA()(),e.TgZ(27,"div",19)(28,"app-button",20),e.NdJ("buttonOnClick",function(){return t.createRecord()}),e.ALo(29,"translate"),e.qZA(),e.TgZ(30,"app-button",21),e.NdJ("buttonOnClick",function(){return t.cancelButton()}),e.ALo(31,"translate"),e.qZA()()(),e.TgZ(32,"div",22),e._uU(33),e.ALo(34,"translate"),e.qZA()()()()()()()),2&a&&(e.xp6(6),e.Q6J("pageName",t.dataJsonObj.pageName)("pageTitle",t.dataJsonObj.pageTitle)("showPageHeaderItems",!1)("showDependencySubMenu",!1),e.xp6(4),e.s9C("label",e.lcZ(11,21,t.enterpriseTitle)),e.s9C("value",t.enterpriseShortName),e.xp6(3),e.s9C("label",e.lcZ(15,23,"COMMON_FIELDS.OBJECT_TYPE")),e.s9C("defaultValue",t.defaultObjectType),e.Q6J("options",t.objectTypeOptions),e.xp6(4),e.s9C("label",e.lcZ(19,25,"COMMON_FIELDS.OBJECT_NAME")),e.s9C("defaultValue",t.defaultObjectName),e.Q6J("options",t.objectNameOptions),e.xp6(4),e.s9C("label",e.lcZ(22,27,"NOTIFICATIONS.NOTIFICATION_TYPE")),e.s9C("defaultValue",t.defaultNotification),e.Q6J("options",t.notificationTypeOptions),e.xp6(3),e.s9C("label",e.lcZ(26,29,"NOTIFICATIONS.NOTIFICATION_MESSAGE")),e.Q6J("maxlength",2e3),e.xp6(4),e.s9C("label",e.lcZ(29,31,"COMMON_BUTTONS.BUTTON_SUBMIT")),e.s9C("disabled",t.disableSubmitBtn),e.xp6(2),e.s9C("label",e.lcZ(31,33,"COMMON_BUTTONS.BUTTON_CANCEL")),e.xp6(3),e.hij(" ",e.lcZ(34,35,t.error)," "))},dependencies:[w.r,M.a,k.k,R.R,ae.C,I.q,p.X$]})}return r})();class ce{enterprise;object_type;object_id;object;object_name;notification_status;notification_message;notification_type;user_profile_id;read_status;notification_image_name;notification_image_path;notification_members}const le=["notificationTextArea"];let de=(()=>{class r extends _.O{formBuilder;route;commonService;notificationService;toastController;uiUtils;router;loggerService;translateService;navigationService;notificationTextArea;createdBy;createdDate;defaultNotificationType;defaultObject;enterpriseId;enterpriseObj;error;lastUpdatedBy;lastUpdatedDate;notificationTypeObj;notificationTypeOptions;notificationsObj=new he;recordId;viewData;dataJsonObj={};enterpriseTitle=this.getEnterpriseTitle();constructor(i,a,t,o,n,d,l,b,f,h){super(a,t),this.formBuilder=i,this.route=a,this.commonService=t,this.notificationService=o,this.toastController=n,this.uiUtils=d,this.router=l,this.loggerService=b,this.translateService=f,this.navigationService=h,this.route.params.subscribe(N=>{this.recordId=N.id,this.getRecordById(this.recordId)})}ngOnInit(){this.initializeComponent()}initializeComponent(){this.dataJsonObj.pageName=s.hf.NOTIFICATIONS,this.commonService.trackView(s.sn.NOTIFICATION_EDIT),this.enterpriseId=localStorage.getItem(s.BU.SELECTED_ENTERPRISE),this.getModuleViewJsonData(),document.getElementsByTagName("body"),this.commonService.getLookupCodesListJson(this.enterpriseId,"list").then(a=>{this.dataJsonObj.lookupCodesListJSON=a,this.getNotificationTypeList()}),this.dataJsonObj.showrecordhistory=this.roleRightsValidationByPage(s.hf.NOTIFICATIONS,s.AM.ACTIONS,s.In.RECORD_HISTORY)}getModuleViewJsonData(){var i=this;return(0,m.Z)(function*(){i.dataJsonObj.moduleViewDataJson=yield i.commonService.getDynamicJson(i.enterpriseId,"module_manager","view")})()}getRecordById(i){try{this.notificationService.get(i).subscribe(a=>{this.viewData=a,this.enterpriseObj=this.viewData.enterprise,this.defaultObject=this.viewData.object,this.lastUpdatedBy=this.viewData.updated_by,this.createdBy=this.viewData.created_by,this.dataJsonObj.objectTypeValue=this.dataJsonObj.moduleViewDataJson&&this.dataJsonObj.moduleViewDataJson[this.viewData.object.object_type.page_id+""]?this.dataJsonObj.moduleViewDataJson[this.viewData.object.object_type.page_id+""].page_display_name:"",this.defaultNotificationType=this.viewData.notification_type.lookup_id,this.notificationTypeObj=this.viewData.notification_type,this.getNotificationTypeList(),this.viewData.notification_message=this.strip(this.viewData.notification_message),this.dataJsonObj.pageTitle=[{key:"COMMON_PAGE_TITLES.NOTIFICATION",value:"",showSubMenuDisplayName:!1},{key:"",value:"-",showSubMenuDisplayName:!1},{key:"COMMON_BUTTONS.BUTTON_EDIT",value:"",showSubMenuDisplayName:!1}]},a=>{this.loggerService.setLoggerError(this.constructor.name,"getRecordById",a)})}catch(a){this.loggerService.setLoggerError(this.constructor.name,"getRecordById",a)}}getNotificationTypeList(){try{this.commonService.getFilteredLookupCodes(this.dataJsonObj.lookupCodesListJSON[s.ox.NOTIFICATION_TYPES],"").then(i=>{this.notificationTypeOptions=i},i=>{this.loggerService.setLoggerError(this.constructor.name,"getNotificationTypeList",i)})}catch(i){this.loggerService.setLoggerError(this.constructor.name,"getNotificationTypeList",i)}}changeNotificationType(i){try{i.value&&(this.defaultNotificationType=i.value,this.notificationTypeObj=this.notificationTypeOptions.find(a=>a.ID===parseInt(this.defaultNotificationType,10)))}catch(a){this.loggerService.setLoggerError(this.constructor.name,"changeNotificationType",a)}}changeNotificationMessage(i){try{this.notificationsObj.notification_message=i.value}catch(a){this.loggerService.setLoggerError(this.constructor.name,"changeNotificationMessage",a)}}updateRecord(){try{this.notificationTextArea.isValid()&&(this.notificationsObj.enterprise=this.enterpriseObj,this.notificationsObj.object=this.defaultObject,this.notificationsObj.notification_type=this.notificationTypeObj,this.notificationsObj.notification_message=this.notificationsObj.notification_message,this.notificationService.update(this.recordId,this.notificationsObj).then(i=>{this.uiUtils.displaytoastMessage("COMMON_TOAST_MESSAGES.TOAST_SUCCESS_EDIT"),this.router.routeReuseStrategy.clearModuleRouteCache("notifications"),this.router.navigateByUrl("/notifications")},i=>{this.commonErrorCodes(JSON.parse(i))}))}catch(i){this.loggerService.setLoggerError(this.constructor.name,"updateRecord",i)}}commonErrorCodes(i){409===JSON.parse(i[s.BU.STATUS])&&(this.error=this.translateService.instant("LOOKUPS.LOOKUPS_UNIQUENESS"))}cancelButton(){this.commonService.redirectToPreviousUrl()}strip(i){if(void 0!==i)return i.replace(/<(?:.|\n)*?>/gm,"").trim().replace(/\s\s+/g," ")}static \u0275fac=function(a){return new(a||r)(e.Y36(T.qu),e.Y36(u.gz),e.Y36(S.v),e.Y36(g.g),e.Y36(C.yF),e.Y36(O.s),e.Y36(u.F0),e.Y36(y.m),e.Y36(p.sK),e.Y36(D.f))};static \u0275cmp=e.Xpm({type:r,selectors:[["app-notifications-edit"]],viewQuery:function(a,t){if(1&a&&e.Gf(le,5),2&a){let o;e.iGM(o=e.CRH())&&(t.notificationTextArea=o.first)}},features:[e._Bn([g.g,O.s]),e.qOj],decls:38,vars:41,consts:[[1,"container-fluid"],[1,"forms-wrapper"],[1,"row","g-0"],[1,"col-md-12"],[1,"card","bdt-0"],["id","stickyHeaderID",1,"card-header","card-header-primary"],[1,"subpage-header-title","w-100",3,"pageName","pageTitle","showPageHeaderItems","showDependencySubMenu"],[1,"card-body"],[1,"row","form-bs"],[1,"col-md-3"],["disabled","true","id","notification-edit-enterprise",3,"label","value"],["disabled","true","id","notification-edit-objecttype",3,"label","value"],["disabled","true","id","notification-edit-objectname",3,"label","value"],["mandatory","true","id","notification-edit-notificationtype",3,"label","options","defaultValue","valueChange"],[1,"col-md-10","col-md-9"],["mandatory","true","id","notification-create-notificationmessage",3,"label","maxlength","defaultvalue","valueChange"],["notificationTextArea",""],[1,"col-lg-2","col-md-3","text-end","mt-2"],["className","btn btn-primary btn-sm","id","notification-create-submit",1,"mgr-5",3,"label","buttonOnClick"],["className","btn btn-danger btn-sm","id","notification-create-cancle",3,"label","buttonOnClick"],[1,"text-danger","text-center"],[1,"card"],["id","extraPaddingBottomID",1,"card-content"],[3,"multiple"],["id","notification-view-recordhistory",3,"createdBy","lastUpdatedBy","showrecordhistory","creationDate","lastUpdatedDate"]],template:function(a,t){1&a&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5),e._UZ(6,"app-pageheader",6),e.qZA(),e.TgZ(7,"div",7)(8,"div",8)(9,"div",9),e._UZ(10,"app-input",10),e.ALo(11,"translate"),e.qZA(),e.TgZ(12,"div",9),e._UZ(13,"app-input",11),e.ALo(14,"translate"),e.qZA(),e.TgZ(15,"div",9),e._UZ(16,"app-input",12),e.ALo(17,"translate"),e.qZA(),e.TgZ(18,"div",9)(19,"app-dropdown-singleselect",13),e.NdJ("valueChange",function(n){return t.changeNotificationType(n)}),e.ALo(20,"translate"),e.qZA()(),e.TgZ(21,"div",14)(22,"app-textarea",15,16),e.NdJ("valueChange",function(n){return t.changeNotificationMessage(n)}),e.ALo(24,"translate"),e.qZA()(),e.TgZ(25,"div",17)(26,"app-button",18),e.NdJ("buttonOnClick",function(){return t.updateRecord()}),e.ALo(27,"translate"),e.qZA(),e.TgZ(28,"app-button",19),e.NdJ("buttonOnClick",function(){return t.cancelButton()}),e.ALo(29,"translate"),e.qZA()()(),e.TgZ(30,"div",20),e._uU(31),e.ALo(32,"translate"),e.qZA()()()(),e.TgZ(33,"div",3)(34,"div",21)(35,"div",22)(36,"p-accordion",23),e._UZ(37,"app-recordhistory",24),e.qZA()()()()()()()),2&a&&(e.xp6(6),e.Q6J("pageName",t.dataJsonObj.pageName)("pageTitle",t.dataJsonObj.pageTitle)("showPageHeaderItems",!1)("showDependencySubMenu",!1),e.xp6(4),e.s9C("label",e.lcZ(11,25,t.enterpriseTitle)),e.s9C("value",null==t.viewData||null==t.viewData.enterprise?null:t.viewData.enterprise.short_name),e.xp6(3),e.s9C("label",e.lcZ(14,27,"COMMON_FIELDS.OBJECT_TYPE")),e.s9C("value",null==t.dataJsonObj?null:t.dataJsonObj.objectTypeValue),e.xp6(3),e.s9C("label",e.lcZ(17,29,"COMMON_FIELDS.OBJECT_NAME")),e.s9C("value",null==t.viewData||null==t.viewData.object?null:t.viewData.object.object_name),e.xp6(3),e.s9C("label",e.lcZ(20,31,"NOTIFICATIONS.NOTIFICATION_TYPE")),e.s9C("defaultValue",t.defaultNotificationType),e.Q6J("options",t.notificationTypeOptions),e.xp6(3),e.s9C("label",e.lcZ(24,33,"NOTIFICATIONS.NOTIFICATION_MESSAGE")),e.s9C("defaultvalue",null==t.viewData?null:t.viewData.notification_message),e.Q6J("maxlength",2e3),e.xp6(4),e.s9C("label",e.lcZ(27,35,"COMMON_BUTTONS.BUTTON_SUBMIT")),e.xp6(2),e.s9C("label",e.lcZ(29,37,"COMMON_BUTTONS.BUTTON_CANCEL")),e.xp6(3),e.hij(" ",e.lcZ(32,39,t.error)," "),e.xp6(5),e.Q6J("multiple",!0),e.xp6(1),e.Q6J("createdBy",t.createdBy)("lastUpdatedBy",t.lastUpdatedBy)("showrecordhistory",t.dataJsonObj.showrecordhistory)("creationDate",null==t.viewData?null:t.viewData.createdAt)("lastUpdatedDate",null==t.viewData?null:t.viewData.updatedAt))},dependencies:[j.UQ,w.r,M.a,k.k,R.R,Z.W,I.q,p.X$]})}return r})();class he{enterprise;object_type;object_id;object;notification_status;notification_message;notification_type;user_id}var A=c(11210);const ue=[{path:"",data:{title:"Notification"},children:[{path:"",redirectTo:"list",pathMatch:"full"},{path:"list",canActivate:[A.P],component:X,data:{object_type:s.hf.NOTIFICATIONS,title:"Notifications List",responsibilityParam:s.bP.MENUS+"."+s.w1.PROFILE_MENU+"."+s.bP.SUBMENUS+"."+s.w1.NOTIFICATIONS+"."+s.In.ENABLED,pageName:s.hf.NOTIFICATIONS}},{path:"create",canActivate:[A.P],component:re,data:{object_type:s.hf.NOTIFICATIONS,title:"Notifications Create",responsibilityParam:s.bP.MENUS+"."+s.w1.PROFILE_MENU+"."+s.bP.SUBMENUS+"."+s.w1.NOTIFICATIONS+"."+s.In.CREATE,pageName:s.hf.NOTIFICATIONS,pageSetting:s.AM.ACTIONS,settingField:s.In.CREATE}},{path:":id/edit",canActivate:[A.P],component:de,data:{object_type:s.hf.NOTIFICATIONS,title:"Notifications Edit",responsibilityParam:s.bP.MENUS+"."+s.w1.PROFILE_MENU+"."+s.bP.SUBMENUS+"."+s.w1.NOTIFICATIONS+"."+s.In.EDIT,pageName:s.hf.NOTIFICATIONS,pageSetting:s.AM.ACTIONS,settingField:s.In.EDIT}},{path:":id/view",canActivate:[A.P],component:ee,data:{object_type:s.hf.NOTIFICATIONS,title:"Notifications View",responsibilityParam:s.bP.MENUS+"."+s.w1.PROFILE_MENU+"."+s.bP.SUBMENUS+"."+s.w1.NOTIFICATIONS+"."+s.In.VIEW,pageName:s.hf.NOTIFICATIONS,pageSetting:s.AM.ACTIONS,settingField:s.In.VIEW}}]}];let pe=(()=>{class r{static \u0275fac=function(a){return new(a||r)};static \u0275mod=e.oAB({type:r});static \u0275inj=e.cJS({imports:[u.Bz.forChild(ue),u.Bz]})}return r})();var ge=c(32137),me=c(10841);let be=(()=>{class r{static \u0275fac=function(a){return new(a||r)};static \u0275mod=e.oAB({type:r});static \u0275inj=e.cJS({imports:[B.ez,p.aw,T.u5,T.UX,H.U$,j.fx,q.Q,ge.D,pe,me.ii,v.Nh]})}return r})()}}]);