"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4090],{14090:(je,V,l)=>{l.r(V),l.d(V,{CRMSalesRepsModule:()=>Ie});var O=l(32174),T=l(11210),x=l(75875),U=l(90313),n=l(32236),e=l(94650);let _=(()=>{class i{authService;constructor(a){this.authService=a}getCrmSalesRepsList(a,s,t,r,o,d,p,S,m,u,h){const C=u||"",Q=p?"&condition="+p:"",H=U.L.isEmpty(h)?"":"&advSearchString="+JSON.stringify(h);return U.L.isEmpty(Q)?this.authService.getApiCall("api/v1/crmsalesreps?skip="+a+"&limit="+s+"&type=list&sort="+t+"&search="+r+"&enterprise.enterprise_id="+o+m+C+H,d):this.authService.getApiCall("api/v1/crmsalesreps?skip="+a+"&limit="+s+"&type=list&sort="+t+"&search="+r+"&enterprise.enterprise_id="+o+Q+m+C+H,d)}createCrmSalesReps(a){return new Promise((s,t)=>{this.authService.postApiCall("api/v1/crmsalesreps/",a).subscribe(r=>{s(r)},r=>{t(r)})})}getCRMSalesRepViewData(a,s){let t;return t=s?"api/v1/crmsalesreps/"+a+"?enterprise.enterprise_id="+localStorage.getItem(n.BU.SELECTED_ENTERPRISE)+s:"api/v1/crmsalesreps/"+a,this.authService.getApiCall(t,!0)}getCRMSalesRepEditData(a,s){return new Promise((t,r)=>{this.authService.putApiCall("api/v1/crmsalesreps/"+a,s).subscribe(o=>{t(o)},o=>{r(o)})})}getWorkResourceDrop(a,s){return new Promise((t,r)=>{this.authService.getApiCall("api/v1/workresources?type=drop&enterprise.enterprise_id="+s+"&search="+a).subscribe(o=>{t(o)},o=>{r(o)})})}static \u0275fac=function(s){return new(s||i)(e.LFG(x.e))};static \u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var f=l(71568),A=l(47561),J=l(57936),D=l(42786),z=l(46335),w=l(46448),g=l(62510),b=l(54463),N=l(27601),I=l(2387),j=l(56368),P=l(9851),k=l(47386),B=l(42919),y=l(37415);const W=["bussinessEntitydropdown"],K=["managerDropDown"],X=["salesrepDropDown"],ee=["statusDrop"];let te=(()=>{class i extends A.O{crmSalesRepsService;loggerService;navigationService;router;translateService;uiUtils;userService;commonservice;enterprisesService;route;bussinessEntitydropdown;managerDropDown;salesrepDropDown;statusDrop;EffectiveDateError;bussinessEntity;bussinessEntityObj;bussinessEntityOptions;defaultStatus;effectiveEndDateValue;effectivestartDateValue;email;enterpriseId;enterpriseObj;enterprise_short_name;error;managerName;managerOptions;managersObj;object_type;phoneNumber;salesrepName;salesrepObj;salesrepOptions;statusObj;statusOptions;userProfileId;dataJsonObj={};constructor(a,s,t,r,o,d,p,S,m,u){super(u,S),this.crmSalesRepsService=a,this.loggerService=s,this.navigationService=t,this.router=r,this.translateService=o,this.uiUtils=d,this.userService=p,this.commonservice=S,this.enterprisesService=m,this.route=u}ngOnInit(){}ngAfterContentInit(){this.initializeComponent()}initializeComponent(){this.dataJsonObj.pageName=n.hf.CRM_SALESREPS,this.dataJsonObj.pageTitle=[{key:"CRM_ACCOUNTS.CRM_SALES_REP",value:"",showSubMenuDisplayName:!1},{key:"",value:"-",showSubMenuDisplayName:!1},{key:"COMMON_BUTTONS.BUTTON_CREATE",value:"",showSubMenuDisplayName:!1}],this.object_type=this.route.snapshot.data.object_type,this.enterpriseId=localStorage.getItem(n.BU.SELECTED_ENTERPRISE),this.userProfileId=localStorage.getItem(n.BU.LOG_IN_USER_ID),document.getElementsByTagName("body"),this.getEnterprisesViewData(),this.commonService.getLookupCodesListJson(this.enterpriseId,"list").then(s=>{this.dataJsonObj.lookupCodesListJSON=s,this.getbussinessEntityOptions(""),this.getStatusOptions("")}),this.effectivestartDateValue=new Date,this.effectiveEndDateValue=new Date}getEnterprisesViewData(){try{this.enterprisesService.getEnterprisesViewData(this.enterpriseId).subscribe(a=>{a.enterprise_id=a._id,this.enterprise_short_name=a.short_name,this.enterpriseObj=a},a=>{this.loggerService.setLoggerError(this.constructor.name,"getEnterprisesViewData",a)})}catch(a){this.loggerService.setLoggerError(this.constructor.name,"getEnterprisesViewData",a)}}getBussinessEntity(a){try{this.bussinessEntity=a.value,this.bussinessEntityObj=this.bussinessEntityOptions.find(s=>s.ID===parseInt(this.bussinessEntity,10))}catch(s){this.loggerService.setLoggerError(this.constructor.name,"getBussinessEntity",s)}}getbussinessEntityOptions(a){try{this.commonService.getFilteredLookupCodes(this.dataJsonObj.lookupCodesListJSON[n.ox.BUSINESS_ENTITY_NAMES],a).then(s=>{this.bussinessEntityOptions=s,this.bussinessEntity=s[0].ID,this.bussinessEntityObj=s[0]},s=>{this.loggerService.setLoggerError(this.constructor.name,"getbussinessEntityOptions",s)})}catch(s){this.loggerService.setLoggerError(this.constructor.name,"getbussinessEntityOptions",s)}}getSalesrepList(a){try{this.crmSalesRepsService.getWorkResourceDrop(a,this.enterpriseId).then(s=>{this.salesrepOptions=s}).catch(s=>{this.loggerService.setLoggerError(this.constructor.name,"getResourcesList",s)})}catch(s){this.loggerService.setLoggerError(this.constructor.name,"getSalesrepList",s)}}getSalesrep(a){try{this.salesrepName=a.NAME,this.salesrepObj=a,(a.phone||a.email)&&(this.phoneNumber=a.phone,this.email=a.email)}catch(s){this.loggerService.setLoggerError(this.constructor.name,"getSalesrep",s)}}getManagersList(a){try{this.crmSalesRepsService.getWorkResourceDrop(a,this.enterpriseId).then(s=>{this.managerOptions=s}).catch(s=>{this.loggerService.setLoggerError(this.constructor.name,"getWorkResourceDrop",s)})}catch(s){this.loggerService.setLoggerError(this.constructor.name,"getManagersList",s)}}getManager(a){try{this.managerName=this.lookupLanguageTranslations(a.lookup_id),this.managersObj=a}catch(s){this.loggerService.setLoggerError(this.constructor.name,"getManager",s)}}getStatusOptions(a){try{this.commonService.getFilteredLookupCodes(this.dataJsonObj.lookupCodesListJSON[n.ox.WORK_CLIENT_STATUSES],a).then(s=>{this.statusOptions=s,this.defaultStatus=s[0].ID,this.statusObj=s[0]},s=>{this.loggerService.setLoggerError(this.constructor.name,"getStatusOptions",s)})}catch(s){this.loggerService.setLoggerError(this.constructor.name,"getStatusOptions",s)}}changeStatus(a){try{this.defaultStatus=a.value,this.statusObj=this.statusOptions.find(s=>s.ID===parseInt(this.defaultStatus,10))}catch(s){this.loggerService.setLoggerError(this.constructor.name,"changeStatus",s)}}getEffectiveStartDateChange(a){try{this.EffectiveDateError="",this.effectivestartDateValue=a.value}catch(s){this.loggerService.setLoggerError(this.constructor.name,"getEffectiveStartDateChange",s)}}getEffectiveEndDateChange(a){try{this.EffectiveDateError="",this.effectiveEndDateValue=a.value}catch(s){this.loggerService.setLoggerError(this.constructor.name,"getEffectiveEndDateChange",s)}}getAccountShortName(a){try{this.error=""}catch(s){this.loggerService.setLoggerError(this.constructor.name,"getAccountShortName",s)}}CreateSalesRep(){try{this.bussinessEntitydropdown.isValid()&&this.salesrepDropDown.isValid()&&this.managerDropDown.isValid()&&this.statusDrop.isValid()&&(this.effectiveEndDateValue&&new Date(this.effectiveEndDateValue)<new Date(this.effectivestartDateValue)?this.EffectiveDateError="COMMON_VALIDATION_MESSAGES.VALID_NOBLANK_END_DATE_GREATER_START":this.crmSalesRepsService.createCrmSalesReps({enterprise:this.enterpriseObj,business_entity_name:this.bussinessEntityObj,work_resourse:{work_resource_id:this.salesrepObj.work_resource_id,work_resource_name:this.salesrepObj.NAME,user_profile:this.salesrepObj.user_profile,f_name:this.salesrepObj.f_name,l_name:this.salesrepObj.l_name,short_name:this.salesrepObj.short_name,mobile_number:this.salesrepObj.phone,email:this.salesrepObj.email},sales_profile:[{manager:{work_resource_id:this.managersObj.work_resource_id,work_resource_name:this.managersObj.NAME,user_profile:this.managersObj.user_profile,f_name:this.managersObj.f_name,l_name:this.managersObj.l_name,short_name:this.managersObj.l_name},effective_start_date:this.effectivestartDateValue,effective_end_date:this.effectiveEndDateValue,status:this.statusObj,last_updated_by:this.userProfileId}]}).then(s=>{this.uiUtils.displaytoastMessage("COMMON_TOAST_MESSAGES.TOAST_SUCCESS_CREATE"),this.commonService.redirectToPreviousUrl()},s=>{this.commonErrorCodes(JSON.parse(s))}))}catch(a){this.loggerService.setLoggerError(this.constructor.name,"submit",a)}}commonErrorCodes(a){409===JSON.parse(a[n.BU.STATUS])&&(this.error=this.translateService.instant("COMMON_STATUS_CODES.409"))}cancelBtn(){try{this.commonService.redirectToPreviousUrl()}catch(a){this.loggerService.setLoggerError(this.constructor.name,"cancel",a)}}static \u0275fac=function(s){return new(s||i)(e.Y36(_),e.Y36(D.m),e.Y36(w.f),e.Y36(g.F0),e.Y36(b.sK),e.Y36(N.s),e.Y36(z.K),e.Y36(f.v),e.Y36(J.e),e.Y36(g.gz))};static \u0275cmp=e.Xpm({type:i,selectors:[["app-crm-salesreps-create"]],viewQuery:function(s,t){if(1&s&&(e.Gf(W,5),e.Gf(K,5),e.Gf(X,5),e.Gf(ee,5)),2&s){let r;e.iGM(r=e.CRH())&&(t.bussinessEntitydropdown=r.first),e.iGM(r=e.CRH())&&(t.managerDropDown=r.first),e.iGM(r=e.CRH())&&(t.salesrepDropDown=r.first),e.iGM(r=e.CRH())&&(t.statusDrop=r.first)}},features:[e._Bn([J.e,f.v,_]),e.qOj],decls:53,vars:60,consts:[[1,"container-fluid"],[1,"forms-wrapper"],[1,"row","g-0"],[1,"col-md-12"],[1,"card","bd-0"],["id","stickyHeaderID",1,"card-header","card-header-primary"],[1,"subpage-header-title","w-100",3,"pageName","pageTitle","showPageHeaderItems","showDependencySubMenu"],["id","extraPaddingBottomID",1,"card-body"],[1,"row","form-bs"],[1,"col-md-4"],["disabled","true","id","crm-salesrep-create-enterprise_name",3,"label","value"],["mandatory","true","id","crm-salesrep-create-status",3,"label","options","defaultValue","valueChange"],["bussinessEntitydropdown",""],["mandatory","true",3,"label","options","defaultValue","id","selectedOption","searchValueChange"],["salesrepDropDown",""],["mandatory","true",3,"label","options","defaultValue","selectedOption","searchValueChange"],["managerDropDown",""],[1,"col-md-2"],["mandatory","true","id","crm-salesrep-create-status",3,"label","options","maxlength","defaultValue","valueChange"],["statusDrop",""],[1,"col-lg-6","col-md-6","datetimepicker"],[1,"row"],[1,"col-md-6"],["dateformat","dd-MMM-yyyy","disabled","false","mandatory","true",3,"placeholder","defaultDate","id","editvalueChange"],["dateformat","dd-MMM-yyyy","disabled","false",3,"placeholder","defaultDate","id","editvalueChange"],[1,"col-md-4","text-end","mt-2"],["className","btn btn-primary btn-sm","id","crm-salesrep-create-submit-button",1,"mgr-5",3,"label","buttonOnClick"],["className","btn btn-danger btn-sm","id","crm-salesrep-create-cancelBtn",3,"label","buttonOnClick"],[1,"error-msg","col-md-12","text-danger","text-center","mb-0"]],template:function(s,t){1&s&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5),e._UZ(6,"app-pageheader",6),e.qZA(),e.TgZ(7,"div",7)(8,"div",8)(9,"div",9),e._UZ(10,"app-input",10),e.ALo(11,"translate"),e.qZA(),e.TgZ(12,"div",9)(13,"app-dropdown-singleselect",11,12),e.NdJ("valueChange",function(o){return t.getBussinessEntity(o)}),e.ALo(15,"translate"),e.qZA()(),e.TgZ(16,"div",9)(17,"app-dropdown-search",13,14),e.NdJ("selectedOption",function(o){return t.getSalesrep(o)})("searchValueChange",function(o){return t.getSalesrepList(o)}),e.ALo(19,"translate"),e.qZA()(),e.TgZ(20,"div",9),e._UZ(21,"app-input",10),e.ALo(22,"translate"),e.qZA(),e.TgZ(23,"div",9),e._UZ(24,"app-input",10),e.ALo(25,"translate"),e.qZA(),e.TgZ(26,"div",9)(27,"app-dropdown-search",15,16),e.NdJ("selectedOption",function(o){return t.getManager(o)})("searchValueChange",function(o){return t.getManagersList(o)}),e.ALo(29,"translate"),e.qZA()(),e.TgZ(30,"div",17)(31,"app-dropdown-singleselect",18,19),e.NdJ("valueChange",function(o){return t.changeStatus(o)}),e.ALo(33,"translate"),e.qZA()(),e.TgZ(34,"div",20)(35,"div",21)(36,"div",22)(37,"app-datetimepicker",23),e.NdJ("editvalueChange",function(o){return t.getEffectiveStartDateChange(o)}),e.ALo(38,"translate"),e.qZA()(),e.TgZ(39,"div",22)(40,"app-datetimepicker",24),e.NdJ("editvalueChange",function(o){return t.getEffectiveEndDateChange(o)}),e.ALo(41,"translate"),e.qZA()()()(),e.TgZ(42,"div",25)(43,"app-button",26),e.NdJ("buttonOnClick",function(){return t.CreateSalesRep()}),e.ALo(44,"translate"),e.qZA(),e.TgZ(45,"app-button",27),e.NdJ("buttonOnClick",function(){return t.cancelBtn()}),e.ALo(46,"translate"),e.qZA()(),e.TgZ(47,"div",28),e._uU(48),e.ALo(49,"translate"),e.qZA(),e.TgZ(50,"div",28),e._uU(51),e.ALo(52,"translate"),e.qZA()()()()()()()()),2&s&&(e.xp6(6),e.Q6J("pageName",t.dataJsonObj.pageName)("pageTitle",t.dataJsonObj.pageTitle)("showPageHeaderItems",!1)("showDependencySubMenu",!1),e.xp6(4),e.s9C("label",e.lcZ(11,34,"COMMON_PAGE_TITLES.ENTERPRISE")),e.s9C("value",t.enterprise_short_name),e.xp6(3),e.s9C("label",e.lcZ(15,36,"COMMON_FIELDS.BUSINESS_ENTITY")),e.s9C("defaultValue",t.bussinessEntity),e.Q6J("options",t.bussinessEntityOptions),e.xp6(4),e.s9C("label",e.lcZ(19,38,"CRM_ACCOUNTS.CRM_SALES_REP")),e.s9C("defaultValue",t.salesrepName),e.MGl("id","crm-salesrep-create-",t.object_type,"-resource-addpopup-ResourceName"),e.Q6J("options",t.salesrepOptions),e.xp6(4),e.s9C("label",e.lcZ(22,40,"COMMON_FIELDS.PHONE_NUMBER")),e.s9C("value",t.phoneNumber),e.xp6(3),e.s9C("label",e.lcZ(25,42,"COMMON_FIELDS.EMAIL")),e.s9C("value",t.email),e.xp6(3),e.s9C("label",e.lcZ(29,44,"CRM_ACCOUNTS.CRM_SALES_REP_MANAGER")),e.s9C("defaultValue",t.managerName),e.Q6J("options",t.managerOptions),e.xp6(4),e.s9C("label",e.lcZ(33,46,"COMMON_FIELDS.STATUS")),e.s9C("defaultValue",t.defaultStatus),e.Q6J("options",t.statusOptions)("maxlength",40),e.xp6(6),e.s9C("placeholder",e.lcZ(38,48,"COMMON_FIELDS.START_DATE")),e.MGl("id","crm-salesrep-create-",t.object_type,"-resource-addpopup-effectivestartDateValue"),e.Q6J("defaultDate",t.effectivestartDateValue),e.xp6(3),e.s9C("placeholder",e.lcZ(41,50,"COMMON_FIELDS.END_DATE")),e.MGl("id","crm-salesrep-create-",t.object_type,"-resource-addpopup-effectiveEndDateValue"),e.Q6J("defaultDate",t.effectiveEndDateValue),e.xp6(3),e.s9C("label",e.lcZ(44,52,"COMMON_BUTTONS.BUTTON_SUBMIT")),e.xp6(2),e.s9C("label",e.lcZ(46,54,"COMMON_BUTTONS.BUTTON_CANCEL")),e.xp6(3),e.hij(" ",e.lcZ(49,56,t.EffectiveDateError)," "),e.xp6(3),e.hij(" ",e.lcZ(52,58,t.error)," "))},dependencies:[I.r,j.a,P.k,k.L,B.C,y.q,b.X$]})}return i})();var v=l(15439),E=l(42863),M=l(36895),R=l(93144),L=l(10805),ae=l(93837),F=l(11735);const se=["statusDrop"],re=["managerDropDown"];function ie(i,c){if(1&i){const a=e.EpF();e.TgZ(0,"app-button",52),e.NdJ("buttonOnClick",function(t){e.CHM(a);const r=e.oxw();return e.KtG(r.resourceAdd(t))})("buttonOnClick",function(t){e.CHM(a);const r=e.oxw();return e.KtG(r.onClick(t))}),e.qZA()}2&i&&e.Q6J("isEmitMouseEvent",!0)}function ne(i,c){if(1&i){const a=e.EpF();e.TgZ(0,"app-button",53),e.NdJ("buttonOnClick",function(t){e.CHM(a);const r=e.oxw();return e.KtG(r.resourceAdd(t))})("buttonOnClick",function(t){e.CHM(a);const r=e.oxw();return e.KtG(r.onClick(t))}),e.qZA()}2&i&&e.Q6J("isEmitMouseEvent",!0)}function oe(i,c){if(1&i&&(e.TgZ(0,"tr",55)(1,"td",56),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&i){const a=e.oxw().$implicit;e.xp6(1),e.uIk("colspan",a[0].length+1),e.xp6(1),e.hij(" ",e.lcZ(3,2,"COMMON_VALIDATION_MESSAGES.VALID_NO_RESULTS_FOUND"),"")}}function le(i,c){if(1&i&&e.YNc(0,oe,4,4,"tr",54),2&i){const a=e.oxw();e.Q6J("ngIf",a.salesrepsData&&0==a.salesrepsData.length)}}function ce(i,c){if(1&i&&(e.TgZ(0,"th"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i){const a=c.$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,1,a.header)," ")}}function pe(i,c){if(1&i&&(e.TgZ(0,"tr"),e.YNc(1,ce,3,3,"th",57),e.qZA()),2&i){const a=c.$implicit;e.xp6(1),e.Q6J("ngForOf",a[0])}}function de(i,c){if(1&i){const a=e.EpF();e.TgZ(0,"td",59),e.NdJ("click",function(){e.CHM(a);const t=e.oxw(),r=t.rowIndex,o=t.$implicit,d=e.oxw();return e.KtG(d.editResource(r,o))}),e._uU(1),e.qZA()}if(2&i){const a=c.$implicit,s=e.oxw().$implicit;e.Gre("",a.class," cursor-pointer"),e.Q6J("pSelectableRow",s),e.xp6(1),e.hij(" ",s[a.field]," ")}}function ue(i,c){if(1&i&&(e.TgZ(0,"tr"),e.YNc(1,de,2,5,"td",58),e.qZA()),2&i){const a=c.columns;e.xp6(1),e.Q6J("ngForOf",a[0])}}function me(i,c){if(1&i&&(e.TgZ(0,"div",3)(1,"strong"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4," : "),e._UZ(5,"span",61)(6,"br"),e.qZA()),2&i){const a=c.$implicit,s=e.oxw().$implicit;e.xp6(2),e.Oqu(e.lcZ(3,2,a.header)),e.xp6(3),e.Q6J("innerHTML",s[a.field],e.oJD)}}function he(i,c){if(1&i&&(e.TgZ(0,"tr")(1,"td")(2,"div",2),e.YNc(3,me,7,4,"div",60),e.qZA()()()),2&i){const a=c.columns;e.xp6(1),e.uIk("colspan",a[0].length+2),e.xp6(2),e.Q6J("ngForOf",a[1])}}let ge=(()=>{class i extends A.O{apiEndPointUrl;columnsheaders;crmSalesRepsService;loggerService;navigationService;router;translateService;uiUtils;commonservice;route;statusDrop;managerDropDown;EffectiveDateError;apiEndPoint;createdBy;createdDate;crmSalesrepViewData;defaultStatus;effectiveEndDateValue;effectivestartDateValue;email;enableCheckBox;enterpriseId;enterpriseObj;enterprise_short_name;error;errorMsg;header;lastUpdatedBy;lastUpdatedDate;managerName;managerOptions;managersObj;object_type;phoneNumber;recordId;resorceEnable;salesrepName;salesrepRowIndex;salesrepsData=[];statusFlag=!0;statusObj;statusOptions;userProfileId;dataJsonObj={};constructor(a,s,t,r,o,d,p,S,m,u){super(u,m),this.apiEndPointUrl=a,this.columnsheaders=s,this.crmSalesRepsService=t,this.loggerService=r,this.navigationService=o,this.router=d,this.translateService=p,this.uiUtils=S,this.commonservice=m,this.route=u,this.route.params.subscribe(h=>{this.recordId=h.id})}ngOnInit(){}ngAfterContentInit(){this.initializeComponent()}initializeComponent(){this.dataJsonObj.pageName=n.hf.CRM_SALESREPS,this.dataJsonObj.pageTitle=[{key:"CRM_ACCOUNTS.CRM_SALES_REP",value:this.dataJsonObj.sportRecordData.display_name,showSubMenuDisplayName:!1},{key:"",value:"-",showSubMenuDisplayName:!1},{key:"COMMON_BUTTONS.BUTTON_EDIT",value:"",showSubMenuDisplayName:!1}],this.enterpriseId=localStorage.getItem(n.BU.SELECTED_ENTERPRISE),this.apiEndPoint=localStorage.getItem(n.BU.S3_URL)?localStorage.getItem(n.BU.S3_URL):this.apiEndPointUrl,this.object_type=this.route.snapshot.data.object_type,document.getElementsByTagName("body"),this.getCrmAccountsViewData(),this.dataJsonObj.showrecordhistory=this.roleRightsValidationByPage(n.hf.CRM_SALESREPS,n.AM.ACTIONS,n.In.RECORD_HISTORY),this.header=[[{headersort:"disableth",field:"work_resource_name",header:this.translateService.instant("CRM_ACCOUNTS.CRM_SALES_REP_MANAGER"),class:""},{headersort:"disableth",field:"effective_startdate",header:this.translateService.instant("COMMON_FIELDS.START_DATE"),class:"w-140 list-value-right"},{headersort:"disableth",field:"effective_enddate",header:this.translateService.instant("COMMON_FIELDS.END_DATE"),class:"w-140 list-value-right"},{headersort:"disableth",field:"statusName",header:this.translateService.instant("COMMON_FIELDS.STATUS"),class:"w-200"}],[]],this.commonService.getLookupCodesListJson(this.enterpriseId,"list").then(s=>{this.dataJsonObj.lookupCodesListJSON=s,this.getStatusOptions("")}),this.getManagersList("")}getCrmAccountsViewData(){try{this.crmSalesRepsService.getCRMSalesRepViewData(this.recordId).subscribe(a=>{this.crmSalesrepViewData=a,this.salesrepName=this.crmSalesrepViewData.work_resourse.work_resource_name,this.commonservice.setCurrentPageTitle(this.salesrepName,this.recordId),this.phoneNumber=a.work_resourse.mobile_number?a.work_resourse.mobile_number:"",this.email=a.work_resourse.email?a.work_resourse.email:"",this.createdBy=this.crmSalesrepViewData.created_by,this.lastUpdatedBy=this.crmSalesrepViewData.updated_by,this.salesrepsData=this.crmSalesrepViewData.sales_profile;for(let s=0;s<this.salesrepsData.length;s++)this.salesrepsData[s].statusName=this.salesrepsData[s].status?this.lookupLanguageTranslations(this.salesrepsData[s].status.lookup_id):"",this.salesrepsData[s].status=this.salesrepsData[s].status,this.salesrepsData[s].work_resource_name=this.salesrepsData[s].manager?this.salesrepsData[s].manager.work_resource_name:"",this.salesrepsData[s].effective_startdate=this.salesrepsData[s].effective_start_date?this.commonservice.dbTimezoneFormatWithHours(this.salesrepsData[s].effective_start_date):"",this.salesrepsData[s].effective_enddate=this.salesrepsData[s].effective_end_date?this.commonservice.dbTimezoneFormatWithHours(this.salesrepsData[s].effective_end_date):"",this.statusFlag="ACTIVE"!==this.salesrepsData[s].status.lookup_name},a=>{this.loggerService.setLoggerError(this.constructor.name,"getCrmAccountsViewData",a)})}catch(a){this.loggerService.setLoggerError(this.constructor.name,"getCrmAccountsViewData",a)}}getManagersList(a){try{this.crmSalesRepsService.getWorkResourceDrop(a,this.enterpriseId).then(s=>{this.managerOptions=s}).catch(s=>{this.loggerService.setLoggerError(this.constructor.name,"getWorkResourceDrop",s)})}catch(s){this.loggerService.setLoggerError(this.constructor.name,"getManagersList",s)}}getManager(a){try{this.managerName=a.NAME,this.managersObj=a}catch(s){this.loggerService.setLoggerError(this.constructor.name,"getManager",s)}}getStatusOptions(a){try{this.commonService.getFilteredLookupCodes(this.dataJsonObj.lookupCodesListJSON[n.ox.WORK_CLIENT_STATUSES],a).then(s=>{this.statusOptions=s},s=>{this.loggerService.setLoggerError(this.constructor.name,"getStatusOptions",s)})}catch(s){this.loggerService.setLoggerError(this.constructor.name,"getStatusOptions",s)}}changeStatus(a){try{this.defaultStatus=a.value,this.statusObj=this.statusOptions.find(s=>s.ID===parseInt(this.defaultStatus,10))}catch(s){this.loggerService.setLoggerError(this.constructor.name,"changeStatus",s)}}getEffectiveStartDateChange(a){try{this.EffectiveDateError="",this.errorMsg="",this.effectivestartDateValue=a.value}catch(s){this.loggerService.setLoggerError(this.constructor.name,"getEffectiveStartDateChange",s)}}getEffectiveEndDateChange(a){try{this.EffectiveDateError="",this.errorMsg="",this.effectiveEndDateValue=a.value}catch(s){this.loggerService.setLoggerError(this.constructor.name,"getEffectiveEndDateChange",s)}}EditSalesRep(){try{this.crmSalesRepsService.getCRMSalesRepEditData(this.recordId,{sales_profile:this.salesrepsData}).then(s=>{this.uiUtils.displaytoastMessage("COMMON_TOAST_MESSAGES.TOAST_SUCCESS_EDIT"),this.commonService.redirectToPreviousUrl()},s=>{this.commonErrorCodes(JSON.parse(s))})}catch(a){this.loggerService.setLoggerError(this.constructor.name,"submit",a)}}commonErrorCodes(a){409===JSON.parse(a[n.BU.STATUS])&&(this.error=this.translateService.instant("COMMON_STATUS_CODES.409"))}cancel(){try{this.commonService.redirectToPreviousUrl()}catch(a){this.loggerService.setLoggerError(this.constructor.name,"cancel",a)}}resourceAdd(a){try{this.EffectiveDateError="",this.errorMsg="",this.managerName="",this.defaultStatus="",this.effectivestartDateValue=new Date,this.effectiveEndDateValue=new Date,!0===this.statusFlag&&($("#exampleModal1").modal("show"),$(".modal-backdrop").insertAfter("#exampleModal1"))}catch(s){this.loggerService.setLoggerError(this.constructor.name,"resourceAdd",s)}}onClick(a){a.stopPropagation()}editResource(a,s){try{$("#exampleModal2").modal("show"),$(".modal-backdrop").insertAfter("#exampleModal2"),this.EffectiveDateError="",this.errorMsg="",this.salesrepRowIndex=a,this.managerName=s.work_resource_name,s.manager.work_resource_name=s.work_resource_name,this.managersObj=s.manager,this.statusObj=s.status,this.defaultStatus=s.status.lookup_id,this.effectivestartDateValue=s.effective_start_date,this.effectiveEndDateValue=s.effective_end_date}catch(t){this.loggerService.setLoggerError(this.constructor.name,"editResource",t)}}ResourceEditSubmit(){try{if(this.statusDrop.isValid())if(this.effectiveEndDateValue&&new Date(this.effectiveEndDateValue)<new Date(this.effectivestartDateValue))this.EffectiveDateError="COMMON_VALIDATION_MESSAGES.VALID_NOBLANK_END_DATE_GREATER_START";else{for(let a=0;a<this.salesrepsData.length;a++)a===this.salesrepRowIndex&&(this.salesrepsData[a].work_resource_id=this.managersObj.work_resource_id,this.salesrepsData[a].work_resource_name=this.managersObj.work_resource_name,this.salesrepsData[a].manager=this.managersObj,this.salesrepsData[a].status=this.statusObj,this.salesrepsData[a].statusName=this.statusObj?this.lookupLanguageTranslations(this.statusObj.lookup_id):"",this.salesrepsData[a].effective_startdate=v(this.effectivestartDateValue).format("DD-MMM-YYYY HH:MM"),this.salesrepsData[a].effective_start_date=this.effectivestartDateValue,this.salesrepsData[a].effective_enddate=v(this.effectiveEndDateValue).format("DD-MMM-YYYY HH:MM"),this.salesrepsData[a].effective_end_date=this.effectiveEndDateValue,this.statusFlag="Active"!==this.salesrepsData[a].statusName);$("#exampleModal2").modal("hide")}}catch(a){this.loggerService.setLoggerError(this.constructor.name,"ResourceEditSubmit",a)}}ResourceAddSubmit(){try{if(this.managerDropDown.isValid()&&this.statusDrop.isValid())if(this.effectiveEndDateValue&&new Date(this.effectiveEndDateValue)<new Date(this.effectivestartDateValue))this.EffectiveDateError="COMMON_VALIDATION_MESSAGES.VALID_NOBLANK_END_DATE_GREATER_START";else if(this.salesrepsData.find(s=>s.manager.work_resource_id===parseInt(this.managersObj.work_resource_id,10)))this.EffectiveDateError="COMMON_VALIDATION_MESSAGES.VALID_RECORD_ALREADY_EXISTS";else{const s={work_resource_id:this.managersObj.ID,work_resource_name:this.managersObj.NAME,manager:{work_resource_id:this.managersObj.work_resource_id,work_resource_name:this.managersObj.NAME,user_profile:this.managersObj.user_profile,f_name:this.managersObj.f_name,l_name:this.managersObj.l_name,short_name:this.managersObj.short_name},status:this.statusObj,statusName:this.statusObj?this.lookupLanguageTranslations(this.statusObj.lookup_id):"",effective_startdate:v(this.effectivestartDateValue).format("DD-MMM-YYYY HH:MM"),effective_start_date:this.effectivestartDateValue,effective_enddate:v(this.effectiveEndDateValue).format("DD-MMM-YYYY HH:MM"),effective_end_date:this.effectiveEndDateValue};"Active"===s.statusName&&(this.statusFlag=!1),this.salesrepsData.push(s),$("#exampleModal1").modal("hide")}}catch(a){this.loggerService.setLoggerError(this.constructor.name,"ResourceAddSubmit",a)}}cancelPopBtn(){try{document.getElementsByTagName("body")[0].classList.remove("modale-popup-open")}catch(a){this.loggerService.setLoggerError(this.constructor.name,"cancelPopBtn",a)}}getResorceEnabled(a){}static \u0275fac=function(s){return new(s||i)(e.Y36("apiEndPoint"),e.Y36(E.Y),e.Y36(_),e.Y36(D.m),e.Y36(w.f),e.Y36(g.F0),e.Y36(b.sK),e.Y36(N.s),e.Y36(f.v),e.Y36(g.gz))};static \u0275cmp=e.Xpm({type:i,selectors:[["app-crm-salesreps-edit"]],viewQuery:function(s,t){if(1&s&&(e.Gf(se,5),e.Gf(re,5)),2&s){let r;e.iGM(r=e.CRH())&&(t.statusDrop=r.first),e.iGM(r=e.CRH())&&(t.managerDropDown=r.first)}},features:[e._Bn([f.v,E.Y,_]),e.qOj],decls:117,vars:132,consts:[[1,"container-fluid"],[1,"forms-wrapper"],[1,"row","g-0"],[1,"col-md-12"],[1,"card"],["id","stickyHeaderID",1,"card-header","card-header-primary"],[1,"subpage-header-title","w-100",3,"pageName","pageTitle","showPageHeaderItems","showDependencySubMenu"],[1,"card-body"],[1,"row","form-bs"],[1,"col-md-4"],["disabled","true","id","crmSalesReps-edit-enterprise_name",3,"label","value"],["disabled","true","id","crmSalesReps-view-enterprisename",3,"label","value"],[1,"col-md-4","text-end","mt-2"],["className","btn btn-primary btn-sm",1,"mgr-5",3,"label","id","buttonOnClick"],["className","btn btn-danger btn-sm",3,"label","id","buttonOnClick"],[1,"error-msg","col-md-12","text-danger","text-center","mb-0"],["id","extraPaddingBottomID",1,"card-content"],[3,"multiple"],[1,"list-accordion-tab",3,"selected"],[1,"d-flex","justify-content-between","w-100","accordion-header"],["disabled","false","label","","className","btn btn-danger btn-sm btn-round btn-rounded","btnIcon","fas fa-plus","id","enterprise-create-linesadd",3,"isEmitMouseEvent","buttonOnClick",4,"ngIf"],["disabled","true","label","","className","btn btn-danger btn-sm btn-round btn-rounded","btnIcon","fas fa-plus","id","enterprise-create-linesadd",3,"isEmitMouseEvent","buttonOnClick",4,"ngIf"],["selectionMode","single","dataKey","LineNum",1,"ptable","max-height",3,"columns","value","rows","lazy","responsive","autoLayout"],["pTemplate","emptymessage"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],[3,"createdBy","lastUpdatedBy","showrecordhistory","creationDate","lastUpdatedDate"],["id","exampleModal1","tabindex","-1","role","dialog","aria-labelledby","exampleModalLabel","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-lg","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header",2,"border-top-left-radius","2px","border-top-right-radius","2px"],["id","exampleModalLabel",1,"modal-title"],[1,"modal-body","ios-content"],["mandatory","true",3,"label","options","defaultValue","selectedOption","searchValueChange"],["managerDropDown",""],[1,"col-md-2"],["mandatory","true","id","crmSalesReps-create-status",3,"label","options","maxlength","defaultValue","valueChange"],["statusDrop",""],[1,"col-md-3"],["dateformat","dd-MMM-yyyy","disabled","false","mandatory","true",3,"placeholder","defaultDate","id","editvalueChange"],["dateformat","dd-MMM-yyyy","disabled","false",3,"placeholder","defaultDate","id","editvalueChange"],[1,"col-md-3","d-flex","align-items-center"],["label","","mandatory","false",3,"options","checked","id","valueChange"],[1,"col-md-12","text-end","mt-2"],["className","btn btn-danger btn-sm","data-bs-dismiss","modal","aria-label","Close",3,"label","id","buttonOnClick"],["id","exampleModal2","tabindex","-1","role","dialog","aria-labelledby","exampleModalLabel","aria-hidden","true",1,"modal","fade"],["mandatory","false","id","work-tasks-create-resource-editpopup-ResourceName","disabled","true",3,"label","value"],["mandatory","true","id","Clients-create-status",3,"label","options","maxlength","defaultValue","valueChange"],["EditEffectiveStartDate",""],["className","btn btn-primary btn-sm","id","work-tasks-create-resource-updatepopup-updatebutton",1,"mgr-5",3,"label","buttonOnClick"],["className","btn btn-danger btn-sm","data-bs-dismiss","modal","aria-label","Close","id","work-tasks-create-resource-updatepopup-cancel",3,"label","buttonOnClick"],["disabled","false","label","","className","btn btn-danger btn-sm btn-round btn-rounded","btnIcon","fas fa-plus","id","enterprise-create-linesadd",3,"isEmitMouseEvent","buttonOnClick"],["disabled","true","label","","className","btn btn-danger btn-sm btn-round btn-rounded","btnIcon","fas fa-plus","id","enterprise-create-linesadd",3,"isEmitMouseEvent","buttonOnClick"],["class","no-results-found",4,"ngIf"],[1,"no-results-found"],[1,"text-center","text-danger"],[4,"ngFor","ngForOf"],["data-toggle","modal","data-bs-target","#exampleModal2",3,"pSelectableRow","class","click",4,"ngFor","ngForOf"],["data-toggle","modal","data-bs-target","#exampleModal2",3,"pSelectableRow","click"],["class","col-md-12",4,"ngFor","ngForOf"],[3,"innerHTML"]],template:function(s,t){1&s&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5),e._UZ(6,"app-pageheader",6),e.qZA(),e.TgZ(7,"div",7)(8,"div",8)(9,"div",9),e._UZ(10,"app-input",10),e.ALo(11,"translate"),e.qZA(),e.TgZ(12,"div",9),e._UZ(13,"app-input",11),e.ALo(14,"translate"),e.qZA(),e.TgZ(15,"div",9),e._UZ(16,"app-input",11),e.ALo(17,"translate"),e.qZA(),e.TgZ(18,"div",9),e._UZ(19,"app-input",11),e.ALo(20,"translate"),e.qZA(),e.TgZ(21,"div",9),e._UZ(22,"app-input",11),e.ALo(23,"translate"),e.qZA(),e.TgZ(24,"div",12)(25,"app-button",13),e.NdJ("buttonOnClick",function(){return t.EditSalesRep()}),e.ALo(26,"translate"),e.qZA(),e.TgZ(27,"app-button",14),e.NdJ("buttonOnClick",function(){return t.cancel()}),e.ALo(28,"translate"),e.qZA()(),e.TgZ(29,"div",15),e._uU(30),e.ALo(31,"translate"),e.qZA()()()()(),e.TgZ(32,"div",3)(33,"div",4)(34,"div",16)(35,"p-accordion",17)(36,"p-accordionTab",18)(37,"p-header",19)(38,"span"),e._uU(39),e.ALo(40,"translate"),e.qZA(),e.YNc(41,ie,1,1,"app-button",20),e.YNc(42,ne,1,1,"app-button",21),e.qZA(),e.TgZ(43,"p-table",22),e.YNc(44,le,1,1,"ng-template",23),e.YNc(45,pe,2,1,"ng-template",24),e.YNc(46,ue,2,1,"ng-template",25),e.YNc(47,he,4,2,"ng-template",26),e.qZA()(),e._UZ(48,"app-recordhistory",27),e.qZA()()()()()()(),e.TgZ(49,"div",28)(50,"div",29)(51,"div",30)(52,"div",31)(53,"div",32),e._uU(54),e.ALo(55,"translate"),e.ALo(56,"translate"),e.qZA()(),e.TgZ(57,"div",33)(58,"div",8)(59,"div",9)(60,"app-dropdown-search",34,35),e.NdJ("selectedOption",function(o){return t.getManager(o)})("searchValueChange",function(o){return t.getManagersList(o)}),e.ALo(62,"translate"),e.qZA()(),e.TgZ(63,"div",36)(64,"app-dropdown-singleselect",37,38),e.NdJ("valueChange",function(o){return t.changeStatus(o)}),e.ALo(66,"translate"),e.qZA()(),e.TgZ(67,"div",39)(68,"app-datetimepicker",40),e.NdJ("editvalueChange",function(o){return t.getEffectiveStartDateChange(o)}),e.ALo(69,"translate"),e.qZA()(),e.TgZ(70,"div",39)(71,"app-datetimepicker",41),e.NdJ("editvalueChange",function(o){return t.getEffectiveEndDateChange(o)}),e.ALo(72,"translate"),e.qZA()(),e.TgZ(73,"div",42)(74,"app-checkbox",43),e.NdJ("valueChange",function(o){return t.getResorceEnabled(o)}),e.qZA()(),e.TgZ(75,"div",44)(76,"app-button",13),e.NdJ("buttonOnClick",function(){return t.ResourceAddSubmit()}),e.ALo(77,"translate"),e.qZA(),e.TgZ(78,"app-button",45),e.NdJ("buttonOnClick",function(){return t.cancelPopBtn()}),e.ALo(79,"translate"),e.qZA()(),e.TgZ(80,"div",15),e._uU(81),e.ALo(82,"translate"),e.qZA()()()()()(),e.TgZ(83,"div",46)(84,"div",29)(85,"div",30)(86,"div",31)(87,"div",32),e._uU(88),e.ALo(89,"translate"),e.ALo(90,"translate"),e.qZA()(),e.TgZ(91,"div",33)(92,"div",8)(93,"div",9),e._UZ(94,"app-input",47),e.ALo(95,"translate"),e.qZA(),e.TgZ(96,"div",36)(97,"app-dropdown-singleselect",48,38),e.NdJ("valueChange",function(o){return t.changeStatus(o)}),e.ALo(99,"translate"),e.qZA()(),e.TgZ(100,"div",39)(101,"app-datetimepicker",40,49),e.NdJ("editvalueChange",function(o){return t.getEffectiveStartDateChange(o)}),e.ALo(103,"translate"),e.qZA()(),e.TgZ(104,"div",39)(105,"app-datetimepicker",41),e.NdJ("editvalueChange",function(o){return t.getEffectiveEndDateChange(o)}),e.ALo(106,"translate"),e.qZA()(),e.TgZ(107,"div",42)(108,"app-checkbox",43),e.NdJ("valueChange",function(o){return t.getResorceEnabled(o)}),e.qZA()(),e.TgZ(109,"div",44)(110,"app-button",50),e.NdJ("buttonOnClick",function(){return t.ResourceEditSubmit()}),e.ALo(111,"translate"),e.qZA(),e.TgZ(112,"app-button",51),e.NdJ("buttonOnClick",function(){return t.cancelPopBtn()}),e.ALo(113,"translate"),e.qZA()(),e.TgZ(114,"div",15),e._uU(115),e.ALo(116,"translate"),e.qZA()()()()()()),2&s&&(e.xp6(6),e.Q6J("pageName",t.dataJsonObj.pageName)("pageTitle",t.dataJsonObj.pageTitle)("showPageHeaderItems",!1)("showDependencySubMenu",!1),e.xp6(4),e.s9C("label",e.lcZ(11,78,"COMMON_PAGE_TITLES.ENTERPRISE")),e.s9C("value",null==t.crmSalesrepViewData||null==t.crmSalesrepViewData.enterprise?null:t.crmSalesrepViewData.enterprise.short_name),e.xp6(3),e.s9C("label",e.lcZ(14,80,"COMMON_FIELDS.BUSINESS_ENTITY")),e.Q6J("value",t.lookupLanguageTranslations(null==t.crmSalesrepViewData||null==t.crmSalesrepViewData.business_entity_name?null:t.crmSalesrepViewData.business_entity_name.lookup_id)),e.xp6(3),e.s9C("label",e.lcZ(17,82,"CRM_ACCOUNTS.CRM_SALES_REP")),e.s9C("value",t.salesrepName),e.xp6(3),e.s9C("label",e.lcZ(20,84,"COMMON_FIELDS.PHONE_NUMBER")),e.s9C("value",t.phoneNumber),e.xp6(3),e.s9C("label",e.lcZ(23,86,"COMMON_FIELDS.EMAIL")),e.s9C("value",t.email),e.xp6(3),e.s9C("label",e.lcZ(26,88,"COMMON_BUTTONS.BUTTON_SUBMIT")),e.MGl("id","crmSalesReps-",t.object_type,"-edit-submit"),e.xp6(2),e.s9C("label",e.lcZ(28,90,"COMMON_BUTTONS.BUTTON_CANCEL")),e.MGl("id","crmSalesReps-",t.object_type,"-edit-cancel"),e.xp6(3),e.hij(" ",e.lcZ(31,92,t.error)," "),e.xp6(5),e.Q6J("multiple",!0),e.xp6(1),e.Q6J("selected",!0),e.xp6(3),e.Oqu(e.lcZ(40,94,"CRM_ACCOUNTS.CRM_SALES_PROFILES")),e.xp6(2),e.Q6J("ngIf",!0===t.statusFlag),e.xp6(1),e.Q6J("ngIf",!1===t.statusFlag),e.xp6(1),e.Q6J("columns",t.header)("value",t.salesrepsData)("rows",10)("lazy",!0)("responsive",!0)("autoLayout",!0),e.xp6(5),e.Q6J("createdBy",t.createdBy)("lastUpdatedBy",t.lastUpdatedBy)("showrecordhistory",t.dataJsonObj.showrecordhistory)("creationDate",null==t.crmSalesrepViewData?null:t.crmSalesrepViewData.createdAt)("lastUpdatedDate",null==t.crmSalesrepViewData?null:t.crmSalesrepViewData.updatedAt),e.xp6(6),e.AsE("",e.lcZ(55,96,"CRM_ACCOUNTS.CRM_SALES_PROFILE")," - ",e.lcZ(56,98,"COMMON_BUTTONS.BUTTON_ADD"),""),e.xp6(6),e.s9C("label",e.lcZ(62,100,"CRM_ACCOUNTS.CRM_SALES_REP_MANAGER")),e.s9C("defaultValue",t.managerName),e.Q6J("options",t.managerOptions),e.xp6(4),e.s9C("label",e.lcZ(66,102,"COMMON_FIELDS.STATUS")),e.s9C("defaultValue",t.defaultStatus),e.Q6J("options",t.statusOptions)("maxlength",40),e.xp6(4),e.s9C("placeholder",e.lcZ(69,104,"COMMON_FIELDS.START_DATE")),e.MGl("id","crmSalesReps-create-",t.object_type,"-resource-addpopup-effectivestartDateValue"),e.Q6J("defaultDate",t.effectivestartDateValue),e.xp6(3),e.s9C("placeholder",e.lcZ(72,106,"COMMON_FIELDS.END_DATE")),e.MGl("id","crmSalesReps-create-",t.object_type,"-resource-addpopup-effectiveEndDateValue"),e.Q6J("defaultDate",t.effectiveEndDateValue),e.xp6(3),e.MGl("id","crmSalesReps-create-",t.object_type,"-resource-addpopup-resorceEnable"),e.Q6J("options",t.enableCheckBox)("checked",t.resorceEnable),e.xp6(2),e.s9C("label",e.lcZ(77,108,"COMMON_BUTTONS.BUTTON_ADD")),e.MGl("id","crmSalesReps-create-",t.object_type,"-resource-addpopup-ResourceAddSubmit"),e.xp6(2),e.s9C("label",e.lcZ(79,110,"COMMON_BUTTONS.BUTTON_CANCEL")),e.MGl("id","crmSalesReps-create-",t.object_type,"-resource-addpopup-ResourceAddClose"),e.xp6(3),e.hij(" ",e.lcZ(82,112,t.EffectiveDateError)," "),e.xp6(7),e.AsE("",e.lcZ(89,114,"CRM_ACCOUNTS.CRM_SALES_PROFILE")," - ",e.lcZ(90,116,"COMMON_BUTTONS.BUTTON_EDIT"),""),e.xp6(6),e.s9C("label",e.lcZ(95,118,"CRM_ACCOUNTS.CRM_SALES_REP_MANAGER")),e.s9C("value",t.managerName),e.xp6(3),e.s9C("label",e.lcZ(99,120,"COMMON_FIELDS.STATUS")),e.s9C("defaultValue",t.defaultStatus),e.Q6J("options",t.statusOptions)("maxlength",40),e.xp6(4),e.s9C("placeholder",e.lcZ(103,122,"COMMON_FIELDS.START_DATE")),e.MGl("id","work-tasks-create-",t.object_type,"-resource-updatepopup-effectivestartdate"),e.Q6J("defaultDate",t.effectivestartDateValue),e.xp6(4),e.s9C("placeholder",e.lcZ(106,124,"COMMON_FIELDS.END_DATE")),e.MGl("id","work-tasks-create-",t.object_type,"-resource-updatepopup-effectiveenddate"),e.Q6J("defaultDate",t.effectiveEndDateValue),e.xp6(3),e.MGl("id","work-tickets-create-",t.object_type,"-resource-addpopup-resorceEnable"),e.Q6J("options",t.enableCheckBox)("checked",t.resorceEnable),e.xp6(2),e.s9C("label",e.lcZ(111,126,"COMMON_BUTTONS.BUTTON_UPDATE")),e.xp6(2),e.s9C("label",e.lcZ(113,128,"COMMON_BUTTONS.BUTTON_CANCEL")),e.xp6(3),e.hij(" ",e.lcZ(116,130,t.EffectiveDateError)," "))},dependencies:[M.sg,M.O5,R.iA,L.h4,L.jx,R.Ei,O.UQ,O.US,I.r,j.a,P.k,ae.b,k.L,B.C,F.W,y.q,b.X$]})}return i})();var Z=l(15861),Se=l(28168),Y=l(30578),q=l(70057),_e=l(44393),be=l(88425);const Ce=["datatableComponent"];function ve(i,c){if(1&i&&(e.TgZ(0,"tr",40)(1,"td",41),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&i){const a=e.oxw().$implicit;e.xp6(1),e.uIk("colspan",a[0].length+1),e.xp6(1),e.hij(" ",e.lcZ(3,2,"COMMON_VALIDATION_MESSAGES.VALID_NO_RESULTS_FOUND"),"")}}function Ee(i,c){if(1&i&&e.YNc(0,ve,4,4,"tr",39),2&i){const a=e.oxw();e.Q6J("ngIf",a.salesrepsData&&0==a.salesrepsData.length)}}function Oe(i,c){if(1&i&&(e.TgZ(0,"th"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i){const a=c.$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,1,a.header)," ")}}function Me(i,c){if(1&i&&(e.TgZ(0,"tr"),e.YNc(1,Oe,3,3,"th",42),e.qZA()),2&i){const a=c.$implicit;e.xp6(1),e.Q6J("ngForOf",a[0])}}function Re(i,c){if(1&i){const a=e.EpF();e.TgZ(0,"td",44),e.NdJ("click",function(){e.CHM(a);const t=e.oxw(),r=t.rowIndex,o=t.$implicit,d=e.oxw();return e.KtG(d.viewResource(r,o))}),e._uU(1),e.qZA()}if(2&i){const a=c.$implicit,s=e.oxw().$implicit;e.Gre("",a.class," cursor-pointer"),e.Q6J("pSelectableRow",s),e.xp6(1),e.hij(" ",s[a.field]," ")}}function Te(i,c){if(1&i&&(e.TgZ(0,"tr"),e.YNc(1,Re,2,5,"td",43),e.qZA()),2&i){const a=c.columns;e.xp6(1),e.Q6J("ngForOf",a[0])}}function Ae(i,c){if(1&i&&(e.TgZ(0,"div",3)(1,"strong"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4," : "),e._UZ(5,"span",46)(6,"br"),e.qZA()),2&i){const a=c.$implicit,s=e.oxw().$implicit;e.xp6(2),e.Oqu(e.lcZ(3,2,a.header)),e.xp6(3),e.Q6J("innerHTML",s[a.field],e.oJD)}}function De(i,c){if(1&i&&(e.TgZ(0,"tr")(1,"td")(2,"div",2),e.YNc(3,Ae,7,4,"div",45),e.qZA()()()),2&i){const a=c.columns;e.xp6(1),e.uIk("colspan",a[0].length+2),e.xp6(2),e.Q6J("ngForOf",a[1])}}const ye=[{path:"",data:{title:"crmsalesreps"},children:[{path:"",redirectTo:"crmsalesreps/list",pathMatch:"full"},{path:"crmsalesreps/list",component:(()=>{class i extends A.O{translateService;ColumnHeader;crmSalesRepsService;listingVariables;uiUtils;loggerService;router;route;commonService;actionSheetController;datatableComponent;searchValueChange=new e.vpe;actionStatus;actions;crmSalesRepsMobileList=[];defaultPageName;enterpriseId;forcerefresh;isFilterClicked=!1;listdata;mobileroutesArray=[];noDuplicates=void 0;objectType;show=!0;searchString;statsStatus;statusObj;tableColumnheaders;webListdata;dataJsonObj={};constructor(a,s,t,r,o,d,p,S,m,u){super(S,m),this.translateService=a,this.ColumnHeader=s,this.crmSalesRepsService=t,this.listingVariables=r,this.uiUtils=o,this.loggerService=d,this.router=p,this.route=S,this.commonService=m,this.actionSheetController=u,this.route.queryParams.subscribe(h=>{this.dataJsonObj.queryParamsObj={defaultView:h.default_view,selectedMenuId:h.selectedMenuId,selectedSubMenuId:h.selectedSubMenuId}})}ngOnInit(){}ngAfterContentInit(){this.initializeComponent()}initializeComponent(){this.showSpinner(),this.dataJsonObj.pageName=n.hf.CRM_SALESREPS,this.dataJsonObj.pageTitle=[{key:"COMMON_FIELDS.ALL",value:"",showSubMenuDisplayName:!1},{key:"CRM_ACCOUNTS.CRM_SALES_REP",value:"",showSubMenuDisplayName:!0}],this.dataJsonObj.htmlPageRolesEnumValuesJson={pageEnum:n.hf,pageSettingEnum:n.AM,pageSettingFieldsEnum:n.In},this.dataJsonObj.advancedSearchObj={},this.objectType=this.route.snapshot.data.object_type,this.defaultPageName="crmSalesReps",document.getElementsByTagName("body"),this.enterpriseId=localStorage.getItem(n.BU.SELECTED_ENTERPRISE),this.tableColumnheaders=this.ColumnHeader.getCrmSalesRepsColumnHeaders(),this.listingVariables.pageNumbers=1,this.listingVariables.totalRecords=1,this.searchString="",this.actions={EDIT:this.roleRightsValidationByPage(n.hf.CRM_SALESREPS,n.AM.ACTIONS,n.In.EDIT),VIEW:this.roleRightsValidationByPage(n.hf.CRM_SALESREPS,n.AM.ACTIONS,n.In.VIEW)},this.forcerefresh=!1,this.commonService.currentEvent.subscribe(s=>{"crmsalesrepss"===s&&(this.forcerefresh=!0)}),this.dataJsonObj.addFiltersList=[],this.dataJsonObj.pageActionsList=[],this.roleRightsValidationByPage(n.hf.CRM_SALESREPS,n.AM.ACTIONS,n.In.CREATE)&&this.dataJsonObj.pageActionsList.push({actionName:"CREATE",displayName:"COMMON_BUTTONS.BUTTON_CREATE",actionType:n.gL.URL,redirectURL:"/crmsalesreps/crmsalesreps/create",queryParams:"",iconClass:"fas fa-plus"}),this.roleRightsValidationByPage(n.hf.CRM_SALESREPS,n.AM.ACTIONS,n.In.IMPORT)&&this.dataJsonObj.pageActionsList.push({actionName:"IMPORT",displayName:"COMMON_BUTTONS.BUTTON_IMPORT",actionType:n.gL.POPUP,redirectURL:"",queryParams:"",iconClass:"fas fa-file-import mr-1"}),this.roleRightsValidationByPage(n.hf.CRM_SALESREPS,n.AM.ACTIONS,n.In.FILTERS)}getCrmSalesRepsListing(){try{const a=this.commonService.getMobileViewCondition(this.dataJsonObj.selectedDisplayView);this.statsStatus=this.statusObj;const s=this.dataJsonObj.selectedFilter?"&filtertype="+this.dataJsonObj.selectedFilter:"";this.showSpinner(),this.crmSalesRepsService.getCrmSalesRepsList(this.listingVariables.pageNumbers,this.listingVariables.rowsPerPage,this.listingVariables.sortOrderColumn,this.searchString,this.enterpriseId,this.forcerefresh,this.statsStatus,this.isFilterClicked,a,s,this.dataJsonObj.advancedSearchObj.inputAdvSearchObj).subscribe(t=>{if(this.hideSpinner(),t.rows.length>0){this.crmSalesRepsMobileList&&this.crmSalesRepsMobileList.length>0||(this.crmSalesRepsMobileList=[]);for(let r=0;r<t.rows.length;r++){t.rows[r].enterprise.short_name='<a class="enable" id="enterprise.short_name'+t.rows[r]._id+'" href="enterprises/enterprises/'+t.rows[r].enterprise.enterprise_id+'/view" >'+t.rows[r].enterprise.short_name;const o={url:`crmsalesreps/crmsalesreps/${t.rows[r]._id}/view`,queryParams:this.dataJsonObj.queryParamsObj?this.dataJsonObj.queryParamsObj:""},d=o.queryParams&&Object.keys(o.queryParams).length>0?`${o.url}?${JSON.stringify(o.queryParams)}`:o.url;if(t.rows[r].work_resourse.work_resource_name=`<a class="enable" id="work_resourse.work_resource_name${t.rows[r]._id}" href=${d}>${t.rows[r].work_resourse.work_resource_name}`,t.rows[r].sales_profile)for(let p=0;p<t.rows[r].sales_profile.length;p++)t.rows[r].sales_profile.manager=t.rows[r].sales_profile[p].manager.work_resource_name,t.rows[r].sales_profile.status=t.rows[r].sales_profile[p].status?this.lookupLanguageTranslations(t.rows[r].sales_profile[p].status.lookup_id):"",t.rows[r].sales_profile.effective_start_date=this.commonService.dbTimezoneFormat(t.rows[r].sales_profile[p].effective_start_date),t.rows[r].sales_profile.effective_end_date=this.commonService.dbTimezoneFormat(t.rows[r].sales_profile[p].effective_end_date);this.crmSalesRepsMobileList=this.crmSalesRepsMobileList.filter(p=>p._id!==t.rows[r]._id),this.crmSalesRepsMobileList.push(t.rows[r])}t.totalCount&&(this.listingVariables.totalRecords=t.totalCount),1===this.listingVariables.pageNumbers&&(this.listingVariables.totalpages=t.pages),this.dataJsonObj.isLoadMoreClicked?(this.dataJsonObj.isLoadMoreClicked=!1,this.listdata=this.listdata.concat(t.rows)):this.listdata=t.rows}else this.listdata=[],this.crmSalesRepsMobileList=[]},t=>{this.hideSpinner(),this.loggerService.setLoggerError(this.constructor.name,"getCrmSalesRepsListing",t)})}catch(a){this.hideSpinner(),this.loggerService.setLoggerError(this.constructor.name,"getCrmSalesRepsListing",a)}}getSearchResult(a){try{this.listingVariables.pageNumbers=1,this.listingVariables.totalRecords=1,this.searchString=a,this.getCrmSalesRepsListing(),this.datatableComponent.reset(),this.searchValueChange.emit(a)}catch(s){this.loggerService.setLoggerError(this.constructor.name,"getSearchResult",s)}}loadPageData(a){this.listingVariables.pageNumbers=a.listingVariables.pageNumbers,a.clearMobileData&&(this.crmSalesRepsMobileList=this.dataJsonObj.noDuplicates),a.isPaginationChange&&(this.dataJsonObj.selectedFilter=a.selectedFilterType,this.dataJsonObj.isLoadMoreClicked=a.isLoadMoreClicked,this.dataJsonObj.advancedSearchObj.inputAdvSearchObj=a.selectedAdvancedSearchObj),this.getCrmSalesRepsListing()}showSpinner(){this.dataJsonObj.showSpinner=!0}hideSpinner(){this.dataJsonObj.showSpinner=!1}createCrmSalesReps(){try{this.router.navigate(["/crmsalesreps/crmsalesreps/create"])}catch(a){this.loggerService.setLoggerError(this.constructor.name,"createCrmSalesReps",a)}}searchClose(){try{this.searchString="",this.listingVariables.pageNumbers=1,this.listingVariables.totalRecords=1,this.getCrmSalesRepsListing(),this.datatableComponent.reset(),this.searchValueChange.emit("")}catch(a){this.loggerService.setLoggerError(this.constructor.name,"searchClose",a)}}toggle(){try{this.show=!this.show}catch(a){this.loggerService.setLoggerError(this.constructor.name,"toggle",a)}}statsData(a){try{this.isFilterClicked=!0,this.statusObj=a.value,this.forcerefresh=!0,this.listingVariables.pageNumbers=1,this.datatableComponent.reset(),this.crmSalesRepsMobileList=[],this.getCrmSalesRepsListing()}catch(s){this.loggerService.setLoggerError(this.constructor.name,"statsData",s)}}onActionClicked(a){try{a.action===n.A0.EDIT?(this.router.navigate(["/crmsalesreps/crmsalesreps/"+a.data._id+"/edit"]),this.router.routeReuseStrategy.clearModuleRouteCache("crmsalesreps")):a.action===n.A0.VIEW&&this.commonService.redirectToUrl(["..",a.data._id,"view"],!0,!0,this.dataJsonObj.queryParamsObj?this.dataJsonObj.queryParamsObj:"",this.route)}catch(s){this.loggerService.setLoggerError(this.constructor.name,"onActionClicked",s)}}mobileEventAction(a){try{this.mobileroutesArray=[],this.roleRightsValidationByPage(n.hf.CRM_SALESREPS,n.AM.ACTIONS,n.In.EDIT)&&this.mobileroutesArray.push({text:this.translateService.instant("COMMON_BUTTONS.BUTTON_EDIT"),handler:()=>{this.router.navigate(["crmsalesreps/crmsalesreps/"+a._id+"/edit"]),this.router.routeReuseStrategy.clearModuleRouteCache("crmsalesreps")}}),this.roleRightsValidationByPage(n.hf.CRM_SALESREPS,n.AM.ACTIONS,n.In.VIEW)&&this.mobileroutesArray.push({text:this.translateService.instant("COMMON_BUTTONS.BUTTON_VIEW"),handler:()=>{this.commonService.redirectToUrl(["..",a._id,"view"],!0,!0,this.dataJsonObj.queryParamsObj?this.dataJsonObj.queryParamsObj:"",this.route)}}),this.presentActionSheet(a)}catch(s){this.loggerService.setLoggerError(this.constructor.name,"presentActionSheet",s)}}presentActionSheet(a){var s=this;return(0,Z.Z)(function*(){try{yield(yield s.actionSheetController.create({cssClass:"actionsheet",buttons:s.mobileroutesArray})).present()}catch(t){s.loggerService.setLoggerError(s.constructor.name,"mobileEventAction",t)}})()}getchangeEvent(a){a&&"success"===a.value&&(this.forcerefresh=!0,this.getCrmSalesRepsListing())}getRedirectCrmSalesReps(a){try{this.roleRightsValidationByPage(n.hf.CRM_SALESREPS,n.AM.ACTIONS,n.In.VIEW)&&this.commonService.redirectToUrl(["..",a._id,"view"],!0,!0,this.dataJsonObj.queryParamsObj?this.dataJsonObj.queryParamsObj:"",this.route)}catch(s){this.loggerService.setLoggerError(this.constructor.name,"getRedirectCrmSalesReps",s)}}selectedViewType(a){this.dataJsonObj.selectedDisplayView=a}selectedFilterType(a){a?this.dataJsonObj.selectedFilter=a:(this.dataJsonObj.selectedFilter="",this.dataJsonObj.selectedAdvancedSearchObj={})}onPageLevelActionClicked(a){"IMPORT"===a.actionName&&(this.dataJsonObj.isImportActionClicked=!0)}advancedSearchFilterClicked(a){this.dataJsonObj.selectedAdvancedSearchObj=a}onHeaderItemClick(a){switch(a.type){case"search":this.getSearchResult(a.event);break;case"search_close":this.searchClose();break;case"display_views":this.selectedViewType(a.event);break;case"filters":this.selectedFilterType(a.event);break;case"advanced_search":this.advancedSearchFilterClicked(a.event);break;case"page_actions":this.onPageLevelActionClicked(a.event)}}static \u0275fac=function(s){return new(s||i)(e.Y36(b.sK),e.Y36(E.Y),e.Y36(_),e.Y36(Y.v),e.Y36(N.s),e.Y36(D.m),e.Y36(g.F0),e.Y36(g.gz),e.Y36(f.v),e.Y36(q.BX))};static \u0275cmp=e.Xpm({type:i,selectors:[["app-crm-salesreps-list"]],viewQuery:function(s,t){if(1&s&&e.Gf(Ce,5),2&s){let r;e.iGM(r=e.CRH())&&(t.datatableComponent=r.first)}},outputs:{searchValueChange:"searchValueChange"},features:[e._Bn([E.Y,Y.v,_]),e.qOj],decls:10,vars:32,consts:[[1,"container-fluid"],[1,"card","bd-0"],["id","stickyHeaderID",1,"card-header","card-header-primary"],[1,"subpage-header-title","w-100",3,"pageName","defaultView","isFabDisplay","pageActionsList","pageTitle","selectedMenuId","selectedSubMenuId","showPageHeaderItems","showDependencySubMenu","headerItemClick"],["id","extraPaddingBottomID",1,"card-body","pdt-0"],["id","tagid",3,"header","actions","totalPages","showSpinner","paginator","totalRecords","data","mobileListData","expand","statsShow","showRights","statsSearch","listingVariables","selectedDisplayViewType","selectedFilterType","selectedAdvancedSearchObj","pageName","selectedMenuId","selectedSubMenuId","actionClicked","itemClickEvent","redirectionEvent","changeStats","loadPageData"],["datatableComponent",""],[1,"mgt-5"],[3,"isFabDisplay","actionsList","selectedAction"],[3,"actionClicked","pageName","emitEvent"]],template:function(s,t){1&s&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"app-pageheader",3),e.NdJ("headerItemClick",function(o){return t.onHeaderItemClick(o)}),e.qZA()(),e.TgZ(4,"div",4)(5,"app-datatable",5,6),e.NdJ("actionClicked",function(o){return t.onActionClicked(o)})("itemClickEvent",function(o){return t.getRedirectCrmSalesReps(o)})("redirectionEvent",function(o){return t.mobileEventAction(o)})("changeStats",function(o){return t.statsData(o)})("loadPageData",function(o){return t.loadPageData(o)}),e.qZA(),e.TgZ(7,"div",7)(8,"app-page-actions",8),e.NdJ("selectedAction",function(o){return t.onPageLevelActionClicked(o)}),e.qZA()()()()(),e.TgZ(9,"app-importdata",9),e.NdJ("emitEvent",function(o){return t.getchangeEvent(o)}),e.qZA()),2&s&&(e.xp6(3),e.Q6J("pageName",t.dataJsonObj.pageName)("defaultView",null==t.dataJsonObj.queryParamsObj?null:t.dataJsonObj.queryParamsObj.defaultView)("isFabDisplay",!1)("pageActionsList",t.dataJsonObj.pageActionsList)("pageTitle",t.dataJsonObj.pageTitle)("selectedMenuId",null==t.dataJsonObj.queryParamsObj?null:t.dataJsonObj.queryParamsObj.selectedMenuId)("selectedSubMenuId",null==t.dataJsonObj.queryParamsObj?null:t.dataJsonObj.queryParamsObj.selectedSubMenuId)("showPageHeaderItems",!0)("showDependencySubMenu",!1),e.xp6(2),e.Q6J("header",t.tableColumnheaders)("actions",t.actions)("totalPages",t.listingVariables.totalpages)("showSpinner",t.dataJsonObj.showSpinner)("paginator",!0)("totalRecords",t.listingVariables.totalRecords)("data",t.listdata)("mobileListData",t.crmSalesRepsMobileList)("expand",!1)("statsShow",t.show)("showRights",t.roleRightsValidationByPage(t.dataJsonObj.htmlPageRolesEnumValuesJson.pageEnum.CRM_SALES_REPS,t.dataJsonObj.htmlPageRolesEnumValuesJson.pageSettingEnum.ACTIONS,t.dataJsonObj.htmlPageRolesEnumValuesJson.pageSettingFieldsEnum.STATS))("statsSearch",t.searchString)("listingVariables",t.listingVariables)("selectedDisplayViewType",t.dataJsonObj.selectedDisplayView)("selectedFilterType",t.dataJsonObj.selectedFilter)("selectedAdvancedSearchObj",t.dataJsonObj.selectedAdvancedSearchObj)("pageName",t.dataJsonObj.pageName)("selectedMenuId",null==t.dataJsonObj.queryParamsObj?null:t.dataJsonObj.queryParamsObj.selectedMenuId)("selectedSubMenuId",null==t.dataJsonObj.queryParamsObj?null:t.dataJsonObj.queryParamsObj.selectedSubMenuId),e.xp6(3),e.Q6J("isFabDisplay",!0)("actionsList",t.dataJsonObj.pageActionsList),e.xp6(1),e.Q6J("actionClicked",t.dataJsonObj.isImportActionClicked)("pageName",t.defaultPageName))},dependencies:[_e.M,Se.n,y.q,be.y]})}return i})(),canActivate:[T.P],data:{object_type:n.hf.CRM_SALESREPS,responsibilityParam:n.bP.MENUS+"."+n.w1.CRM_SALES_REPS+"."+n.bP.SUBMENUS+"."+n.w1.CRM_SALES_REPS+"."+n.Iu.ENABLED,pageName:n.hf.CRM_SALES_REPS}},{path:"crmsalesreps/create",component:te,canActivate:[T.P],data:{object_type:n.hf.CRM_SALESREPS,responsibilityParam:n.bP.MENUS+"."+n.w1.CRM_SALES_REPS+"."+n.bP.SUBMENUS+"."+n.w1.CRM_SALES_REPS+"."+n.In.CREATE,pageName:n.hf.CRM_SALES_REPS,pageSetting:n.AM.ACTIONS,settingField:n.In.CREATE}},{path:"crmsalesreps/:id/edit",component:ge,canActivate:[T.P],data:{object_type:n.hf.CRM_SALESREPS,responsibilityParam:n.bP.MENUS+"."+n.w1.CRM_SALES_REPS+"."+n.bP.SUBMENUS+"."+n.w1.CRM_SALES_REPS+"."+n.In.EDIT,pageName:n.hf.CRM_SALES_REPS,pageSetting:n.AM.ACTIONS,settingField:n.In.EDIT}},{path:"crmsalesreps/:id/view",component:(()=>{class i extends A.O{apiEndPointUrl;ColumnHeader;actionSheetController;crmSalesRepsService;loggerService;navigationService;router;translateService;uiUtils;commonservice;route;apiEndPoint;createdBy;createdDate;crmSalesrepViewData;dataJsonObj={};effectiveEndDateValue;effectivestartDateValue;email;header;lastUpdatedBy;lastUpdatedDate;managerName;mobileroutesArray=[];objectType;phoneNumber;recordId;salesrepName;salesreplastUpdatedAt;salesreplastUpdatedBy;salesrepsData=[];status;constructor(a,s,t,r,o,d,p,S,m,u,h){super(h,u),this.apiEndPointUrl=a,this.ColumnHeader=s,this.actionSheetController=t,this.crmSalesRepsService=r,this.loggerService=o,this.navigationService=d,this.router=p,this.translateService=S,this.uiUtils=m,this.commonservice=u,this.route=h,this.route.params.subscribe(C=>{this.recordId=C.id}),this.route.queryParams.subscribe(C=>{this.dataJsonObj.queryParamsObj={defaultView:C.defaultView,selectedMenuId:C.selectedMenuId,selectedSubMenuId:C.selectedSubMenuId}})}ngOnInit(){}ngAfterContentInit(){this.initializeComponent()}initializeComponent(){this.dataJsonObj.pageName=n.hf.CRM_SALESREPS,this.dataJsonObj.pageTitle=[{key:"CRM_ACCOUNTS.CRM_SALES_REP",value:"",showSubMenuDisplayName:!1},{key:"",value:"-",showSubMenuDisplayName:!1},{key:"COMMON_BUTTONS.BUTTON_VIEW",value:"",showSubMenuDisplayName:!1}],this.apiEndPoint=localStorage.getItem(n.BU.S3_URL)?localStorage.getItem(n.BU.S3_URL):this.apiEndPointUrl,this.objectType=this.route.snapshot.data.object_type,this.dataJsonObj.showrecordhistory=this.roleRightsValidationByPage(n.hf.CRM_SALESREPS,n.AM.ACTIONS,n.In.RECORD_HISTORY),document.getElementsByTagName("body"),this.getCRMSalesRepViewData(),this.header=[[{headersort:"disableth",field:"work_resource_name",header:this.translateService.instant("CRM_ACCOUNTS.CRM_SALES_REP_MANAGER"),class:""},{headersort:"disableth",field:"effective_startdate",header:this.translateService.instant("COMMON_FIELDS.START_DATE"),class:"w-140 list-value-right"},{headersort:"disableth",field:"effective_enddate",header:this.translateService.instant("COMMON_FIELDS.END_DATE"),class:"w-140 list-value-right"},{headersort:"disableth",field:"statusName",header:this.translateService.instant("COMMON_FIELDS.STATUS"),class:"w-200"}],[]],this.dataJsonObj.selectedPage=n.hf.CRM_SALESREPS,this.getDynamicJson([{folderName:"menu_manager",jsonType:"",storingFieldName:"menuDataJson"}])}getDynamicJson(a){var s=this;return(0,Z.Z)(function*(){for(let t of a)s.dataJsonObj[t.storingFieldName]=yield s.commonService.getDynamicJson(s.dataJsonObj.enterpriseId,t.folderName,t.jsonType);s.dataJsonObj.selectedObj={},s.dataJsonObj.selectedObj.recordId=s.recordId,s.dataJsonObj.selectedObj.pageObj=s.dataJsonObj.menuDataJson.filter(t=>t.menu_page.page_name===s.dataJsonObj.selectedPage),s.dataJsonObj.selectedObjEnabled=!0})()}getCRMSalesRepViewData(){try{let a="";this.commonService.isMobileWindow()&&(a="&mobileview=true"),this.crmSalesRepsService.getCRMSalesRepViewData(this.recordId,a).subscribe(s=>{this.crmSalesrepViewData=s,this.salesrepName=this.crmSalesrepViewData.work_resourse.work_resource_name,this.commonservice.setCurrentPageTitle(this.salesrepName,this.recordId),this.phoneNumber=s.work_resourse.mobile_number?s.work_resourse.mobile_number:"",this.email=s.work_resourse.email?s.work_resourse.email:"",this.createdBy=this.crmSalesrepViewData.created_by,this.lastUpdatedBy=this.crmSalesrepViewData.updated_by,this.salesrepsData=this.crmSalesrepViewData.sales_profile;for(let t=0;t<this.crmSalesrepViewData.sales_profile.length;t++)this.crmSalesrepViewData.sales_profile[t].statusName=this.crmSalesrepViewData.sales_profile[t].status?this.lookupLanguageTranslations(this.crmSalesrepViewData.sales_profile[t].status.lookup_id):"",this.crmSalesrepViewData.sales_profile[t].status=this.crmSalesrepViewData.sales_profile[t].status,this.crmSalesrepViewData.sales_profile[t].work_resource_name=this.crmSalesrepViewData.sales_profile[t].manager?this.crmSalesrepViewData.sales_profile[t].manager.work_resource_name:"",this.crmSalesrepViewData.sales_profile[t].effective_startdate=this.crmSalesrepViewData.sales_profile[t].effective_start_date?v(this.crmSalesrepViewData.sales_profile[t].effective_start_date).format("YYYY-MM-DD"):"",this.crmSalesrepViewData.sales_profile[t].effective_enddate=this.crmSalesrepViewData.sales_profile[t].effective_end_date?v(this.crmSalesrepViewData.sales_profile[t].effective_end_date).format("YYYY-MM-DD"):""},s=>{this.loggerService.setLoggerError(this.constructor.name,"getCRMSalesRepViewData",s)})}catch(a){this.loggerService.setLoggerError(this.constructor.name,"getCRMSalesRepViewData",a)}}cancelBtn(){try{this.commonService.redirectToPreviousUrl()}catch(a){this.loggerService.setLoggerError(this.constructor.name,"cancelBtn",a)}}viewResource(a,s){try{this.effectiveEndDateValue=s.effective_end_date?this.commonservice.dbTimezoneFormatWithHours(s.effective_end_date):"",this.effectivestartDateValue=this.commonservice.dbTimezoneFormat(s.effective_start_date),this.managerName=s.manager.work_resource_name,this.status=this.lookupLanguageTranslations(s.status.lookup_id),this.salesreplastUpdatedBy=this.crmSalesrepViewData.updated_by.l_name+", "+this.crmSalesrepViewData.updated_by.f_name,this.salesreplastUpdatedAt=this.commonservice.dbTimezoneFormat(s.last_updatedAt)}catch(t){this.loggerService.setLoggerError(this.constructor.name,"viewResource",t)}}mobileEventAction(a){try{this.mobileroutesArray=[],this.roleRightsValidationByPage(n.hf.CRM_SALESREPS,n.AM.ACTIONS,n.In.EDIT)&&this.mobileroutesArray.push({text:this.translateService.instant("COMMON_BUTTONS.BUTTON_EDIT"),handler:()=>{this.router.navigate(["crmsalesreps/crmsalesreps/"+a._id+"/edit"]),this.router.routeReuseStrategy.clearModuleRouteCache("crmsalesreps")}}),this.presentActionSheet(a)}catch(s){this.loggerService.setLoggerError(this.constructor.name,"presentActionSheet",s)}}presentActionSheet(a){var s=this;return(0,Z.Z)(function*(){try{s.mobileroutesArray.length>0?yield(yield s.actionSheetController.create({cssClass:"actionsheet",buttons:s.mobileroutesArray})).present():s.uiUtils.displayWarningMessage("COMMON_VALIDATION_MESSAGES.VALID_PERFORM_ACTIONS")}catch(t){s.loggerService.setLoggerError(s.constructor.name,"mobileEventAction",t)}})()}cancelPopBtn(){try{document.getElementsByTagName("body")[0].classList.remove("modale-popup-open")}catch(a){this.loggerService.setLoggerError(this.constructor.name,"cancelPopBtn",a)}}static \u0275fac=function(s){return new(s||i)(e.Y36("apiEndPoint"),e.Y36(E.Y),e.Y36(q.BX),e.Y36(_),e.Y36(D.m),e.Y36(w.f),e.Y36(g.F0),e.Y36(b.sK),e.Y36(N.s),e.Y36(f.v),e.Y36(g.gz))};static \u0275cmp=e.Xpm({type:i,selectors:[["app-crm-salesreps-view"]],features:[e._Bn([_,E.Y]),e.qOj],decls:73,vars:79,consts:[[1,"container-fluid"],[1,"forms-wrapper"],[1,"row","g-0"],[1,"col-md-12"],[1,"card"],["id","stickyHeaderID",1,"card-header","card-header-primary"],[1,"subpage-header-title","w-100",3,"pageName","pageTitle","selectedMenuId","selectedSubMenuId","showPageHeaderItems","showDependencySubMenu"],[1,"card-body"],[1,"row","form-bs"],[1,"col-md-4"],["disabled","true","id","crmsalesReps-edit-enterprise_name",3,"label","value"],["disabled","true","id","crmsalesReps-view-enterprisename",3,"label","value"],[1,"col-md-4","text-end","mt-2"],["className","btn btn-danger btn-sm",3,"label","id","buttonOnClick"],["id","extraPaddingBottomID",1,"card-content"],[3,"multiple"],[1,"list-accordion-tab",3,"selected"],[1,"d-flex","justify-content-between","w-100","accordion-header"],["selectionMode","single","dataKey","LineNum",1,"ptable","max-height",3,"columns","value","rows","lazy","responsive","autoLayout"],["pTemplate","emptymessage"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],[3,"createdBy","lastUpdatedBy","showrecordhistory","creationDate","lastUpdatedDate"],["id","exampleModal2","tabindex","-1","role","dialog","aria-labelledby","exampleModalLabel","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-lg","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header",2,"border-top-left-radius","2px","border-top-right-radius","2px"],["id","exampleModalLabel",1,"modal-title"],[1,"modal-body","ios-content"],[1,"col-md-3"],["mandatory","false","id","crmsalesRepscreate-resource-editpopup-ResourceName","disabled","true",3,"label","value"],["mandatory","false","id","crmsalesReps-create-resource-editpopup-ResourceName","disabled","true",3,"label","value"],["mandatory","false","id","crmsalesReps-view-resource-viewpopup-effectivestartDateValue","disabled","true",3,"label","value"],["mandatory","false","id","crmsalesReps-view-resource-viewpopup-effectiveEndDateValue","disabled","true",3,"label","value"],["disabled","true","mandatory","false","id","crmsalesReps-view-resource-lastUpdatedBy",3,"label","value"],["disabled","true","mandatory","false","id","crmsalesReps-view-resource-lastUpdatedDate",3,"label","value"],[1,"col-md-12","text-end","mt-2"],["className","btn btn-danger btn-sm","data-bs-dismiss","modal","aria-label","Close","id","crmsalesReps-view-close button viewpopup",3,"label","buttonOnClick"],["class","no-results-found",4,"ngIf"],[1,"no-results-found"],[1,"text-center","text-danger"],[4,"ngFor","ngForOf"],["data-toggle","modal","data-bs-target","#exampleModal2",3,"pSelectableRow","class","click",4,"ngFor","ngForOf"],["data-toggle","modal","data-bs-target","#exampleModal2",3,"pSelectableRow","click"],["class","col-md-12",4,"ngFor","ngForOf"],[3,"innerHTML"]],template:function(s,t){1&s&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5),e._UZ(6,"app-pageheader",6),e.qZA(),e.TgZ(7,"div",7)(8,"div",8)(9,"div",9),e._UZ(10,"app-input",10),e.ALo(11,"translate"),e.qZA(),e.TgZ(12,"div",9),e._UZ(13,"app-input",11),e.ALo(14,"translate"),e.qZA(),e.TgZ(15,"div",9),e._UZ(16,"app-input",11),e.ALo(17,"translate"),e.qZA(),e.TgZ(18,"div",9),e._UZ(19,"app-input",11),e.ALo(20,"translate"),e.qZA(),e.TgZ(21,"div",9),e._UZ(22,"app-input",11),e.ALo(23,"translate"),e.qZA(),e.TgZ(24,"div",12)(25,"app-button",13),e.NdJ("buttonOnClick",function(){return t.cancelBtn()}),e.ALo(26,"translate"),e.qZA()()()()()(),e.TgZ(27,"div",3)(28,"div",4)(29,"div",14)(30,"p-accordion",15)(31,"p-accordionTab",16)(32,"p-header",17)(33,"span"),e._uU(34),e.ALo(35,"translate"),e.qZA()(),e.TgZ(36,"p-table",18),e.YNc(37,Ee,1,1,"ng-template",19),e.YNc(38,Me,2,1,"ng-template",20),e.YNc(39,Te,2,1,"ng-template",21),e.YNc(40,De,4,2,"ng-template",22),e.qZA()(),e._UZ(41,"app-recordhistory",23),e.qZA()()()()()()(),e.TgZ(42,"div",24)(43,"div",25)(44,"div",26)(45,"div",27)(46,"div",28),e._uU(47),e.ALo(48,"translate"),e.ALo(49,"translate"),e.qZA()(),e.TgZ(50,"div",29)(51,"div",8)(52,"div",30),e._UZ(53,"app-input",31),e.ALo(54,"translate"),e.qZA(),e.TgZ(55,"div",30),e._UZ(56,"app-input",32),e.ALo(57,"translate"),e.qZA(),e.TgZ(58,"div",30),e._UZ(59,"app-input",33),e.ALo(60,"translate"),e.qZA(),e.TgZ(61,"div",30),e._UZ(62,"app-input",34),e.ALo(63,"translate"),e.qZA(),e.TgZ(64,"div",30),e._UZ(65,"app-input",35),e.ALo(66,"translate"),e.qZA(),e.TgZ(67,"div",30),e._UZ(68,"app-input",36),e.ALo(69,"translate"),e.qZA(),e.TgZ(70,"div",37)(71,"app-button",38),e.NdJ("buttonOnClick",function(){return t.cancelPopBtn()}),e.ALo(72,"translate"),e.qZA()()()()()()()),2&s&&(e.xp6(6),e.Q6J("pageName",t.dataJsonObj.pageName)("pageTitle",t.dataJsonObj.pageTitle)("selectedMenuId",null==t.dataJsonObj.queryParamsObj?null:t.dataJsonObj.queryParamsObj.selectedMenuId)("selectedSubMenuId",null==t.dataJsonObj.queryParamsObj?null:t.dataJsonObj.queryParamsObj.selectedSubMenuId)("showPageHeaderItems",!1)("showDependencySubMenu",!0),e.xp6(4),e.s9C("label",e.lcZ(11,47,"COMMON_PAGE_TITLES.ENTERPRISE")),e.s9C("value",null==t.crmSalesrepViewData||null==t.crmSalesrepViewData.enterprise?null:t.crmSalesrepViewData.enterprise.short_name),e.xp6(3),e.s9C("label",e.lcZ(14,49,"COMMON_FIELDS.BUSINESS_ENTITY")),e.Q6J("value",t.lookupLanguageTranslations(null==t.crmSalesrepViewData||null==t.crmSalesrepViewData.business_entity_name?null:t.crmSalesrepViewData.business_entity_name.lookup_id)),e.xp6(3),e.s9C("label",e.lcZ(17,51,"CRM_ACCOUNTS.CRM_SALES_REP")),e.s9C("value",t.salesrepName),e.xp6(3),e.s9C("label",e.lcZ(20,53,"COMMON_FIELDS.PHONE_NUMBER")),e.s9C("value",t.phoneNumber),e.xp6(3),e.s9C("label",e.lcZ(23,55,"COMMON_FIELDS.EMAIL")),e.s9C("value",t.email),e.xp6(3),e.s9C("label",e.lcZ(26,57,"COMMON_BUTTONS.BUTTON_CLOSE")),e.MGl("id","CRMSalesReps-",t.objectType,"-view-close"),e.xp6(5),e.Q6J("multiple",!0),e.xp6(1),e.Q6J("selected",!0),e.xp6(3),e.Oqu(e.lcZ(35,59,"CRM_ACCOUNTS.CRM_SALES_PROFILES")),e.xp6(2),e.Q6J("columns",t.header)("value",t.salesrepsData)("rows",10)("lazy",!0)("responsive",!0)("autoLayout",!0),e.xp6(5),e.Q6J("createdBy",t.createdBy)("lastUpdatedBy",t.lastUpdatedBy)("showrecordhistory",t.dataJsonObj.showrecordhistory)("creationDate",null==t.crmSalesrepViewData?null:t.crmSalesrepViewData.createdAt)("lastUpdatedDate",null==t.crmSalesrepViewData?null:t.crmSalesrepViewData.updatedAt),e.xp6(6),e.AsE("",e.lcZ(48,61,"CRM_ACCOUNTS.CRM_SALES_PROFILE")," - ",e.lcZ(49,63,"COMMON_BUTTONS.BUTTON_VIEW"),""),e.xp6(6),e.s9C("label",e.lcZ(54,65,"CRM_ACCOUNTS.CRM_SALES_REP_MANAGER")),e.s9C("value",t.managerName),e.xp6(3),e.s9C("label",e.lcZ(57,67,"COMMON_FIELDS.STATUS")),e.s9C("value",t.status),e.xp6(3),e.s9C("label",e.lcZ(60,69,"COMMON_FIELDS.START_DATE")),e.s9C("value",t.effectivestartDateValue),e.xp6(3),e.s9C("label",e.lcZ(63,71,"COMMON_FIELDS.END_DATE")),e.s9C("value",t.effectiveEndDateValue),e.xp6(3),e.s9C("label",e.lcZ(66,73,"COMMON_RECORD_HISTORY.LAST_UPDATED_BY")),e.s9C("value",t.salesreplastUpdatedBy),e.xp6(3),e.s9C("label",e.lcZ(69,75,"COMMON_RECORD_HISTORY.LAST_UPDATED_DATE")),e.s9C("value",t.salesreplastUpdatedAt),e.xp6(3),e.s9C("label",e.lcZ(72,77,"COMMON_BUTTONS.BUTTON_CLOSE")))},dependencies:[M.sg,M.O5,R.iA,L.h4,L.jx,R.Ei,O.UQ,O.US,I.r,j.a,F.W,y.q,b.X$]})}return i})(),canActivate:[T.P],data:{object_type:n.hf.CRM_SALESREPS,responsibilityParam:n.bP.MENUS+"."+n.w1.CRM_SALES_REPS+"."+n.bP.SUBMENUS+"."+n.w1.CRM_SALES_REPS+"."+n.In.VIEW,pageName:n.hf.CRM_SALES_REPS,pageSetting:n.AM.ACTIONS,settingField:n.In.VIEW}},{path:":parentId/crmaccounts",loadChildren:()=>l.e(1938).then(l.bind(l,61938)).then(i=>i.CRMAccountsModule)},{path:":parentId/crmopportunities",loadChildren:()=>Promise.all([l.e(8592),l.e(3337)]).then(l.bind(l,93337)).then(i=>i.CrmOpportunitiesModule)},{path:":parentId/crmquotes",loadChildren:()=>Promise.all([l.e(8592),l.e(3098)]).then(l.bind(l,93098)).then(i=>i.CrmQuotesModule)},{path:":parentId/activities",loadChildren:()=>Promise.resolve().then(l.bind(l,75896)).then(i=>i.ActivitiesModule)}]}];let Le=(()=>{class i{static \u0275fac=function(s){return new(s||i)};static \u0275mod=e.oAB({type:i});static \u0275inj=e.cJS({imports:[g.Bz.forChild(ye),g.Bz]})}return i})();var G=l(24006),we=l(65673);let Ie=(()=>{class i{static \u0275fac=function(s){return new(s||i)};static \u0275mod=e.oAB({type:i});static \u0275inj=e.cJS({imports:[Le,M.ez,b.aw,G.u5,G.UX,R.U$,O.fx,we.Q]})}return i})()}}]);