"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2829],{62829:(ue,v,d)=>{d.r(v),d.d(v,{SelectedAssetsModule:()=>_e});var f=d(36895),A=d(54463),C=d(71568),N=d(65063),u=d(62510),x=d(15861),E=d(75875),o=d(32236),e=d(94650),L=d(80529);let y=(()=>{class a{http;authService;commonService;constructor(t,s,i){this.http=t,this.authService=s,this.commonService=i}getAssetsList(){return new Promise((t,s)=>{this.authService.getApiCall("api/v1/fleets/assets").subscribe(i=>{t(i)},i=>{s(i)})})}getAssetsListLocal(t,s,i){const l=localStorage.getItem(o.BU.LOGIN_USER_LANGUAGE)?localStorage.getItem(o.BU.LOGIN_USER_LANGUAGE):"en";let n;const c=localStorage.getItem(o.BU.KIOSK_MAP_ORIENTATION),h=localStorage.getItem(o.BU.CHECK_IS_KIOSK);return n=i&&"true"===c&&"true"===h?"assets/enterprises/"+t+"/"+s+"_"+i+".json":"assets/enterprises/"+t+"/"+s+"/"+l+".json",new Promise((m,p)=>{this.authService.getStaticApiCall(n).subscribe(g=>{m(g)},g=>{p(g)})})}getStaticContentJson(t,s,i){const l=localStorage.getItem(o.BU.LOGIN_USER_LANGUAGE)?localStorage.getItem(o.BU.LOGIN_USER_LANGUAGE):"en";return this.commonService.getStaticApiCall("assets/enterprises/"+t+"/facilities/"+s+"/"+l+".json","assets/enterprises/"+t+"/facilities/",s+"/"+l+".json")}getAssetsListLocalByAnalytics(t,s,i){const l=localStorage.getItem(o.BU.LOGIN_USER_LANGUAGE)?localStorage.getItem(o.BU.LOGIN_USER_LANGUAGE):"en";let n;const c=localStorage.getItem(o.BU.KIOSK_MAP_ORIENTATION),h=localStorage.getItem(o.BU.CHECK_IS_KIOSK);return n=i&&"true"===c&&"true"===h?"assets/enterprises/"+t+"/"+s+"_"+i+".json":"assets/enterprises/"+t+"/"+s+"/"+l+".json",new Promise((m,p)=>{this.authService.getStaticApiCall(n).subscribe(g=>{m(g)},g=>{p(g)})})}getAssetTypes(t){return new Promise((s,i)=>{this.authService.getStaticApiCall("assets/enterprises/"+t+"/fleetTypes.json").subscribe(l=>{s(l)},l=>{i(l)})})}getEnterpriseConfigData(t){return this.commonService.getStaticApiCall("assets/enterprises/"+t+"/default_ui_settings/defaultUI.json")}static \u0275fac=function(s){return new(s||a)(e.LFG(L.eN),e.LFG(E.e),e.LFG(C.v))};static \u0275prov=e.Yz7({token:a,factory:a.\u0275fac})}return a})();var S=d(57530),b=d(42786),O=d(30958),U=d(70057),w=d(15965),P=d(46448),Z=d(37415);function J(a,r){1&a&&e._UZ(0,"ion-spinner",17)}function k(a,r){if(1&a&&(e.TgZ(0,"div",15),e.YNc(1,J,1,0,"ion-spinner",16),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.dataJsonObj.showSpinner)}}function D(a,r){if(1&a&&(e.TgZ(0,"ion-avatar",25),e._UZ(1,"i"),e.qZA()),2&a){const t=e.oxw(2).$implicit;e.xp6(1),e.Tol(null==t||null==t.properties?null:t.properties.iconName)}}function B(a,r){if(1&a&&(e.TgZ(0,"ion-avatar",25),e._UZ(1,"img",26),e.qZA()),2&a){const t=e.oxw(2).$implicit,s=e.oxw(2);e.xp6(1),e.cQ8("src","",s.apiEndPoint,"",null==t||null==t.properties?null:t.properties.facilityImageFilePath,"/",null==t||null==t.properties?null:t.properties.facilityImageFileName,"",e.LSH)}}function M(a,r){if(1&a&&(e.TgZ(0,"p",27),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&a){const t=e.oxw(2).$implicit;e.xp6(1),e.lnq(" ",null==t?null:t.facilityName," ",e.lcZ(2,3,"COMMON_FIELDS.AT"),"",null==t||null==t.address?null:t.address.city," ")}}function G(a,r){if(1&a&&(e.TgZ(0,"p",27),e._uU(1),e.qZA()),2&a){const t=e.oxw(2).$implicit;e.xp6(1),e.Oqu(null==t?null:t.facilityName)}}function F(a,r){if(1&a){const t=e.EpF();e.TgZ(0,"ion-item",21),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,l=e.oxw(2);return e.KtG(l.addToCart(i))}),e.YNc(1,D,2,3,"ion-avatar",22),e.YNc(2,B,2,3,"ion-avatar",22),e.YNc(3,M,3,5,"p",23),e.YNc(4,G,2,1,"p",23),e.TgZ(5,"ion-checkbox",24),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw().$implicit;return e.KtG(l.addedToCart=i)}),e.qZA()()}if(2&a){const t=e.oxw(),s=t.index,i=t.$implicit,l=e.oxw(2);e.Q6J("ngClass",s%2==0?"odd":"even"),e.xp6(1),e.Q6J("ngIf",""===(null==i||null==i.properties?null:i.properties.facilityImageFileName)||null===(null==i||null==i.properties?null:i.properties.facilityImageFileName)),e.xp6(1),e.Q6J("ngIf",""!==(null==i||null==i.properties?null:i.properties.facilityImageFileName)&&null!==(null==i||null==i.properties?null:i.properties.facilityImageFileName)),e.xp6(1),e.Q6J("ngIf",!0===l.removeattherate),e.xp6(1),e.Q6J("ngIf",!l.removeattherate),e.xp6(1),e.Q6J("disabled",!(null!=i&&i.addedToCart)&&l.count===l.countLimit)("checked",null==i?null:i.addedToCart)("ngModel",i.addedToCart)}}function R(a,r){if(1&a&&(e.TgZ(0,"ion-list",19),e.YNc(1,F,6,8,"ion-item",20),e.qZA()),2&a){const t=r.$implicit;e.xp6(1),e.Q6J("ngIf",null==t?null:t.facilityName)}}function Y(a,r){if(1&a&&(e.TgZ(0,"div"),e.YNc(1,R,2,1,"ion-list",18),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.fleetlistdata)}}function Q(a,r){if(1&a&&(e.TgZ(0,"span",49),e._uU(1),e.qZA()),2&a){const t=e.oxw(3).$implicit;e.xp6(1),e.Oqu(null==t?null:t.facilityName)}}function j(a,r){if(1&a&&(e.TgZ(0,"span",49),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&a){const t=e.oxw(3).$implicit;e.xp6(1),e.lnq("",null==t?null:t.facilityName," ",e.lcZ(2,3,"COMMON_FIELDS.AT"),"",null==t||null==t.address?null:t.address.city,"")}}const I=function(a,r){return{background:a,"border-bottom-color":r}},T=function(a,r){return{background:a,color:r}};function q(a,r){if(1&a&&(e.TgZ(0,"div")(1,"div",43)(2,"div",44)(3,"span",45),e._UZ(4,"i")(5,"div",46),e.qZA()(),e.TgZ(6,"div",47),e.YNc(7,Q,2,1,"span",48),e.YNc(8,j,3,5,"span",48),e.qZA()()()),2&a){const t=e.oxw(2).$implicit,s=e.oxw(2);e.xp6(2),e.Q6J("ngStyle",e.WLB(7,I,s.getGradientDynamicColor(t,"facilityId","gradient",""),s.getGradientDynamicColor(t,"facilityId","gradient","border"))),e.xp6(1),e.Q6J("ngStyle",e.WLB(10,T,s.getGradientDynamicColor(t,"facilityId","gradient","text"),s.getGradientDynamicColor(t,"facilityId","gradient","border"))),e.xp6(1),e.Tol(null==t||null==t.properties?null:t.properties.iconName),e.xp6(3),e.Q6J("ngIf",!s.removeattherate),e.xp6(1),e.Q6J("ngIf",!0===s.removeattherate)}}function $(a,r){if(1&a&&(e.TgZ(0,"div")(1,"div",43)(2,"div",44),e._UZ(3,"div",50),e.TgZ(4,"span",45),e._UZ(5,"img",51),e.qZA()(),e.TgZ(6,"div",47)(7,"span",49),e._uU(8),e.qZA()()()()),2&a){const t=e.oxw(2).$implicit,s=e.oxw(2);e.xp6(2),e.Q6J("ngStyle",e.WLB(6,I,s.getGradientDynamicColor(t,"facilityId","gradient",""),s.getGradientDynamicColor(t,"facilityId","gradient","border"))),e.xp6(2),e.Q6J("ngStyle",e.WLB(9,T,s.getGradientDynamicColor(t,"facilityId","gradient","text"),s.getGradientDynamicColor(t,"facilityId","gradient","border"))),e.xp6(1),e.cQ8("src","",s.apiEndPoint,"",null==t||null==t.properties?null:t.properties.facilityImageFilePath,"/",null==t||null==t.properties?null:t.properties.facilityImageFileName,"",e.LSH),e.xp6(3),e.Oqu(null==t?null:t.facilityName)}}function H(a,r){if(1&a&&(e.TgZ(0,"div")(1,"div",43)(2,"div",44)(3,"span",45),e._UZ(4,"img",51),e.qZA(),e._UZ(5,"div",46),e.qZA()()()),2&a){const t=e.oxw(2).$implicit,s=e.oxw(2);e.xp6(2),e.Q6J("ngStyle",e.WLB(5,I,s.getGradientDynamicColor(t,"facilityId","gradient",""),s.getGradientDynamicColor(t,"facilityId","gradient","border"))),e.xp6(1),e.Q6J("ngStyle",e.WLB(8,T,s.getGradientDynamicColor(t,"facilityId","gradient","text"),s.getGradientDynamicColor(t,"facilityId","gradient","border"))),e.xp6(1),e.cQ8("src","",s.apiEndPoint,"",null==t||null==t.properties?null:t.properties.facilityImageFilePath,"/",null==t||null==t.properties?null:t.properties.facilityImageFileName,"",e.LSH)}}function K(a,r){if(1&a&&(e.TgZ(0,"span",49),e._uU(1),e.qZA()),2&a){const t=e.oxw(3).$implicit;e.xp6(1),e.Oqu(null==t?null:t.facilityName)}}function W(a,r){if(1&a&&(e.TgZ(0,"span",49),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&a){const t=e.oxw(3).$implicit;e.xp6(1),e.lnq("",null==t?null:t.facilityName," ",e.lcZ(2,3,"COMMON_FIELDS.AT"),"",null==t||null==t.address?null:t.address.city,"")}}function V(a,r){if(1&a&&(e.TgZ(0,"div")(1,"div",43)(2,"div",44)(3,"span",45),e._UZ(4,"img",51),e.qZA(),e._UZ(5,"div",46),e.qZA(),e.TgZ(6,"div",47),e.YNc(7,K,2,1,"span",48),e.YNc(8,W,3,5,"span",48),e.qZA()()()),2&a){const t=e.oxw(2).$implicit,s=e.oxw(2);e.xp6(2),e.Q6J("ngStyle",e.WLB(7,I,s.getGradientDynamicColor(t,"facilityId","gradient",""),s.getGradientDynamicColor(t,"facilityId","gradient","border"))),e.xp6(1),e.Q6J("ngStyle",e.WLB(10,T,s.getGradientDynamicColor(t,"facilityId","gradient","text"),s.getGradientDynamicColor(t,"facilityId","gradient","border"))),e.xp6(1),e.cQ8("src","",s.apiEndPoint,"",null==t||null==t.properties?null:t.properties.facilityImageFilePath,"/",null==t||null==t.properties?null:t.properties.facilityImageFileName,"",e.LSH),e.xp6(3),e.Q6J("ngIf",!s.removeattherate),e.xp6(1),e.Q6J("ngIf",!0===s.removeattherate)}}function z(a,r){if(1&a){const t=e.EpF();e.TgZ(0,"ion-item",40),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,l=e.oxw(2);return e.KtG(l.addToCart(i))}),e.TgZ(1,"div",41),e.NdJ("tap",function(){e.CHM(t);const i=e.oxw().$implicit,l=e.oxw(2);return e.KtG(l.addOrRemoveAsset(i))}),e.YNc(2,q,9,13,"div",9),e.YNc(3,$,9,12,"div",9),e.YNc(4,H,6,11,"div",9),e.YNc(5,V,9,13,"div",9),e.qZA(),e.TgZ(6,"ion-checkbox",42),e.NdJ("ngModelChange",function(i){e.CHM(t);const l=e.oxw().$implicit;return e.KtG(l.addedToCart=i)}),e.qZA()()}if(2&a){const t=e.oxw(),s=t.$implicit,i=t.index,l=e.oxw(2);e.Q6J("ngClass",null!=s&&s.addedToCart&&!0===l.showCheckbox?"grid-selected":""),e.xp6(1),e.MGl("id","facilityNameid",i,""),e.xp6(1),e.Q6J("ngIf",""===(null==s||null==s.properties?null:s.properties.facilityImageFileName)||null===(null==s||null==s.properties?null:s.properties.facilityImageFileName)),e.xp6(1),e.Q6J("ngIf",""!==(null==s||null==s.properties?null:s.properties.facilityImageFileName)&&null!==(null==s||null==s.properties?null:s.properties.facilityImageFileName)&&!1===l.showFleetName&&!0===l.showGridName),e.xp6(1),e.Q6J("ngIf",""!==(null==s||null==s.properties?null:s.properties.facilityImageFileName)&&null!==(null==s||null==s.properties?null:s.properties.facilityImageFileName)&&!1===l.showFleetName&&!1===l.showGridName),e.xp6(1),e.Q6J("ngIf",""!==(null==s||null==s.properties?null:s.properties.facilityImageFileName)&&null!==s.properties.facilityImageFileName&&!0===l.showFleetName),e.xp6(1),e.MGl("id","checkbox",i,""),e.Q6J("disabled",!s.addedToCart&&l.count===l.countLimit)("ngClass",null!=s&&s.addedToCart?"multinav-checkbox":"unselect-checkbox")("checked",null==s?null:s.addedToCart)("ngModel",s.addedToCart)}}function X(a,r){if(1&a){const t=e.EpF();e.TgZ(0,"button",52),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,l=e.oxw(2);return e.KtG(l.addAssetToCart(i))}),e._UZ(1,"i",53),e._uU(2),e.ALo(3,"translate"),e.qZA()}2&a&&(e.xp6(2),e.hij(" ",e.lcZ(3,1,"COMMON_BUTTONS.BUTTON_ADD")," "))}function ee(a,r){if(1&a){const t=e.EpF();e.TgZ(0,"button",54),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,l=e.oxw(2);return e.KtG(l.deleteAssetToCart(i))}),e._UZ(1,"i",55),e._uU(2),e.ALo(3,"translate"),e.qZA()}2&a&&(e.xp6(2),e.hij(" ",e.lcZ(3,1,"COMMON_BUTTONS.BUTTON_DELETE")," "))}function te(a,r){if(1&a){const t=e.EpF();e.TgZ(0,"div",32),e.YNc(1,z,7,11,"ion-item",33),e.TgZ(2,"ion-item-options")(3,"button",34),e.NdJ("click",function(){const l=e.CHM(t).$implicit,n=e.oxw(2);return e.KtG(n.viewAsset(l,"view"))}),e._UZ(4,"i",35),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"button",36),e.NdJ("click",function(){const l=e.CHM(t).$implicit,n=e.oxw(2);return e.KtG(n.locateReserve(l))}),e._UZ(8,"i",37),e._uU(9),e.ALo(10,"translate"),e.qZA(),e.YNc(11,X,4,3,"button",38),e.YNc(12,ee,4,3,"button",39),e.qZA()()}if(2&a){const t=r.$implicit;e.Q6J("ngClass",null!=t&&t.facilityName?"":"specialfleets"),e.xp6(1),e.Q6J("ngIf",null==t?null:t.facilityName),e.xp6(4),e.hij(" ",e.lcZ(6,7,"COMMON_BUTTONS.BUTTON_VIEW")," "),e.xp6(2),e.Q6J("hidden",null==t?null:t.locate),e.xp6(2),e.hij(" ",e.lcZ(10,9,"NOTIFICATIONS.LOCATE")," "),e.xp6(2),e.Q6J("ngIf",!1===(null==t?null:t.addedToCart)||void 0===(null==t?null:t.addedToCart)),e.xp6(1),e.Q6J("ngIf",!0===(null==t?null:t.addedToCart))}}function se(a,r){if(1&a&&(e.TgZ(0,"div",28)(1,"ion-grid",29)(2,"div",30),e.YNc(3,te,13,11,"div",31),e.qZA()()()),2&a){const t=e.oxw();e.xp6(3),e.Q6J("ngForOf",t.fleetlistdata)}}function ie(a,r){if(1&a){const t=e.EpF();e.TgZ(0,"ion-infinite-scroll",56),e.NdJ("ionInfinite",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.doInfinite(i))}),e._UZ(1,"ion-infinite-scroll-content",57),e.ALo(2,"translate"),e.qZA()}2&a&&(e.xp6(1),e.s9C("loadingText",e.lcZ(2,1,"COMMON_VALIDATION_MESSAGES.VALID_LOADING_PLEASE_WAIT")))}function ae(a,r){1&a&&(e.TgZ(0,"ion-row",58)(1,"ion-col",59)(2,"ion-label",60),e._uU(3),e.ALo(4,"translate"),e.qZA()()()),2&a&&(e.xp6(3),e.Oqu(e.lcZ(4,1,"COMMON_VALIDATION_MESSAGES.VALID_NO_RESULTS_FOUND")))}function le(a,r){1&a&&e._UZ(0,"ion-spinner",61)}function ne(a,r){if(1&a){const t=e.EpF();e.TgZ(0,"div")(1,"img",66),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,l=e.oxw(3);return e.KtG(l.showAdvertisementLink(i.advertisementType,i.redirectUrl))}),e.qZA()()}if(2&a){const t=e.oxw().$implicit;e.xp6(1),e.s9C("src",t.imagesrc,e.LSH)}}function oe(a,r){if(1&a){const t=e.EpF();e.TgZ(0,"div")(1,"video",67),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,l=e.oxw(3);return e.KtG(l.showAdvertisementLink(i.advertisementType,i.redirectUrl))}),e._UZ(2,"source",68),e.qZA()()}if(2&a){const t=e.oxw().$implicit;e.xp6(2),e.s9C("src",t.imagesrc,e.LSH)}}function re(a,r){if(1&a&&(e.TgZ(0,"div")(1,"audio",69),e._UZ(2,"source",70),e.qZA()()),2&a){const t=e.oxw().$implicit;e.xp6(2),e.s9C("src",t.imagesrc,e.LSH)}}function ce(a,r){if(1&a&&(e.TgZ(0,"ion-slide"),e.YNc(1,ne,2,1,"div",9),e.YNc(2,oe,3,1,"div",9),e.YNc(3,re,3,1,"div",9),e.qZA()),2&a){const t=r.$implicit;e.xp6(1),e.Q6J("ngIf","image"===t.adTypes),e.xp6(1),e.Q6J("ngIf","video"===t.adTypes),e.xp6(1),e.Q6J("ngIf","audio"===t.adTypes)}}function de(a,r){if(1&a&&(e.TgZ(0,"ion-slides",64),e.YNc(1,ce,4,3,"ion-slide",65),e.qZA()),2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.advImagesList)}}function ge(a,r){if(1&a&&(e.TgZ(0,"ion-footer",62),e.YNc(1,de,2,1,"ion-slides",63),e.qZA()),2&a){const t=e.oxw();e.Udp("background",t.appcolor),e.xp6(1),e.Q6J("ngIf",t.advImagesList&&t.advImagesList.length)}}const he=[{path:"selectedassets/list",component:(()=>{class a{translateService;commonServices;platform;assetsService;toastCtrl;loggerService;events;router;route;navigationService;apiEndPointUrl;nodata;spinner;messagelist;token;showToolbar=!1;endpoint;removeattherate;userToken=localStorage.getItem(o.BU.TOKEN);tostermsg;UserTimeZone;displayName;headerTitle;fleetType;dataObj;filter=!0;assetName;error;array;advImagesList;searchfleets=!1;fleetlistdata;hideloadassertmsg=!0;selectedAssetsArray=[];count=0;selcetedassetspage=!1;prefleetTypevalue="";buildingfloorlevels;assetsList;assetjson;position;assetroleRights;confgItem;includeSpecial=!1;enterpriseId;buildingCode;locationpath;fleetCategory=!1;rotationAngle;floorsenable;langcode;map;shortcutFilter;listType;firstRepeat=1;subscription;recordsCount=20;showCheckbox=!1;apiEndPoint;showFleetName=!0;showGridName=!1;countLimit;tripmessage;appcolor;advData=!1;dataJsonObj={};errorObj={};searchTerm;constructor(t,s,i,l,n,c,h,m,p,g,fe){this.translateService=t,this.commonServices=s,this.platform=i,this.assetsService=l,this.toastCtrl=n,this.loggerService=c,this.events=h,this.router=m,this.route=p,this.navigationService=g,this.apiEndPointUrl=fe,this.route.queryParams.subscribe(_=>{this.dataJsonObj.queryParamsObj={defaultView:_.default_view,selectedMenuId:_.selectedMenuId,selectedSubMenuId:_.selectedSubMenuId,selectedSubmenuDisplayName:_.selectedSubmenuDisplayName,predefinedPathId:_.predefinedPathId,action:_.action}}),localStorage.getItem(o.BU.SELECTED_ENTERPRISE)?(this.enterpriseId=localStorage.getItem(o.BU.SELECTED_ENTERPRISE),this.buildingCode=localStorage.getItem(o.BU.BUILDING_CODE)):(this.enterpriseId=localStorage.getItem(o.BU.PARENT_ENTERPRISE_ID),this.buildingCode=localStorage.getItem(o.BU.PARENT_BUILDING_CODE))}ngOnInit(){this.initializeComponent()}ionViewWillEnter(){}ionViewDidLoad(){this.searchfleets=!1}ionViewWillLeave(){}initializeComponent(){this.dataJsonObj.queryParamsObj?.action===o.A0.CREATE&&(localStorage.removeItem(o.BU.SELECTED_ASSETS),this.events.publish(o.xY.TRIP_FACILITIES_COUNT,0)),this.dataJsonObj.displaySequenceNumber=0,this.dataJsonObj.dynamicColorJSON={},this.dataJsonObj.pageName=o.hf.FACILITIES,this.dataJsonObj.pageTitle=[{key:"COMMON_FIELDS.SELECT",value:"",showSubMenuDisplayName:!1},{key:"COMMON_PAGE_TITLES.FACILITIES",value:"",showSubMenuDisplayName:!1}],this.apiEndPoint=localStorage.getItem(o.BU.S3_URL)?localStorage.getItem(o.BU.S3_URL):this.apiEndPointUrl,this.showFleetName=!0,this.showGridName=!1,this.nodata=!1,this.spinner=!1,this.langcode=localStorage.getItem(o.BU.LOGIN_USER_LANGUAGE),this.token=localStorage.getItem(o.BU.TOKEN);const t=localStorage.getItem(o.BU.SELECTED_ASSETS);this.selectedAssetsArray=t&&"[]"!=t?JSON.parse(localStorage.getItem(o.BU.SELECTED_ASSETS)):[],this.selectedAssetsArray?this.count=this.selectedAssetsArray.length:this.selectedAssetsArray=[],this.getEnterpriseData(this.enterpriseId),setTimeout(()=>{this.dataJsonObj.queryParamsObj.predefinedPathId?this.getmessagelistWithId():this.getmessagelist()},500),this.countLimit=parseInt(localStorage.getItem(o.BU.SELECT_LIMIT),10)}showSpinner(){this.dataJsonObj.showSpinner=!0}hideSpinner(){this.dataJsonObj.showSpinner=!1}getGradientDynamicColor(t,s,i,l){this.dataJsonObj.dynamicColorJSON[i]||(this.dataJsonObj.dynamicColorJSON[i]={});const n=this.commonServices.getDynamicColor(t,s,this.dataJsonObj.dynamicColorJSON[i]),c=this.commonServices.lightenRGBColor(n,150),h=this.commonServices.darkenRGBColor(n,5),m=this.commonServices.lightenRGBColor(n,180),p=this.commonServices.darkenRGBColor(n,50);return"text"===i?c:"text"===l?m:"border"===l?p:"avatar"===l?`linear-gradient(135deg, ${c}, ${h})`:`linear-gradient(to bottom, ${h}, ${c})`}getEnterpriseData(t){try{this.assetsService.getEnterpriseConfigData(t).then(s=>{this.appcolor=s.application_color,s.generalSettings?(this.showFleetName=s.general_settings.show_facility_name,this.showGridName=s.general_settings.show_grid_name,this.listType=S.L.isEmpty(s.general_settings.facility_list_type)?"GRID_VIEW":s.general_settings.facility_list_type.lookup_name):this.listType="GRID_VIEW",this.removeattherate=!1,this.floorsenable=s.map_settings?s.map_settings.is_floor_details_enabled:"",!0===this.floorsenable?localStorage.setItem(o.BU.FLOORS_ENABLE,"enablefloor"):localStorage.removeItem(o.BU.FLOORS_ENABLE),this.recordsCount=80,this.platform.ready().then(i=>{const l=this.platform.width(),n=this.platform.height();(this.listType="GRID_VIEW")?l<1201?this.recordsCount=Math.floor(l/103)*Math.floor(n/96):l<1441&&(this.recordsCount=Math.floor(l/111)*Math.floor(n/96)):this.recordsCount=Math.floor(n/44)}),s.map_settings&&(localStorage.setItem(o.BU.LOCATION_PATH,s.map_settings.current_location_sensors.lookup_name),localStorage.setItem(o.BU.CLUSTER_LEVEL_ZOOM,s.map_settings.cluster_level_zoom),localStorage.setItem(o.BU.RADIUS_METERS,s.map_settings.radius_meters),localStorage.setItem(o.BU.SHOW_FLEETS,s.map_settings.show_facilities))})}catch(s){this.loggerService.setLoggerError(this.constructor.name,"getEnterpriseHome",s)}}getmessagelistWithId(){this.showSpinner(),this.searchfleets=!1,this.messagelist=[];let t=[];t=JSON.parse(localStorage.getItem(o.BU.SELECTED_ASSETS))&&JSON.parse(localStorage.getItem(o.BU.SELECTED_ASSETS))?.length?JSON.parse(localStorage.getItem(o.BU.SELECTED_ASSETS)):[];for(let s of t)s._id=s.facilityId;this.assetsService.getStaticContentJson(this.enterpriseId,this.buildingCode,this.rotationAngle).then(s=>{if(this.hideSpinner(),this.buildingfloorlevels=s.floorsData,this.assetsList=s,this.assetsList.floorsData[0]&&this.assetsList.floorsData[0].features.length>0){for(let l=0;l<this.assetsList.floorsData.length;l++)for(let n=0;n<this.assetsList.floorsData[l].features.length;n++)this.assetsList.floorsData[l].features[n].properties.iconName&&this.messagelist.push(this.assetsList.floorsData[l].features[n]);for(let l=0;l<this.messagelist.length;l++){this.messagelist[l].facilityName=this.messagelist[l].properties.facilityName;for(let n=0;n<t.length;n++)t[n].facilityId==this.messagelist[l].facilityId&&(this.messagelist[l].addedToCart=!0)}if(this.messagelist.sort((l,n)=>l.properties.facilityName.toLowerCase()>n.properties.facilityName.toLowerCase()?1:n.properties.facilityName.toLowerCase()>l.properties.facilityName.toLowerCase()?-1:0),this.messagelist.length>0){const l=[];let n=this.messagelist.length;this.messagelist.length>this.recordsCount?(n=this.recordsCount,this.hideloadassertmsg=!0):this.hideloadassertmsg=!1;for(let c=0;c<n;c++)l.push(this.messagelist[c]);this.fleetlistdata=l;for(let c=0;c<this.fleetlistdata.length;c++)this.fleetlistdata[c].facilityName=void 0!==this.fleetlistdata[c].name&&S.L.isEmpty(this.fleetlistdata[c].name[this.langcode])?this.fleetlistdata[c].name[this.langcode]:this.fleetlistdata[c].facilityName}else this.fleetlistdata=[],this.hideloadassertmsg=!1;this.nodata=!1,this.spinner=!1}else this.nodata=!0,this.spinner=!1,this.assetFromAPI()},s=>{this.nodata=!1,this.assetFromAPI(),this.commonErrorCodes(s,"")})}getmessagelist(){this.showSpinner(),this.searchfleets=!1,this.messagelist=[],this.assetsService.getStaticContentJson(this.enterpriseId,this.buildingCode,this.rotationAngle).then(t=>{if(this.hideSpinner(),this.buildingfloorlevels=t.floorsData,this.assetsList=t,this.assetsList.floorsData[0]&&this.assetsList.floorsData[0].features.length>0){for(let i=0;i<this.assetsList.floorsData.length;i++)for(let l=0;l<this.assetsList.floorsData[i].features.length;l++)this.assetsList.floorsData[i].features[l].properties.iconName&&this.messagelist.push(this.assetsList.floorsData[i].features[l]);for(let i=0;i<this.messagelist.length;i++){this.messagelist[i].facilityName=this.messagelist[i].properties.facilityName;for(let l=0;l<this.selectedAssetsArray.length;l++)this.selectedAssetsArray[l]._id==this.messagelist[i].facilityId&&(this.messagelist[i].addedToCart=!0)}if(this.messagelist.sort((i,l)=>i.properties.facilityName.toLowerCase()>l.properties.facilityName.toLowerCase()?1:l.properties.facilityName.toLowerCase()>i.properties.facilityName.toLowerCase()?-1:0),this.messagelist.length>0){const i=[];let l=this.messagelist.length;this.messagelist.length>this.recordsCount?(l=this.recordsCount,this.hideloadassertmsg=!0):this.hideloadassertmsg=!1;for(let n=0;n<l;n++)i.push(this.messagelist[n]);this.fleetlistdata=i?i.filter(n=>n.properties.status===o.t3.ACTIVE):[];for(let n=0;n<this.fleetlistdata.length;n++)this.fleetlistdata[n].facilityName=void 0!==this.fleetlistdata[n].name&&S.L.isEmpty(this.fleetlistdata[n].name[this.langcode])?this.fleetlistdata[n].name[this.langcode]:this.fleetlistdata[n].facilityName}else this.fleetlistdata=[],this.hideloadassertmsg=!1;this.nodata=!1,this.spinner=!1}else this.nodata=!0,this.spinner=!1,this.assetFromAPI()},t=>{this.nodata=!1,this.assetFromAPI(),this.commonErrorCodes(t,"")})}searchresultlist(t){try{if(this.searchTerm=t,this.fleetlistdata=[],this.messagelist&&this.messagelist.length>0&&!S.L.isEmpty(this.searchTerm)){this.messagelist=this.messagelist.filter(i=>i.properties&&i.properties.facilityName.toLowerCase().includes(this.searchTerm.toLowerCase()));let s=this.messagelist.length;this.listType===o.ox.LIST_VIEW&&this.messagelist.length>this.recordsCount?(s=this.recordsCount,this.hideloadassertmsg=!0):this.hideloadassertmsg=!1,this.fleetlistdata=this.messagelist,this.fleetlistdata.length<1||void 0===this.fleetlistdata?(this.nodata=!0,this.spinner=!1,this.fleetlistdata=[],this.hideloadassertmsg=!1):(this.nodata=!1,this.spinner=!1,this.hideloadassertmsg=!0)}else this.getmessagelist()}catch(s){this.loggerService.setLoggerError(this.constructor.name,"searchresultlist",s)}}assetFromAPI(){this.showSpinner(),this.assetsService.getAssetsList().then(t=>{this.hideSpinner();const s=[];this.messagelist=t;for(let i=0;i<this.messagelist.length;i++)this.messagelist[i].properties.level&&s.push(this.messagelist[i].properties.level);if(this.buildingfloorlevels=this.removeDuplicates(s),this.messagelist.length>0){this.nodata=!1,this.spinner=!1;const i=[];let l=this.messagelist.length;this.messagelist.length>this.recordsCount?(l=this.recordsCount,this.hideloadassertmsg=!0):this.hideloadassertmsg=!1;for(let n=0;n<l;n++){i.push(this.messagelist[n]);for(let c=0;c<this.selectedAssetsArray.length;c++)this.selectedAssetsArray[c]._id===this.messagelist[n]._id&&(i[n].addedToCart=!0)}this.fleetlistdata=i}else this.nodata=!0,this.fleetlistdata=[],this.spinner=!1,this.hideloadassertmsg=!1},t=>{this.fleetlistdata=[],this.hideloadassertmsg=!1,this.commonErrorCodes(t,"assets")})}addOrRemoveAsset(t){}addToCart(t){t.addedToCart?(t.addedToCart&&"LIST_VIEW"===this.listType||t.addedToCart&&"GRID_VIEW"===this.listType)&&this.deleteAssetToCart(t):this.addAssetToCart(t),this.showCheckbox=!0}addAssetToCart(t){if(t.facilityId&&"number"==typeof t.facilityId&&(t._id=t.facilityId),t.headerTitle=this.headerTitle,0===this.selectedAssetsArray.length)t.addedToCart=!0,t.displaySequence=1,this.selectedAssetsArray.push(t),localStorage.setItem(o.BU.SELECTED_ASSETS,JSON.stringify(this.selectedAssetsArray)),this.count++,this.showToastMessage(this.translateService.instant("TRIP_PLANNER.ADDED_TO_TRIP_PLANNER"));else if(t.properties.level===this.selectedAssetsArray[0].properties.level){const s=localStorage.getItem(o.BU.SELECT_LIMIT)?parseInt(localStorage.getItem(o.BU.SELECT_LIMIT),10):30;if(this.count<s){t.addedToCart=!0;const i=Math.max(...this.selectedAssetsArray.map(l=>l.displaySequence));t.displaySequence=i+1,this.selectedAssetsArray.push(t),localStorage.setItem(o.BU.SELECTED_ASSETS,JSON.stringify(this.selectedAssetsArray)),this.count++,this.showToastMessage(this.translateService.instant("TRIP_PLANNER.ADDED_TO_TRIP_PLANNER"))}else t.addedToCart=!1,this.showToastMessage(this.translateService.instant("TRIP_PLANNER.YOU_CAN_SELECT_ONLY")+" "+localStorage.getItem(o.BU.SELECT_LIMIT))}else{const s=localStorage.getItem(o.BU.SELECT_LIMIT)?parseInt(localStorage.getItem(o.BU.SELECT_LIMIT),10):30;if(this.count<s){t.addedToCart=!0;const i=Math.max(...this.selectedAssetsArray.map(l=>l.displaySequence));t.displaySequence=i+1,this.selectedAssetsArray.push(t),localStorage.setItem(o.BU.SELECTED_ASSETS,JSON.stringify(this.selectedAssetsArray)),this.count++,this.showToastMessage(this.translateService.instant("TRIP_PLANNER.ADDED_TO_TRIP_PLANNER"))}else t.addedToCart=!1,this.showToastMessage(this.translateService.instant("TRIP_PLANNER.YOU_CAN_SELECT_ONLY")+" "+localStorage.getItem(o.BU.SELECT_LIMIT))}this.events.publish(o.xY.TRIP_FACILITIES_COUNT,this.count),localStorage.setItem(o.BU.TRIP_PLANNER_LOCATE_FACILITY,JSON.stringify(this.selectedAssetsArray[0]))}deleteAssetToCart(t){for(let i of this.selectedAssetsArray)i._id=i.facilityId;let s=t._id;t.facilityId&&(s=t.facilityId);for(let i=0;i<this.selectedAssetsArray.length;i++)if(s===this.selectedAssetsArray[i]._id){this.selectedAssetsArray.splice(i,1),this.count--,delete t.addedToCart,localStorage.setItem(o.BU.SELECTED_ASSETS,JSON.stringify(this.selectedAssetsArray));break}this.selcetedassetspage&&(this.fleetlistdata=this.selectedAssetsArray.slice()),this.events.publish(o.xY.TRIP_FACILITIES_COUNT,this.count),localStorage.setItem(o.BU.TRIP_PLANNER_LOCATE_FACILITY,JSON.stringify(this.selectedAssetsArray[0]))}doInfinite(t){const s=this.fleetlistdata.length;this.messagelist.length>=s?(this.hideloadassertmsg=!0,setTimeout(()=>{for(let i=s;i<s+this.recordsCount;i++){if(!(i<this.messagelist.length)){this.hideloadassertmsg=!1;break}if(this.messagelist[i].facilityName=void 0!==this.messagelist[i].name?null==this.messagelist[i].name[this.langcode]||""===this.messagelist[i].name[this.langcode]?this.messagelist[i].facilityName:this.messagelist[i].name[this.langcode]:this.messagelist[i].facilityName,this.fleetlistdata.push(this.messagelist[i]),this.fleetlistdata.length===this.messagelist.length)break}t.target.complete()},500)):this.hideloadassertmsg=!1}showToastMessage(t){var s=this;return(0,x.Z)(function*(){(yield s.toastCtrl.create({message:t,duration:2e3,position:"bottom",cssClass:"customToast"})).present()})()}handleFilter(){this.filter=!this.filter}goBack(){try{this.commonServices.redirectToPreviousUrl()}catch(t){this.loggerService.setLoggerError(this.constructor.name,"Back to Trip planner",t)}}commonErrorCodes(t,s){switch(t){case 500:case 400:break;case 404:case 0:this.assetFromAPI()}}removeDuplicates(t){const s=[];for(let i=0;i<t.length;i++)-1===s.indexOf(t[i])&&s.push(t[i]);return s}localSearch(){this.map=this.translateService.instant("LOCAL_SEARCH"),this.langcode=localStorage.getItem(o.BU.LOGIN_USER_LANGUAGE)}handleKeyPress(t){try{13===t.keyCode&&this.searchresultlist(t.target.value)}catch(s){this.loggerService.setLoggerError(this.constructor.name,"handleKeyPress",s)}}clearSearch(){this.searchresultlist("")}setIntervalForAnalatics(){this.assetsService.getAssetsListLocalByAnalytics(this.enterpriseId,this.buildingCode,this.rotationAngle).then(t=>{})}clearmessage(){this.error=""}viewAsset(t,s){this.router.navigate([`facilitiesui/facilitiesui/${t.properties.facilityTypeDisplayName.replace(/\s+/g,"~")}/${t.facilityId}/view`])}locateReserve(t){localStorage.setItem(o.BU.SELECTED_FLEET,JSON.stringify(t)),this.router.navigate(["/maps/maps/list"])}showAdvertisementLink(t,s){}redirectToTripPlanner(){this.commonServices.redirectToUrl(["tripplanner","tripplanner","list"],!0,!1,this.dataJsonObj.queryParamsObj,this.route)}onHeaderItemClick(t){"continue"===t.type&&this.redirectToTripPlanner()}static \u0275fac=function(s){return new(s||a)(e.Y36(A.sK),e.Y36(C.v),e.Y36(O.t4),e.Y36(y),e.Y36(U.yF),e.Y36(b.m),e.Y36(w.z),e.Y36(u.F0),e.Y36(u.gz),e.Y36(P.f),e.Y36("apiEndPoint"))};static \u0275cmp=e.Xpm({type:a,selectors:[["app-selectedassets"]],features:[e._Bn([y])],decls:17,vars:15,consts:[[1,"container-fluid","post-page"],[1,"card","bd-0"],["id","stickyHeaderID",1,"card-header","card-header-primary"],[1,"subpage-header-title","w-100",3,"pageName","pageTitle","showPageHeaderItems","showDependencySubMenu","continueButtonEnable","headerItemClick"],["id","search-block",1,"search-block"],["size","12",1,"ion-no-padding"],["debounce","500","id","searchresid",1,"selectformfield","facilities-searchbar",3,"placeholder","ionChange","keypress"],["class","text-center loading",4,"ngIf"],[1,"card-body","pdt-0"],[4,"ngIf"],["class","mytrip-planner",4,"ngIf"],["id","doinfiniteid",3,"ionInfinite",4,"ngIf"],["class","error-message",4,"ngIf"],["name","circles","class","spinner",4,"ngIf"],["class","ft-slider",3,"background",4,"ngIf"],[1,"text-center","loading"],["name","lines",4,"ngIf"],["name","lines"],["class","assets-grid-list ion-no-padding",4,"ngFor","ngForOf"],[1,"assets-grid-list","ion-no-padding"],["lines","none","class","ion-no-padding assets-list-items",3,"ngClass","click",4,"ngIf"],["lines","none",1,"ion-no-padding","assets-list-items",3,"ngClass","click"],["class","asset-avatar-img bd-1",4,"ngIf"],["class","ion-no-margin asset-list-title",4,"ngIf"],["slot","end","id","inline-checkbox","name","inline-checkbox","type","checkbox",1,"checkbox-inline",3,"disabled","checked","ngModel","ngModelChange"],[1,"asset-avatar-img","bd-1"],["onerror","this.onerror=null;this.src='assets/img/image_placeholder.jpg';",3,"src"],[1,"ion-no-margin","asset-list-title"],[1,"mytrip-planner"],[1,"gridview-list-wrapper","pdt-0","mgb-100"],[1,"grid-display-element","gridview-list"],["class","ion-text-center grid-item-display-element",3,"ngClass",4,"ngFor","ngForOf"],[1,"ion-text-center","grid-item-display-element",3,"ngClass"],["lines","none","class","asset-img-circle ion-no-padding ion-no-margin",3,"ngClass","click",4,"ngIf"],["ion-button","","color","view","icon-start","","id","viewbuttonid",3,"click"],["aria-hidden","true",1,"fas","fa-15x","fa-eye"],["ion-button","","color","locate","icon-start","","id","locatebuttonid",3,"hidden","click"],["aria-hidden","true",1,"fas","fa-15x","fa-location-arrow"],["ion-button","","color","primary","icon-start","","id","addbuttonid",3,"click",4,"ngIf"],["ion-button","","color","delete","icon-start","","id","deletebuttonid",3,"click",4,"ngIf"],["lines","none",1,"asset-img-circle","ion-no-padding","ion-no-margin",3,"ngClass","click"],[1,"image-tap",3,"id","tap"],["name","inline-checkbox","type","checkbox",1,"gridlist-item-checkbox",3,"disabled","ngClass","id","checked","ngModel","ngModelChange"],[1,"circle-icon"],[1,"initials-bg","cursor-pointer",3,"ngStyle"],[1,"initials",3,"ngStyle"],[1,"check-box-bg"],[1,"gridview-title"],["class","mg-0 d-flex justify-content-center cursor-pointer two-lines-ellipsis",4,"ngIf"],[1,"mg-0","d-flex","justify-content-center","cursor-pointer","two-lines-ellipsis"],[1,"imgcontainer-bg"],["onerror","this.onerror=null;this.src='assets/img/image_placeholder.jpg';",1,"grid-img",3,"src"],["ion-button","","color","primary","icon-start","","id","addbuttonid",3,"click"],["aria-hidden","true",1,"fas","fa-15x","fa-plus"],["ion-button","","color","delete","icon-start","","id","deletebuttonid",3,"click"],["aria-hidden","true",1,"fas","fa-15x","fa-trash"],["id","doinfiniteid",3,"ionInfinite"],["loadingSpinner","bubbles",3,"loadingText"],[1,"error-message"],["size","12",1,"ion-no-padding","ion-text-center"],["color","danger",1,"ion-text-center"],["name","circles",1,"spinner"],[1,"ft-slider"],["autoplay","4000","loop","true","speed","5000",4,"ngIf"],["autoplay","4000","loop","true","speed","5000"],[4,"ngFor","ngForOf"],["height","56","width","100%","position","bottom",3,"src","click"],["preload","metadata","controls","controls","autoplay","autoplay","muted","muted",1,"videoPlayer",2,"width","100%","height","50px",3,"click"],["type","video/mp4","height","56","width","100%","position","bottom",3,"src"],["controls",""],["autoplay","autoplay","type","audio/mp3",3,"src"]],template:function(s,i){1&s&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"app-pageheader",3),e.NdJ("headerItemClick",function(n){return i.onHeaderItemClick(n)}),e.qZA()(),e.TgZ(4,"div",4)(5,"ion-row")(6,"ion-col",5)(7,"ion-searchbar",6),e.NdJ("ionChange",function(n){return i.searchresultlist(n.target.value)})("keypress",function(n){return i.handleKeyPress(n)}),e.ALo(8,"translate"),e.qZA()()()(),e.YNc(9,k,2,1,"div",7),e.TgZ(10,"div",8),e.YNc(11,Y,2,1,"div",9),e.YNc(12,se,4,1,"div",10),e.YNc(13,ie,3,3,"ion-infinite-scroll",11),e.YNc(14,ae,5,3,"ion-row",12),e.YNc(15,le,1,0,"ion-spinner",13),e.qZA()(),e.YNc(16,ge,2,4,"ion-footer",14),e.qZA()),2&s&&(e.xp6(3),e.Q6J("pageName",i.dataJsonObj.pageName)("pageTitle",i.dataJsonObj.pageTitle)("showPageHeaderItems",!1)("showDependencySubMenu",!1)("continueButtonEnable",i.count),e.xp6(4),e.s9C("placeholder",e.lcZ(8,13,"COMMON_BUTTONS.BUTTON_SEARCH")),e.xp6(2),e.Q6J("ngIf",i.dataJsonObj.showSpinner),e.xp6(2),e.Q6J("ngIf","LIST_VIEW"===i.listType),e.xp6(1),e.Q6J("ngIf","GRID_VIEW"===i.listType),e.xp6(1),e.Q6J("ngIf",!0===i.hideloadassertmsg),e.xp6(1),e.Q6J("ngIf",!0===i.nodata),e.xp6(1),e.Q6J("ngIf",!0===i.spinner),e.xp6(1),e.Q6J("ngIf",!0===i.advData))},dependencies:[f.mk,f.sg,f.O5,f.PC,Z.q,A.X$],encapsulation:2})}return a})(),data:{title:"Selecte Assets"}}];let me=(()=>{class a{static \u0275fac=function(s){return new(s||a)};static \u0275mod=e.oAB({type:a});static \u0275inj=e.cJS({imports:[u.Bz.forChild(he),u.Bz]})}return a})();var pe=d(65673);let _e=(()=>{class a{static \u0275fac=function(s){return new(s||a)};static \u0275mod=e.oAB({type:a});static \u0275inj=e.cJS({providers:[N.f,C.v],imports:[f.ez,me,A.aw,pe.Q]})}return a})()}}]);