"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9396],{39396:(ne,b,o)=>{o.r(b),o.d(b,{FReportsModule:()=>ee});var d=o(36895),u=o(62510),E=o(11210),c=o(32236),v=o(42863),N=o(71568),S=o(75875),e=o(94650);let T=(()=>{class n{authService;constructor(t){this.authService=t}getReportData(t,a,s,r,l){return new Promise((f,_)=>{this.authService.getApiCall("api/v1/financetrialbalances?type=list&enterprise_id="+t+"&business_entity_id="+a+"&report_name="+l+"&start_date="+s+"&end_date="+r).subscribe(p=>{f(p)},p=>{_(p)})})}downloadReport(t){return this.authService.getReport(t)}static \u0275fac=function(a){return new(a||n)(e.LFG(S.e))};static \u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var R=o(42786),h=o(54463),A=o(27601),y=o(46448),m=o(93144),C=o(10805),g=o(32174),D=o(2387),I=o(56368),L=o(9851),M=o(17867),F=o(37415);const Z=["businessEntity"],x=["startDate"],B=["endDate"];function J(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"i",26),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.downLoadFile())}),e.qZA()}}function U(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"app-button",40),e.NdJ("buttonOnClick",function(s){e.CHM(t);const r=e.oxw(2);return e.KtG(r.getSummary(s))})("buttonOnClick",function(s){e.CHM(t);const r=e.oxw(2);return e.KtG(r.onClick(s))}),e.ALo(1,"translate"),e.qZA()}2&n&&e.s9C("label",e.lcZ(1,1,"COMMON_FIELDS.SUMMARY"))}function w(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"app-button",41),e.NdJ("buttonOnClick",function(s){e.CHM(t);const r=e.oxw(2);return e.KtG(r.generateReport(s))})("buttonOnClick",function(s){e.CHM(t);const r=e.oxw(2);return e.KtG(r.onClick(s))}),e.ALo(1,"translate"),e.qZA()}2&n&&e.s9C("label",e.lcZ(1,1,"COMMON_FIELDS.DETAILS"))}function j(n,i){if(1&n&&(e.TgZ(0,"tr")(1,"td",43),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.uIk("colspan",t[0].length+1),e.xp6(1),e.hij(" ",e.lcZ(3,2,"COMMON_VALIDATION_MESSAGES.VALID_NO_RESULTS_FOUND"),"")}}function k(n,i){if(1&n&&e.YNc(0,j,4,4,"tr",42),2&n){const t=e.oxw(2);e.Q6J("ngIf",t.data&&0===t.data.length)}}function V(n,i){if(1&n&&(e.TgZ(0,"th",45),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n){const t=i.$implicit;e.Tol(t.class),e.xp6(1),e.hij(" ",e.lcZ(2,4,t.header)," ")}}function P(n,i){if(1&n&&(e.TgZ(0,"tr"),e.YNc(1,V,3,6,"th",44),e.qZA()),2&n){const t=i.$implicit;e.xp6(1),e.Q6J("ngForOf",t[0])}}function Y(n,i){if(1&n&&(e.TgZ(0,"td",47),e._uU(1),e.qZA()),2&n){const t=i.$implicit,a=e.oxw().$implicit;e.Tol(t.class),e.Q6J("pSelectableRow",a),e.xp6(1),e.hij(" ",a[t.field]," ")}}function H(n,i){if(1&n&&(e.TgZ(0,"tr"),e.YNc(1,Y,2,5,"td",46),e.qZA()),2&n){const t=i.columns;e.xp6(1),e.Q6J("ngForOf",t[0])}}function Q(n,i){if(1&n&&(e.TgZ(0,"div",3)(1,"strong"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._uU(4," : "),e._UZ(5,"span",49)(6,"br"),e.qZA()),2&n){const t=i.$implicit,a=e.oxw().$implicit;e.xp6(2),e.Oqu(e.lcZ(3,2,t.header)),e.xp6(3),e.Q6J("innerHTML",a[t.field],e.oJD)}}function G(n,i){if(1&n&&(e.TgZ(0,"tr")(1,"td")(2,"div",2),e.YNc(3,Q,7,4,"div",48),e.qZA()()()),2&n){const t=i.columns;e.xp6(1),e.uIk("colspan",t[0].length+2),e.xp6(2),e.Q6J("ngForOf",t[1])}}function K(n,i){if(1&n&&(e.TgZ(0,"div",3)(1,"div",27)(2,"div",28)(3,"p-accordion",29)(4,"p-accordionTab",30)(5,"p-header",31)(6,"span"),e._uU(7),e.ALo(8,"translate"),e.qZA(),e.TgZ(9,"span",32),e.YNc(10,U,2,3,"app-button",33),e.YNc(11,w,2,3,"app-button",34),e.qZA()(),e.TgZ(12,"p-table",35),e.YNc(13,k,1,1,"ng-template",36),e.YNc(14,P,2,1,"ng-template",37),e.YNc(15,H,2,1,"ng-template",38),e.YNc(16,G,4,2,"ng-template",39),e.qZA()()()()()()),2&n){const t=e.oxw();e.xp6(3),e.Q6J("multiple",!0),e.xp6(1),e.Q6J("selected",!0),e.xp6(3),e.Oqu(e.lcZ(8,9,"COMMON_BLOCK_TITLES.RESULTS")),e.xp6(3),e.Q6J("ngIf",!0===t.result),e.xp6(1),e.Q6J("ngIf",!0===t.result),e.xp6(1),e.Q6J("columns",t.header)("value",t.data)("rows",10)("lazy",!0)}}const $=[{path:"",data:{title:"financereports"},children:[{path:"",canActivate:[E.P],component:(()=>{class n{router;route;commonService;translateService;uiUtils;navigationService;ColumnHeader;loggerService;financeReport;businessEntity;startDate;endDate;apiUrl;balanceSheet;businessEntityId;businessEntityObj;businessEntityOptions;data;endDateValue;enterpriseId;enterpriseShortName;err;error;filename;financeReportId;financeReportName;financeReportObj;financeReportOptions;forcerefresh;header1;header2;header3;header;headerAction;listData;object_type;result=!1;startDateValue;submitenabled;trialBalData;trialBalDataObj;trialPLData;trialPLDataObj;dataJsonObj={};constructor(t,a,s,r,l,f,_,p,te){this.router=t,this.route=a,this.commonService=s,this.translateService=r,this.uiUtils=l,this.navigationService=f,this.ColumnHeader=_,this.loggerService=p,this.financeReport=te}ngOnInit(){this.dataJsonObj.pageName=c.hf.FINANCE_REPORTS,this.headerAction={BACK:!0},this.object_type=this.route.snapshot.data.object_type,this.startDateValue=new Date,this.endDateValue=new Date,this.enterpriseId=JSON.parse(localStorage.getItem(c.BU.SELECTED_ENTERPRISE)),this.commonService.getLookupCodesListJson(this.enterpriseId,"list").then(t=>{this.dataJsonObj.lookupCodesListJSON=t,this.getBusinessEntityNameOptions(),this.getReportNameOptions()}),this.getEnterpriseData(),this.initializeComponent(),this.forcerefresh=!1,this.header1=this.ColumnHeader.getTrialBalColumnHeaders(),this.header2=this.ColumnHeader.getProfitAndLossColumnHeaders(),this.header3=this.ColumnHeader.getBalanceColumnHeaders(),this.commonService.currentEvent.subscribe(t=>{"f-reports"===t&&(this.forcerefresh=!0)})}initializeComponent(){this.dataJsonObj.pageTitle=[{key:"COMMON_PAGE_TITLES.FINANCE_REPORTS",value:"",showSubMenuDisplayName:!1}]}getEnterpriseData(){try{this.commonService.getEnterprisesViewData(this.enterpriseId).then(t=>{this.enterpriseShortName=t.short_name}).catch(t=>{this.loggerService.setLoggerError(this.constructor.name,"getEnterpriseData",t)})}catch(t){this.loggerService.setLoggerError(this.constructor.name,"getEnterpriseData",t)}}getBusinessEntityNameOptions(){try{this.commonService.getFilteredLookupCodes(this.dataJsonObj.lookupCodesListJSON[c.ox.BUSINESS_ENTITY_NAMES],"").then(t=>{this.businessEntityOptions=t,this.businessEntityId=this.businessEntityOptions[0].ID,this.businessEntityObj=t[0]},t=>{this.loggerService.setLoggerError(this.constructor.name,"getBusinessEntityNameOptions",t)})}catch(t){this.loggerService.setLoggerError(this.constructor.name,"getBusinessEntityNameOptions",t)}}changeSelectedBusinessEntityName(t){try{t.value&&(this.businessEntityId=t.value,this.businessEntityObj=this.businessEntityOptions.find(a=>a.ID===parseInt(this.businessEntityId,10))),this.error=""}catch(a){this.loggerService.setLoggerError(this.constructor.name,"getSelectedBusinessEntityName",a)}}getReportNameOptions(){try{this.commonService.getFilteredLookupCodes(this.dataJsonObj.lookupCodesListJSON[c.ox.FINANCE_REPORT_NAMES],"").then(t=>{this.financeReportOptions=t,this.financeReportId=this.financeReportOptions[0].ID,this.financeReportObj=t[0],this.financeReportName=t[0].lookup_name},t=>{this.loggerService.setLoggerError(this.constructor.name,"getBusinessEntityNameOptions",t)})}catch(t){this.loggerService.setLoggerError(this.constructor.name,"getBusinessEntityNameOptions",t)}}changeSelectedReportName(t){try{t.value&&(this.financeReportId=t.value,this.financeReportObj=this.financeReportOptions.find(a=>a.ID===parseInt(this.financeReportId,10)),this.financeReportName=this.financeReportObj.lookup_name),this.error=""}catch(a){this.loggerService.setLoggerError(this.constructor.name,"getSelectedBusinessEntityName",a)}}changeStartDate(t){try{this.startDateValue=t.value,t.value&&(this.error=new Date(this.startDateValue)>new Date(this.endDateValue)?"COMMON_VALIDATION_MESSAGES.VALID_NOBLANK_END_DATE_GREATER_START":"")}catch(a){this.loggerService.setLoggerError(this.constructor.name,"changeStartDate",a)}}changeEndDate(t){try{this.endDateValue=t.value,t.value&&(this.error=new Date(this.startDateValue)>new Date(this.endDateValue)?"COMMON_VALIDATION_MESSAGES.VALID_NOBLANK_END_DATE_GREATER_START":"")}catch(a){this.loggerService.setLoggerError(this.constructor.name,"changeEndDate",a)}}generateReport(){try{this.header=[],this.data=[],this.financeReport.getReportData(this.enterpriseId,this.businessEntityId,this.startDateValue,this.endDateValue,this.financeReportName).then(t=>{t.data?(this.err="",this.apiUrl=t.report_path,this.result=!0,"TRIAL_BALANCE"===this.financeReportName?(this.trialBalData=t.data,this.header=this.header1,this.data=t.data):"BALANCE_SHEET"===this.financeReportName?(this.header=this.header2,this.balanceSheet=t.data,this.data=t.data):"PROFIT_AND_LOSS"===this.financeReportName&&(this.header=this.header3,this.trialPLData=t.data,this.data=t.data)):t.error&&(this.err=t.error,this.result=!1),this.loggerService.setLoggerInfo(1,this.constructor.name,"getReportData","Data fetched successfully")})}catch(t){this.loggerService.setLoggerError(this.constructor.name,"generateReport",t)}}downLoadFile(){this.financeReport.downloadReport(this.apiUrl).subscribe(t=>{this.download(t,this.apiUrl,"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet; /xls; /xlsx; /vnd.ms-excel; /vnd.openxmlformats-officedocument.spreadsheetml.sheet")},t=>{this.commonErrorCodes(JSON.parse(t))})}download(t,a,s){const r=new Blob([t.body],{type:s}),l=document.createElement("a");l.href=URL.createObjectURL(r),this.filename=a.split("/").pop(),l.download=this.filename,document.body.appendChild(l),l.click()}cancelBtn(){try{this.commonService.redirectToPreviousUrl()}catch(t){this.loggerService.setLoggerError(this.constructor.name,"cancelBtn",t)}}onClick(t){t.stopPropagation()}getSummary(t){this.header=[]}commonErrorCodes(t){const a=JSON.parse(t[c.BU.STATUS]);409===a&&(this.error="COMMON_STATUS_CODES."+a)}pageheadeActionClick(t){"BACK"==t.value&&this.cancelBtn()}static \u0275fac=function(a){return new(a||n)(e.Y36(u.F0),e.Y36(u.gz),e.Y36(N.v),e.Y36(h.sK),e.Y36(A.s),e.Y36(y.f),e.Y36(v.Y),e.Y36(R.m),e.Y36(T))};static \u0275cmp=e.Xpm({type:n,selectors:[["app-f-reports"]],viewQuery:function(a,s){if(1&a&&(e.Gf(Z,5),e.Gf(x,5),e.Gf(B,5)),2&a){let r;e.iGM(r=e.CRH())&&(s.businessEntity=r.first),e.iGM(r=e.CRH())&&(s.startDate=r.first),e.iGM(r=e.CRH())&&(s.endDate=r.first)}},features:[e._Bn([v.Y])],decls:41,vars:41,consts:[[1,"container-fluid","mgroups-create"],[1,"forms-wrapper"],[1,"row","g-0"],[1,"col-md-12"],[1,"card","bdt-0"],["id","stickyHeaderID",1,"card-header","card-header-primary"],[1,"subpage-header-title","w-100",3,"pageName","pageTitle","showPageHeaderItems","showDependencySubMenu","actions"],[1,"list-inline","d-inline-block","mb-0","action-list","d-none","d-lg-block"],["data-toggle","modal",1,"list-inline-item"],["mat-raised-button","",1,"btn","btn-link","btn-white","btn-sm","m-0",3,"id"],["class","fas fa-file-download me-1",3,"click",4,"ngIf"],[1,"card-body"],[1,"row","form-bs"],[1,"col-md-4"],["disabled","true","id","f-reports-enterprise",3,"label","value"],["disabled","false","mandatory","true","id","f-reports-business-entity",3,"label","defaultValue","options","valueChange"],["businessEntity",""],["mandatory","true","id","f-reports-reportname",3,"label","options","defaultValue","valueChange"],["dateformat","dd-MMM-yyyy","mandatory","true","disabled","false","id","f-reports-startdate",3,"placeholder","defaultDate","dateChangeValue"],["endDate",""],["dateformat","dd-MMM-yyyy","mandatory","true","disabled","false","id","f-reports-enddate",3,"placeholder","defaultDate","dateChangeValue"],[1,"col-md-4","text-end","mt-2"],["className","btn btn-primary btn-sm","id","f-reports-submit",3,"label","disabled","buttonOnClick"],["className","btn btn-danger btn-sm","id","f-reports-cancel",3,"label","buttonOnClick"],[1,"error-msg","col-md-12","text-danger","text-center","mb-0","order-md-1","order-2"],["class","col-md-12",4,"ngIf"],[1,"fas","fa-file-download","me-1",3,"click"],[1,"card"],[1,"card-content"],[3,"multiple"],[3,"selected"],[1,"d-flex","justify-content-between","w-100","accordion-header"],[1,"d-flex"],["disabled","false","class","btn btn-success btn-sm","id","f-reports-summary",3,"label","buttonOnClick",4,"ngIf"],["disabled","false","class","btn btn-success btn-sm","id","f-reports-details",3,"label","buttonOnClick",4,"ngIf"],["selectionMode","single","dataKey","LineNum",1,"ptable","scrollabletable",3,"columns","value","rows","lazy"],["pTemplate","emptymessage"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],["disabled","false","id","f-reports-summary",1,"btn","btn-success","btn-sm",3,"label","buttonOnClick"],["disabled","false","id","f-reports-details",1,"btn","btn-success","btn-sm",3,"label","buttonOnClick"],[4,"ngIf"],[1,"text-center","text-danger"],["style","text-align: left !important;",3,"class",4,"ngFor","ngForOf"],[2,"text-align","left !important"],[3,"pSelectableRow","class",4,"ngFor","ngForOf"],[3,"pSelectableRow"],["class","col-md-12",4,"ngFor","ngForOf"],[3,"innerHTML"]],template:function(a,s){1&a&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5),e._UZ(6,"app-pageheader",6),e.TgZ(7,"ul",7)(8,"li",8)(9,"a",9),e.YNc(10,J,1,0,"i",10),e._uU(11),e.ALo(12,"translate"),e.qZA()()()(),e.TgZ(13,"div",11)(14,"div",12)(15,"div",13),e._UZ(16,"app-input",14),e.ALo(17,"translate"),e.qZA(),e.TgZ(18,"div",13)(19,"app-dropdown-singleselect",15,16),e.NdJ("valueChange",function(l){return s.changeSelectedBusinessEntityName(l)}),e.ALo(21,"translate"),e.qZA()(),e.TgZ(22,"div",13)(23,"app-dropdown-singleselect",17),e.NdJ("valueChange",function(l){return s.changeSelectedReportName(l)}),e.ALo(24,"translate"),e.qZA()(),e.TgZ(25,"div",13)(26,"app-advsearchdatepicker",18,19),e.NdJ("dateChangeValue",function(l){return s.changeStartDate(l)}),e.ALo(28,"translate"),e.qZA()(),e.TgZ(29,"div",13)(30,"app-advsearchdatepicker",20,19),e.NdJ("dateChangeValue",function(l){return s.changeEndDate(l)}),e.ALo(32,"translate"),e.qZA()(),e.TgZ(33,"div",21)(34,"app-button",22),e.NdJ("buttonOnClick",function(){return s.generateReport()}),e.ALo(35,"translate"),e.qZA(),e.TgZ(36,"app-button",23),e.NdJ("buttonOnClick",function(){return s.cancelBtn()}),e.ALo(37,"translate"),e.qZA()(),e.TgZ(38,"div",24),e._uU(39),e.qZA()()()()(),e.YNc(40,K,17,11,"div",25),e.qZA()()()),2&a&&(e.xp6(6),e.Q6J("pageName",s.dataJsonObj.pageName)("pageTitle",s.dataJsonObj.pageTitle)("showPageHeaderItems",!1)("showDependencySubMenu",!1)("actions",s.headerAction),e.xp6(3),e.MGl("id","vendor-buyers-",s.object_type,"-list-reports"),e.xp6(1),e.Q6J("ngIf",!0===s.result),e.xp6(1),e.Oqu(e.lcZ(12,25,"COMMON_BUTTONS.BUTTON_DOWNLOAD")),e.xp6(5),e.s9C("label",e.lcZ(17,27,"COMMON_PAGE_TITLES.ENTERPRISE")),e.s9C("value",s.enterpriseShortName),e.xp6(3),e.s9C("label",e.lcZ(21,29,"COMMON_FIELDS.BUSINESS_ENTITY")),e.s9C("defaultValue",s.businessEntityId),e.Q6J("options",s.businessEntityOptions),e.xp6(4),e.s9C("label",e.lcZ(24,31,"REPORTS.REPORT_NAME")),e.s9C("defaultValue",s.financeReportId),e.Q6J("options",s.financeReportOptions),e.xp6(3),e.s9C("placeholder",e.lcZ(28,33,"COMMON_FIELDS.START_DATE")),e.s9C("defaultDate",s.startDateValue),e.xp6(4),e.s9C("placeholder",e.lcZ(32,35,"COMMON_FIELDS.END_DATE")),e.s9C("defaultDate",s.endDateValue),e.xp6(4),e.s9C("label",e.lcZ(35,37,"COMMON_BUTTONS.BUTTON_SUBMIT")),e.Q6J("disabled",s.submitenabled),e.xp6(2),e.s9C("label",e.lcZ(37,39,"COMMON_BUTTONS.BUTTON_CANCEL")),e.xp6(3),e.hij(" ",s.err," "),e.xp6(1),e.Q6J("ngIf",!0===s.result))},dependencies:[d.sg,d.O5,m.iA,C.h4,C.jx,m.Ei,g.UQ,g.US,D.r,I.a,L.k,M.H,F.q,h.X$]})}return n})(),data:{object_type:c.hf.FINANCE_JOURNAL_ENTRIES,title:"",responsibilityParam:c.bP.MENUS+"."+c.w1.FINANCE+"."+c.bP.SUBMENUS+"."+c.w1.FINANCE_REPORTS+"."+c.Iu.ENABLED,pageName:c.hf.REPORTS}}]}];let q=(()=>{class n{static \u0275fac=function(a){return new(a||n)};static \u0275mod=e.oAB({type:n});static \u0275inj=e.cJS({imports:[u.Bz.forChild($),u.Bz]})}return n})();var O=o(24006),X=o(65673),W=o(32137);let ee=(()=>{class n{static \u0275fac=function(a){return new(a||n)};static \u0275mod=e.oAB({type:n});static \u0275inj=e.cJS({imports:[q,d.ez,d.ez,h.aw,O.u5,O.UX,m.U$,g.fx,X.Q,W.D]})}return n})()}}]);