"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8331],{28331:(_e,B,o)=>{o.r(B),o.d(B,{EmailModule:()=>je});var T=o(36895),f=o(24006),H=o(65673),Y=o(93144),S=o(54463),v=o(32174),d=o(62510),I=o(15861),Q=o(35226),P=o.n(Q),R=o(42863),E=o(71568),D=o(47561),F=o(28168),G=o(75875),r=o(32236),z=o(90313),e=o(94650),V=o(80529);let O=(()=>{class l{http;authService;userToken=localStorage.getItem(r.BU.TOKEN);constructor(a,i){this.http=a,this.authService=i}getAll(a,i,t,s,n,c,m,u,h){const g=n&&n.trim()?"&search="+n:"",b=s&&s.trim()?"&sort="+s:"",Z=z.L.isEmpty(h)?"":"&advSearchString="+JSON.stringify(h);return this.authService.getApiCall("api/v1/emails?type=list&enterprise.enterprise_id="+a+"&skip="+i+"&limit="+t+b+g+m+(u||"")+Z,c)}create(a,i){return new Promise((t,s)=>{const n=new FormData;if(i.length>0)for(let c=0;c<i.length;c++)n.append("emailFiles",i[c]);n.append("emailData",JSON.stringify(a)),this.authService.postApiCall("api/v1/emails/",n).subscribe(c=>{t(c)},c=>{s(c)})})}update(a,i){return new Promise((t,s)=>{this.authService.putApiCall("api/v1/emails/"+i,a).subscribe(n=>{t(n)},n=>{s(n)})})}get(a){return this.authService.getApiCall("api/v1/emails/"+a,!0)}delete(a){return new Promise((i,t)=>{this.authService.deleteApiCall("api/v1/emails/"+a).subscribe(s=>{i(s)},s=>{t(s)})})}getEmailsettings(a){return new Promise((i,t)=>{this.authService.getApiCall("api/v1/configoptions?type=list&configoption_name=emailSettings&enterprise.enterprise_id="+a).subscribe(s=>{i(s)},s=>{t(s)})})}getObjectNames(a,i,t){return new Promise((s,n)=>{this.authService.getApiCall("api/v1/"+a+"?type=drop&enterprise.enterprise_id="+i+"&search="+t).subscribe(c=>{s(c)},c=>{n(c)})})}static \u0275fac=function(i){return new(i||l)(e.LFG(V.eN),e.LFG(G.e))};static \u0275prov=e.Yz7({token:l,factory:l.\u0275fac})}return l})();var k=o(30578),j=o(42786),C=o(27601),W=o(65412),_=o(70057),A=o(37415),$=o(88425);const K=["datatableComponent"];let X=(()=>{class l extends D.O{dialog;commonService;route;translateService;columnheaders;toastController;listingVariables;router;uiUtils;actionSheetController;emailService;loggerService;datatableComponent;actions;emailData;emailListData;emailListMobileData=[];enterpriseId;fabMobileactions;forcerefresh=!1;mobileroutesArray;multipleRecordsArray;noDuplicates=void 0;searchString;sweetAtertDelete;tableColumnheaders;emailSubscription;dataJsonObj={};constructor(a,i,t,s,n,c,m,u,h,g,b,Z){super(t,i),this.dialog=a,this.commonService=i,this.route=t,this.translateService=s,this.columnheaders=n,this.toastController=c,this.listingVariables=m,this.router=u,this.uiUtils=h,this.actionSheetController=g,this.emailService=b,this.loggerService=Z,this.route.queryParams.subscribe(y=>{this.dataJsonObj.queryParamsObj={defaultView:y.default_view,selectedMenuId:y.selectedMenuId,selectedSubMenuId:y.selectedSubMenuId}})}ngOnInit(){document.getElementsByTagName("body"),this.initializeComponent()}ngOnDestroy(){this.emailSubscription&&(this.emailSubscription.unsubscribe(),this.emailSubscription=void 0)}initializeComponent(){this.showSpinner(),this.dataJsonObj.pageName=r.hf.EMAILS,this.dataJsonObj.advancedSearchObj={},JSON.parse(localStorage.getItem(r.BU.MENU_CLICK_ITEM)),this.dataJsonObj.pageTitle=[{key:"COMMON_FIELDS.ALL",value:"",showSubMenuDisplayName:!1},{key:"COMMON_PAGE_TITLES.EMAILS",value:"",showSubMenuDisplayName:!0}],this.commonService.trackView(r.sn.NOTIFICATION_LIST),this.multipleRecordsArray=[],this.tableColumnheaders=this.columnheaders.getEmailHeaders(),this.sweetAtertDelete=r.Mi.DELETEBASIC,this.listingVariables.pageNumbers=1,this.listingVariables.totalRecords=1,this.searchString="",this.commonService.currentEvent.subscribe(i=>{"emails"===i&&(this.forcerefresh=!0)}),this.actions={EDIT:this.roleRightsValidationByPage(r.hf.EMAILS,r.AM.ACTIONS,r.In.EDIT),DELETE:this.roleRightsValidationByPage(r.hf.EMAILS,r.AM.ACTIONS,r.In.DELETE),PUBLISH:this.roleRightsValidationByPage(r.hf.EMAILS,r.AM.ACTIONS,r.In.PUBLISH)},this.dataJsonObj.addFiltersList=[],this.dataJsonObj.pageActionsList=[],this.roleRightsValidationByPage(r.hf.EMAILS,r.AM.ACTIONS,r.In.CREATE)&&this.dataJsonObj.pageActionsList.push({actionName:"CREATE",displayName:"COMMON_BUTTONS.BUTTON_CREATE",actionType:r.gL.URL,redirectURL:"/emails/create",queryParams:"",iconClass:"fas fa-plus"}),this.roleRightsValidationByPage(r.hf.EMAILS,r.AM.ACTIONS,r.In.FILTERS)}getAllRecords(){try{this.showSpinner(),this.enterpriseId=localStorage.getItem(r.BU.SELECTED_ENTERPRISE);const a=this.commonService.getMobileViewCondition(this.dataJsonObj.selectedDisplayView);this.emailSubscription&&(this.emailSubscription.unsubscribe(),this.emailSubscription=void 0),this.emailSubscription=this.emailService.getAll(this.enterpriseId,this.listingVariables.pageNumbers,this.listingVariables.rowsPerPage,this.listingVariables.sortOrderColumn,this.searchString,this.forcerefresh,a,this.dataJsonObj.selectedFilter?"&filtertype="+this.dataJsonObj.selectedFilter:"",this.dataJsonObj.advancedSearchObj.inputAdvSearchObj).subscribe(t=>{if(this.hideSpinner(),this.forcerefresh?this.emailListMobileData=[]:this.emailSubscription&&(this.emailSubscription.unsubscribe(),this.emailSubscription=void 0),t.rows.length>0){this.emailListMobileData&&this.emailListMobileData.length>0||(this.emailListMobileData=[]);for(let s=0;s<t.rows.length;s++){t.rows[s].display_grid_title=t.rows[s].enterprise.short_name,t.rows[s].createdAt=this.commonService.dbTimezoneFormatWithHours(t.rows[s].createdAt),t.rows[s].page_name="email",t.rows[s].firstLineDisplay=t.rows[s].enterprise.enterprise_name,t.rows[s].secondLineDisplay=t.rows[s].object.object_type.page_display_name,t.rows[s].thirdLineDisplay=t.rows[s].object.object_name,t.rows[s].enterprise&&(t.rows[s].enterprise.short_name='<a class="enable" id="enterprise.short_name'+t.rows[s]._id+'"  href="enterprises/enterprises/'+t.rows[s].enterprise.enterprise_id+'/view" >'+t.rows[s].enterprise.short_name);const n={url:`emails/${t.rows[s]._id}/view`,queryParams:this.dataJsonObj.queryParamsObj?this.dataJsonObj.queryParamsObj:""},c=n.queryParams&&Object.keys(n.queryParams).length>0?`${n.url}?${JSON.stringify(n.queryParams)}`:n.url;t.rows[s].subject=`<a class="enable" id="subject${t.rows[s]._id}" href=${c}>${t.rows[s].subject}`,this.emailListMobileData=this.emailListMobileData.filter(m=>m._id!==t.rows[s]._id),this.emailListMobileData.push(t.rows[s])}t.totalCount&&(this.listingVariables.totalRecords=t.totalCount),1===this.listingVariables.pageNumbers&&(this.listingVariables.totalpages=t.pages),this.dataJsonObj.isLoadMoreClicked?(this.dataJsonObj.isLoadMoreClicked=!1,this.emailListData=this.emailListData.concat(t.rows)):this.emailListData=t.rows}else this.emailListData=[],this.emailListMobileData=[]},t=>{this.hideSpinner(),this.loggerService.setLoggerError(this.constructor.name,"getAllRecords",t)})}catch(a){this.hideSpinner(),this.loggerService.setLoggerError(this.constructor.name,"getAllRecords",a)}}onActionClicked(a){const i=a.data._id;a.action===r.A0.VIEW?this.commonService.redirectToUrl(["..",a.data._id,"view"],!0,!0,this.dataJsonObj.queryParamsObj?this.dataJsonObj.queryParamsObj:"",this.route):a.action===r.A0.EDIT?this.router.navigate(["/emails/"+i+"/edit"]):a.action===r.A0.DELETE?this.delete(a.data._id):a.action===r.A0.PUBLISH&&this.publish(a.data._id)}publish(a){this.emailService.get(a).subscribe(i=>{i.type=r.A0.PUBLISH,this.emailData=i}),P().fire({title:"",text:this.translateService.instant("COMMON_CONFIRM_MESSAGES.CONFIRM_EMAIL_PUBLISH"),showCancelButton:!0,cancelButtonText:this.translateService.instant("COMMON_BUTTONS.BUTTON_NO"),confirmButtonText:this.translateService.instant("COMMON_BUTTONS.BUTTON_YES"),customClass:{confirmButton:"btn btn-primary btn-sm mgr-5 mat-raised-button mr-1",cancelButton:"btn btn-danger btn-sm mat-raised-button"}}).then(i=>{i.value?this.emailService.update(this.emailData,a).then(t=>{this.uiUtils.displaytoastMessage("COMMON_TOAST_MESSAGES.TOAST_SUCCESS_CREATE"),this.router.routeReuseStrategy.clearModuleRouteCache("emails"),this.getAllRecords()}).catch(t=>{this.loggerService.setLoggerError(this.constructor.name,"publish",t)}):this.getAllRecords()})}delete(a){P().fire({title:"",text:this.translateService.instant("COMMON_CONFIRM_MESSAGES.CONFIRM_RECORD_DELETE"),showCancelButton:!0,cancelButtonText:this.translateService.instant("COMMON_BUTTONS.BUTTON_NO"),confirmButtonText:this.translateService.instant("COMMON_BUTTONS.BUTTON_YES"),customClass:{confirmButton:"btn btn-primary btn-sm mgr-5 mat-raised-button mr-1",cancelButton:"btn btn-danger btn-sm mat-raised-button"}}).then(i=>{i.value?this.emailService.delete(a).then(t=>{this.uiUtils.displaytoastMessage("COMMON_TOAST_MESSAGES.TOAST_SUCCESS_DELETE"),this.router.routeReuseStrategy.clearModuleRouteCache("emails"),this.getAllRecords()}).catch(t=>{this.loggerService.setLoggerError(this.constructor.name,"delete",t)}):this.getAllRecords()})}mobileEventAction(a){this.mobileroutesArray=[],this.roleRightsValidationByPage(r.hf.EMAILS,r.AM.ACTIONS,r.In.DELETE)&&this.mobileroutesArray.push({text:this.translateService.instant("COMMON_BUTTONS.BUTTON_DELETE"),handler:()=>{this.delete(a._id)}}),this.roleRightsValidationByPage(r.hf.EMAILS,r.AM.ACTIONS,r.In.EDIT)&&this.mobileroutesArray.push({text:this.translateService.instant("COMMON_BUTTONS.BUTTON_EDIT"),handler:()=>{this.router.navigate(["/emails/"+a._id+"/edit"])}}),this.roleRightsValidationByPage(r.hf.EMAILS,r.AM.ACTIONS,r.In.PUBLISH)&&this.mobileroutesArray.push({text:this.translateService.instant("COMMON_BUTTONS.BUTTON_PUBLISH"),handler:()=>{this.publish(a._id)}}),this.roleRightsValidationByPage(r.hf.EMAILS,r.AM.ACTIONS,r.In.VIEW)&&this.mobileroutesArray.push({text:this.translateService.instant("COMMON_BUTTONS.BUTTON_VIEW"),handler:()=>{this.commonService.redirectToUrl(["..",a._id,"view"],!0,!0,this.dataJsonObj.queryParamsObj?this.dataJsonObj.queryParamsObj:"",this.route)}}),this.presentActionSheet(a)}presentActionSheet(a){var i=this;return(0,I.Z)(function*(){i.mobileroutesArray.length>0&&(yield(yield i.actionSheetController.create({cssClass:"actionsheet",buttons:i.mobileroutesArray})).present())})()}getRedirectUser(a){this.router.navigate(["/emails/"+a._id+"/view"]),this.router.routeReuseStrategy.clearModuleRouteCache("emails")}loadPageData(a){this.forcerefresh=a.forceRefresh,this.listingVariables.pageNumbers=a.listingVariables.pageNumbers,a.clearMobileData&&(this.emailListMobileData=this.noDuplicates),a.isPaginationChange&&(this.dataJsonObj.selectedFilter=a.selectedFilterType,this.dataJsonObj.isLoadMoreClicked=a.isLoadMoreClicked,this.dataJsonObj.advancedSearchObj.inputAdvSearchObj=a.selectedAdvancedSearchObj),this.getAllRecords()}showSpinner(){this.dataJsonObj.showSpinner=!0}hideSpinner(){this.dataJsonObj.showSpinner=!1}getSearchResult(a){try{this.listingVariables.pageNumbers=1,this.listingVariables.totalRecords=1,this.searchString=a,this.getAllRecords(),this.datatableComponent.reset()}catch(i){this.loggerService.setLoggerError(this.constructor.name,"getSearchResult",i)}}searchClose(){try{this.searchString="",this.listingVariables.pageNumbers=1,this.listingVariables.totalRecords=1,this.getAllRecords(),this.datatableComponent.reset()}catch(a){this.loggerService.setLoggerError(this.constructor.name,"searchClose",a)}}createEmail(){this.router.navigate(["/emails/create"])}selectedViewType(a){this.dataJsonObj.selectedDisplayView=a}selectedFilterType(a){a?this.dataJsonObj.selectedFilter=a:(this.dataJsonObj.selectedFilter="",this.dataJsonObj.selectedAdvancedSearchObj={})}onPageLevelActionClicked(a){}advancedSearchFilterClicked(a){this.dataJsonObj.selectedAdvancedSearchObj=a}onHeaderItemClick(a){switch(a.type){case"search":this.getSearchResult(a.event);break;case"search_close":this.searchClose();break;case"display_views":this.selectedViewType(a.event);break;case"filters":this.selectedFilterType(a.event);break;case"advanced_search":this.advancedSearchFilterClicked(a.event);break;case"page_actions":this.onPageLevelActionClicked(a.event)}}static \u0275fac=function(i){return new(i||l)(e.Y36(W.uw),e.Y36(E.v),e.Y36(d.gz),e.Y36(S.sK),e.Y36(R.Y),e.Y36(_.yF),e.Y36(k.v),e.Y36(d.F0),e.Y36(C.s),e.Y36(_.BX),e.Y36(O),e.Y36(j.m))};static \u0275cmp=e.Xpm({type:l,selectors:[["app-emails"]],viewQuery:function(i,t){if(1&i&&e.Gf(K,5),2&i){let s;e.iGM(s=e.CRH())&&(t.datatableComponent=s.first)}},features:[e._Bn([O,F.n,R.Y,C.s,k.v]),e.qOj],decls:10,vars:27,consts:[[1,"container-fluid"],[1,"card","bd-0"],["id","stickyHeaderID",1,"card-header","card-header-primary"],[1,"subpage-header-title","w-100",3,"pageName","defaultView","isFabDisplay","pageActionsList","pageTitle","selectedMenuId","selectedSubMenuId","showPageHeaderItems","showDependencySubMenu","headerItemClick"],["id","extraPaddingBottomID",1,"card-body","pdt-0"],[1,"",3,"header","actions","totalPages","listingVariables","paginator","showSpinner","mobileListData","data","totalRecords","expand","selectedDisplayViewType","selectedFilterType","selectedAdvancedSearchObj","pageName","selectedMenuId","selectedSubMenuId","actionClicked","redirectionEvent","itemClickEvent","loadPageData"],["datatableComponent",""],[1,"mgt-5"],[3,"isFabDisplay","actionsList","selectedAction"],[1,"card-body","pdt-0","pdb-0"]],template:function(i,t){1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"app-pageheader",3),e.NdJ("headerItemClick",function(n){return t.onHeaderItemClick(n)}),e.qZA()(),e.TgZ(4,"div",4)(5,"app-datatable",5,6),e.NdJ("actionClicked",function(n){return t.onActionClicked(n)})("redirectionEvent",function(n){return t.mobileEventAction(n)})("itemClickEvent",function(n){return t.getRedirectUser(n)})("loadPageData",function(n){return t.loadPageData(n)}),e.qZA(),e.TgZ(7,"div",7)(8,"app-page-actions",8),e.NdJ("selectedAction",function(n){return t.onPageLevelActionClicked(n)}),e.qZA()()(),e._UZ(9,"div",9),e.qZA()()),2&i&&(e.xp6(3),e.Q6J("pageName",t.dataJsonObj.pageName)("defaultView",null==t.dataJsonObj.queryParamsObj?null:t.dataJsonObj.queryParamsObj.defaultView)("isFabDisplay",!1)("pageActionsList",t.dataJsonObj.pageActionsList)("pageTitle",t.dataJsonObj.pageTitle)("selectedMenuId",null==t.dataJsonObj.queryParamsObj?null:t.dataJsonObj.queryParamsObj.selectedMenuId)("selectedSubMenuId",null==t.dataJsonObj.queryParamsObj?null:t.dataJsonObj.queryParamsObj.selectedSubMenuId)("showPageHeaderItems",!0)("showDependencySubMenu",!1),e.xp6(2),e.Q6J("header",t.tableColumnheaders)("actions",t.actions)("totalPages",t.listingVariables.totalpages)("listingVariables",t.listingVariables)("paginator",!0)("showSpinner",t.dataJsonObj.showSpinner)("mobileListData",t.emailListMobileData)("data",t.emailListData)("totalRecords",t.listingVariables.totalRecords)("expand",!1)("selectedDisplayViewType",t.dataJsonObj.selectedDisplayView)("selectedFilterType",t.dataJsonObj.selectedFilter)("selectedAdvancedSearchObj",t.dataJsonObj.selectedAdvancedSearchObj)("pageName",t.dataJsonObj.pageName)("selectedMenuId",null==t.dataJsonObj.queryParamsObj?null:t.dataJsonObj.queryParamsObj.selectedMenuId)("selectedSubMenuId",null==t.dataJsonObj.queryParamsObj?null:t.dataJsonObj.queryParamsObj.selectedSubMenuId),e.xp6(3),e.Q6J("isFabDisplay",!0)("actionsList",t.dataJsonObj.pageActionsList))},dependencies:[F.n,A.q,$.y]})}return l})();var x=o(57936),L=o(46448),J=o(10805),U=o(2387),w=o(56368),ee=o(42919),N=o(67375);const te=["objectNameDropdown"],ae=["objectTypeDropdown"],ie=["from"],se=["ccInput"],re=["subject"];function ne(l,p){if(1&l&&(e.TgZ(0,"ul")(1,"li")(2,"a",38),e._uU(3),e.qZA()()()),2&l){const a=p.$implicit;e.xp6(2),e.s9C("href",a.name,e.LSH),e.xp6(1),e.Oqu(a.name)}}function le(l,p){if(1&l&&(e.TgZ(0,"div",3)(1,"div",36),e._uU(2,"List of Files"),e.qZA(),e.YNc(3,ne,4,2,"ul",37),e.qZA()),2&l){const a=e.oxw();e.xp6(3),e.Q6J("ngForOf",a.selectedFiles)}}let oe=(()=>{class l{commonService;emailService;toastController;uiUtils;loggerService;enterprisesService;router;route;translateService;navigationService;objectNameDropdown;objectTypeDropdown;from;ccInput;subject;ckeitor_message;configJsonData;defaultCC;defaultEnterprise;defaultFrom;defaultObjectName;defaultObjectType;defaultObjectTypeDropdown;defaultSignature;defaultSubject;emailObj=new ce;enterpriseId;enterpriseName;enterpriseShortName;error;message;objectNameObj;objectNameOptions;objectTypeObj;objectTypeOptions;published;editorConfig={editable:!0,spellcheck:!0,height:"15rem",minHeight:"5rem",maxHeight:"auto",width:"auto",minWidth:"0",translate:"yes",enableToolbar:!0,showToolbar:!0,placeholder:"Enter text here...",defaultParagraphSeparator:"",defaultFontName:"",defaultFontSize:"",fonts:[{class:"arial",name:"Arial"},{class:"times-new-roman",name:"Times New Roman"},{class:"calibri",name:"Calibri"},{class:"comic-sans-ms",name:"Comic Sans MS"}],customClasses:[{name:"quote",class:"quote"},{name:"redText",class:"redText"},{name:"titleText",class:"titleText",tag:"h1"}],uploadUrl:"v1/image",uploadWithCredentials:!1,sanitize:!0,toolbarPosition:"top",toolbarHiddenButtons:[["justifyLeft","justifyCenter","justifyRight","justifyFull","indent","outdent"],["backgroundColor","customClasses","link","unlink","insertImage","insertVideo","removeFormat","backgroundColor"]]};object_type;logInUserObject;userName;enterpriseData;regards;selectedFiles=[];file;fileName;menuDataJson;applicationPagesJson;dataJsonObj={};constructor(a,i,t,s,n,c,m,u,h,g){this.commonService=a,this.emailService=i,this.toastController=t,this.uiUtils=s,this.loggerService=n,this.enterprisesService=c,this.router=m,this.route=u,this.translateService=h,this.navigationService=g}ngOnInit(){this.object_type=this.route.snapshot.data.object_type,document.getElementsByTagName("body"),this.initializeComponent()}initializeComponent(){this.dataJsonObj.pageName=r.hf.EMAILS,this.dataJsonObj.pageTitle=[{key:"COMMON_PAGE_TITLES.EMAILS",value:"",showSubMenuDisplayName:!1},{key:"",value:"-",showSubMenuDisplayName:!1},{key:"COMMON_BUTTONS.BUTTON_CREATE",value:"",showSubMenuDisplayName:!1}],this.commonService.trackView(r.sn.NOTIFICATION_CREATE),this.enterpriseId=localStorage.getItem(r.BU.SELECTED_ENTERPRISE),this.getMenusJsonData(),this.getEnterpriseRecordById(),this.message=this.ckeitor_message,this.getObjectTypeList(""),this.getEmailSettings()}getEnterpriseRecordById(){this.enterprisesService.getEnterprisesViewData(this.enterpriseId).subscribe(a=>{this.enterpriseName=a.enterprise_name,this.defaultEnterprise=a._id,this.enterpriseShortName=a.short_name},a=>{this.loggerService.setLoggerError(this.constructor.name,"getEnterpriseRecordById",a)})}getEmailSettings(){this.configJsonData=[],this.logInUserObject=JSON.parse(localStorage.getItem(r.BU.USER)),this.userName=this.logInUserObject.f_name+" "+this.logInUserObject.l_name,this.emailService.getEmailsettings(this.enterpriseId).then(a=>{this.configJsonData=a.rows[0],this.defaultFrom=this.configJsonData.configoption_json.emailConfigOptions.from,this.defaultSubject=this.configJsonData.configoption_json.emailConfigOptions.subject,this.defaultSignature=this.configJsonData.configoption_json.emailConfigOptions.signature,this.regards=this.defaultSignature.split("With regards ").join(""),this.defaultSignature="<div><br></div><div><br></div><div><br></div><div><br></div>With regards, <br> <b>"+this.userName+"</b><br> <b>"+this.enterpriseName+"</b><br>"+this.regards,this.ckeitor_message=this.defaultSignature},a=>{this.loggerService.setLoggerError(this.constructor.name,"getEmailSettings",a)})}getMenusJsonData(){var a=this;return(0,I.Z)(function*(){a.menuDataJson=yield a.commonService.getDynamicJson(a.enterpriseId,"module_manager","list");const i=yield a.commonService.getAllPagesFromModuleManagerJSON(a.menuDataJson);a.applicationPagesJson=i.filter(t=>!0===t.module_settings.is_email_enabled)})()}getObjectTypeList(a){try{this.commonService.getFilteredDynamicJSONData(this.applicationPagesJson,"NAME",a).then(i=>{this.objectTypeOptions=i}).catch(i=>{this.loggerService.setLoggerError(this.constructor.name,"getObjectTypeList",i)})}catch(i){this.loggerService.setLoggerError(this.constructor.name,"getObjectTypeList",i)}}changeObjectTypes(a){this.objectNameOptions=[];try{a.NAME&&(this.defaultObjectType=a.NAME,this.defaultObjectTypeDropdown="Messages"===this.defaultObjectType?"conversationmessages":"Attribute Definitions"===this.defaultObjectType?"attributedefs":"Users"===this.defaultObjectType?"userprofiles":this.defaultObjectType.toLowerCase().replace(/\s/g,""),this.getObjectNameList(""),this.defaultObjectName="",this.objectTypeObj=a)}catch(i){this.loggerService.setLoggerError(this.constructor.name,"changeObjectTypes",i)}}getObjectNameList(a){try{this.emailService.getObjectNames(this.defaultObjectTypeDropdown,this.enterpriseId,a).then(i=>{this.objectNameOptions=i}).catch(i=>{this.loggerService.setLoggerError(this.constructor.name,"getObjectNameList",i)})}catch(i){this.loggerService.setLoggerError(this.constructor.name,"getObjectNameList",i)}}changeObjectName(a){try{this.defaultObjectName=a.NAME,this.objectNameObj=a}catch(i){this.loggerService.setLoggerError(this.constructor.name,"changeObjectName",i)}}changeSubject(a){try{this.defaultSubject=a.value}catch(i){this.loggerService.setLoggerError(this.constructor.name,"changeSubject",i)}}changeCC(a){try{this.defaultCC=a.value}catch(i){this.loggerService.setLoggerError(this.constructor.name,"changeCC",i)}}createRecord(a){try{this.objectTypeDropdown.isValid()&&this.objectNameDropdown.isValid()&&this.from.isValid()&&(!this.defaultCC||this.ccInput.isValid())&&this.subject.isValid()&&(this.emailObj.enterprise={enterprise_id:this.enterpriseId,enterprise_name:this.enterpriseName,short_name:this.enterpriseShortName},this.emailObj.object={object_type:{page_id:this.objectTypeObj.ID,page_name:this.objectTypeObj.module.page_name,page_display_name:this.objectTypeObj.module.page_display_name},object_id:this.objectNameObj.ID,object_name:this.objectNameObj.NAME},this.emailObj.from=this.defaultFrom,this.emailObj.cc=this.defaultCC,this.emailObj.email_message=this.ckeitor_message,this.emailObj.subject=this.defaultSubject,this.emailObj.type=a,this.emailService.create(this.emailObj,this.file).then(s=>{this.uiUtils.displaytoastMessage("COMMON_TOAST_MESSAGES.TOAST_SUCCESS_CREATE"),this.commonService.redirectToPreviousUrl()},s=>{}))}catch(i){this.loggerService.setLoggerError(this.constructor.name,"createRecord",i)}}commonErrorCodes(a){409===JSON.parse(a[r.BU.STATUS])&&(this.error=this.translateService.instant("LOOKUPS.LOOKUPS_UNIQUENESS"))}cancelButton(){this.commonService.redirectToPreviousUrl()}selectFiles(a){if(a){const i=a.target.files;document.getElementById("importFile"),this.file=i[0],this.selectedFiles.push(this.file)}}static \u0275fac=function(i){return new(i||l)(e.Y36(E.v),e.Y36(O),e.Y36(_.yF),e.Y36(C.s),e.Y36(j.m),e.Y36(x.e),e.Y36(d.F0),e.Y36(d.gz),e.Y36(S.sK),e.Y36(L.f))};static \u0275cmp=e.Xpm({type:l,selectors:[["app-email-create"]],viewQuery:function(i,t){if(1&i&&(e.Gf(te,5),e.Gf(ae,5),e.Gf(ie,5),e.Gf(se,5),e.Gf(re,5)),2&i){let s;e.iGM(s=e.CRH())&&(t.objectNameDropdown=s.first),e.iGM(s=e.CRH())&&(t.objectTypeDropdown=s.first),e.iGM(s=e.CRH())&&(t.from=s.first),e.iGM(s=e.CRH())&&(t.ccInput=s.first),e.iGM(s=e.CRH())&&(t.subject=s.first)}},features:[e._Bn([O,C.s])],decls:57,vars:41,consts:[[1,"container-fluid"],[1,"forms-wrapper"],[1,"row","g-0"],[1,"col-md-12"],[1,"card","bdt-0"],["id","stickyHeaderID",1,"card-header","card-header-primary"],[1,"subpage-header-title","w-100",3,"pageName","pageTitle","showPageHeaderItems","showDependencySubMenu"],[1,"card-body"],[1,"row","form-bs"],[1,"col-md-4"],["mandatory","true","disabled","true","id","attributedefinitions-edit-enterprise",3,"label","value"],["mandatory","true","id","evens-create-country",3,"label","options","defaultValue","selectedOption","searchValueChange"],["objectTypeDropdown",""],["objectNameDropdown",""],["label","From","mandatory","true","disabled","true","id","email-create",3,"value"],["from",""],["type","email","label","CC","mandatory","false","disabled","false",3,"value","valueChange"],["ccInput",""],["label","Subject","mandatory","true","disabled","false",3,"value","valueChange"],["subject",""],[1,"col-md-12","pdt-14"],[1,"fs-12"],[3,"ngModel","config","ngModelChange"],[1,"col-md-12","text-end","mt-2"],["className","btn btn-primary btn-sm","id","notification-create-submit",1,"mgr-5",3,"label","buttonOnClick"],["className","btn btn-danger btn-sm","id","notification-create-cancle",3,"label","buttonOnClick"],[1,"text-danger","text-center"],[1,"card"],["id","extraPaddingBottomID",1,"card-content"],[3,"multiple"],[3,"selected"],[1,"d-flex","justify-content-between","w-100","accordion-header"],[1,"position-relative"],["type","file","id","excelfile","name","file-input",1,"form-control",3,"change"],["id","importFile","for","customFile",1,"custom-file-label"],["class","col-md-12",4,"ngIf"],[1,"card-header"],[4,"ngFor","ngForOf"],[3,"href"]],template:function(i,t){1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5),e._UZ(6,"app-pageheader",6),e.qZA(),e.TgZ(7,"div",7)(8,"div",8)(9,"div",9),e._UZ(10,"app-input",10),e.ALo(11,"translate"),e.qZA(),e.TgZ(12,"div",9)(13,"app-dropdown-search",11,12),e.NdJ("selectedOption",function(n){return t.changeObjectTypes(n)})("searchValueChange",function(n){return t.getObjectTypeList(n)}),e.ALo(15,"translate"),e.qZA()(),e.TgZ(16,"div",9)(17,"app-dropdown-search",11,13),e.NdJ("selectedOption",function(n){return t.changeObjectName(n)})("searchValueChange",function(n){return t.getObjectNameList(n)}),e.ALo(19,"translate"),e.qZA()(),e.TgZ(20,"div",3),e._UZ(21,"app-input",14,15),e.qZA(),e.TgZ(23,"div",3)(24,"app-input",16,17),e.NdJ("valueChange",function(n){return t.changeCC(n)}),e.qZA()(),e.TgZ(26,"div",3)(27,"app-input",18,19),e.NdJ("valueChange",function(n){return t.changeSubject(n)}),e.qZA()(),e.TgZ(29,"div",20)(30,"ion-label",21),e._uU(31,"Message*"),e.qZA(),e.TgZ(32,"angular-editor",22),e.NdJ("ngModelChange",function(n){return t.ckeitor_message=n}),e.qZA()(),e.TgZ(33,"div",23)(34,"app-button",24),e.NdJ("buttonOnClick",function(){return t.createRecord("PUBLISH")}),e.ALo(35,"translate"),e.qZA(),e.TgZ(36,"app-button",24),e.NdJ("buttonOnClick",function(){return t.createRecord("DRAFT")}),e.ALo(37,"translate"),e.qZA(),e.TgZ(38,"app-button",25),e.NdJ("buttonOnClick",function(){return t.cancelButton()}),e.ALo(39,"translate"),e.qZA()()(),e.TgZ(40,"div",26),e._uU(41),e.ALo(42,"translate"),e.qZA()()()(),e.TgZ(43,"div",3)(44,"div",27)(45,"div",28)(46,"p-accordion",29)(47,"p-accordionTab",30)(48,"p-header",31)(49,"span"),e._uU(50),e.ALo(51,"translate"),e.qZA()(),e.TgZ(52,"div",9)(53,"div",32)(54,"input",33),e.NdJ("change",function(n){return t.selectFiles(n)}),e.qZA(),e._UZ(55,"label",34),e.qZA()(),e.YNc(56,le,4,1,"div",35),e.qZA()()()()()()()()),2&i&&(e.xp6(6),e.Q6J("pageName",t.dataJsonObj.pageName)("pageTitle",t.dataJsonObj.pageTitle)("showPageHeaderItems",!1)("showDependencySubMenu",!1),e.xp6(4),e.s9C("label",e.lcZ(11,25,"COMMON_PAGE_TITLES.ENTERPRISE")),e.s9C("value",t.enterpriseShortName),e.xp6(3),e.s9C("label",e.lcZ(15,27,"COMMON_FIELDS.OBJECT_TYPE")),e.s9C("defaultValue",t.defaultObjectType),e.Q6J("options",t.objectTypeOptions),e.xp6(4),e.s9C("label",e.lcZ(19,29,"COMMON_FIELDS.OBJECT_NAME")),e.s9C("defaultValue",t.defaultObjectName),e.Q6J("options",t.objectNameOptions),e.xp6(4),e.s9C("value",t.defaultFrom),e.xp6(3),e.s9C("value",t.defaultCC),e.xp6(3),e.s9C("value",t.defaultSubject),e.xp6(5),e.Q6J("ngModel",t.ckeitor_message)("config",t.editorConfig),e.xp6(2),e.s9C("label",e.lcZ(35,31,"COMMON_BUTTONS.BUTTON_PUBLISH")),e.xp6(2),e.s9C("label",e.lcZ(37,33,"POSTS.POST_DRAFT")),e.xp6(2),e.s9C("label",e.lcZ(39,35,"COMMON_BUTTONS.BUTTON_CANCEL")),e.xp6(3),e.hij(" ",e.lcZ(42,37,t.error)," "),e.xp6(5),e.Q6J("multiple",!0),e.xp6(1),e.Q6J("selected",!0),e.xp6(3),e.Oqu(e.lcZ(51,39,"ATTACHMENTS.ATTACHMENTS")),e.xp6(6),e.Q6J("ngIf",t.selectedFiles.length>0))},dependencies:[T.sg,T.O5,f.JJ,f.On,J.h4,v.UQ,v.US,U.r,w.a,ee.C,A.q,N.s6,S.X$]})}return l})();class ce{enterprise;object;email_message;from;type;cc;subject;email_status}var q=o(11735);function de(l,p){if(1&l&&e._UZ(0,"app-pageheader",28),2&l){const a=e.oxw();e.Q6J("pageName",a.dataJsonObj.pageName)("pageTitle",a.dataJsonObj.pageTitle)("selectedMenuId",null==a.dataJsonObj.queryParamsObj?null:a.dataJsonObj.queryParamsObj.selectedMenuId)("selectedSubMenuId",null==a.dataJsonObj.queryParamsObj?null:a.dataJsonObj.queryParamsObj.selectedSubMenuId)("showPageHeaderItems",!1)("showDependencySubMenu",!0)("isEditActionEnable",a.dataJsonObj.isEditAction)}}function ue(l,p){if(1&l&&(e.TgZ(0,"ul")(1,"li")(2,"a",32),e._uU(3),e.qZA()()()),2&l){const a=p.$implicit;e.xp6(2),e.s9C("href",a.name,e.LSH),e.xp6(1),e.Oqu(a.name)}}function me(l,p){if(1&l&&(e.TgZ(0,"div",29)(1,"div",30),e._uU(2,"List of Files"),e.qZA(),e.YNc(3,ue,4,2,"ul",31),e.qZA()),2&l){const a=e.oxw();e.xp6(3),e.Q6J("ngForOf",a.selectedFiles)}}let he=(()=>{class l extends D.O{commonService;emailService;toastController;uiUtils;activatedRoute;router;loggerService;route;translateService;navigationService;ckeitor_message;createdBy;creationDate;emailData;isEnabled;lastUpdatedBy;lastUpdatedDate;recordId;selectedFiles=[];editorConfig={editable:!1,spellcheck:!0,height:"15rem",minHeight:"5rem",maxHeight:"auto",width:"auto",minWidth:"0",translate:"yes",enableToolbar:!1,showToolbar:!1,placeholder:"Enter text here...",defaultParagraphSeparator:"",defaultFontName:"",defaultFontSize:"",fonts:[{class:"arial",name:"Arial"},{class:"times-new-roman",name:"Times New Roman"},{class:"calibri",name:"Calibri"},{class:"comic-sans-ms",name:"Comic Sans MS"}],customClasses:[{name:"quote",class:"quote"},{name:"redText",class:"redText"},{name:"titleText",class:"titleText",tag:"h1"}],uploadUrl:"v1/image",uploadWithCredentials:!1,sanitize:!0,toolbarPosition:"top",toolbarHiddenButtons:[["justifyLeft","justifyCenter","justifyRight","justifyFull","indent","outdent"],["customClasses","link","unlink","insertImage","insertVideo","removeFormat","backgroundColor"]]};dataJsonObj={};constructor(a,i,t,s,n,c,m,u,h,g){super(u,a),this.commonService=a,this.emailService=i,this.toastController=t,this.uiUtils=s,this.activatedRoute=n,this.router=c,this.loggerService=m,this.route=u,this.translateService=h,this.navigationService=g,this.activatedRoute.params.subscribe(b=>{this.recordId=b.id}),this.activatedRoute.queryParams.subscribe(b=>{this.dataJsonObj.queryParamsObj={defaultView:b.defaultView,selectedMenuId:b.selectedMenuId,selectedSubMenuId:b.selectedSubMenuId}})}ngOnInit(){document.getElementsByTagName("body"),this.initializeComponent()}initializeComponent(){this.dataJsonObj.pageName=r.hf.EMAILS,this.commonService.trackView(r.sn.NOTIFICATION_CREATE),this.getRecordById(),this.dataJsonObj.showrecordhistory=this.roleRightsValidationByPage(r.hf.EMAILS,r.AM.ACTIONS,r.In.RECORD_HISTORY),this.dataJsonObj.enterpriseData=JSON.parse(localStorage.getItem(r.BU.ENTERPRISE)),this.dataJsonObj.enterpriseId=this.dataJsonObj.enterpriseData.enterprise_id,this.dataJsonObj.selectedPage=r.hf.EMAILS,this.getDynamicJson([{folderName:"menu_manager",jsonType:"",storingFieldName:"menuDataJson"}])}getDynamicJson(a){var i=this;return(0,I.Z)(function*(){for(let t of a)i.dataJsonObj[t.storingFieldName]=yield i.commonService.getDynamicJson(i.dataJsonObj.enterpriseId,t.folderName,t.jsonType);i.dataJsonObj.selectedObj={},i.dataJsonObj.selectedObj.recordId=i.recordId,i.dataJsonObj.selectedObj.pageObj=i.dataJsonObj.menuDataJson.filter(t=>t.menu_page.page_name===i.dataJsonObj.selectedPage),i.dataJsonObj.selectedObjEnabled=!0})()}getRecordById(){try{this.emailService.get(this.recordId).subscribe(a=>{this.emailData=a,this.dataJsonObj.isEditAction=this.getIsEditAction(this.emailData),this.ckeitor_message=a.email_message,this.isEnabled=this.emailData.is_enabled,this.createdBy=this.emailData.created_by,this.dataJsonObj.pageTitle=[{key:"COMMON_PAGE_TITLES.EMAILS",value:"",showSubMenuDisplayName:!1},{key:"",value:"-",showSubMenuDisplayName:!1},{key:"COMMON_BUTTONS.BUTTON_VIEW",value:"",showSubMenuDisplayName:!1}],this.lastUpdatedBy=this.emailData.updated_by},a=>{this.loggerService.setLoggerError(this.constructor.name,"getRecordById",a)})}catch(a){this.loggerService.setLoggerError(this.constructor.name,"getRecordById",a)}}getIsEditAction(a){return"DRAFT"===a.email_status.lookup_name}cancelButton(){this.commonService.redirectToPreviousUrl()}static \u0275fac=function(i){return new(i||l)(e.Y36(E.v),e.Y36(O),e.Y36(_.yF),e.Y36(C.s),e.Y36(d.gz),e.Y36(d.F0),e.Y36(j.m),e.Y36(d.gz),e.Y36(S.sK),e.Y36(L.f))};static \u0275cmp=e.Xpm({type:l,selectors:[["app-email-view"]],features:[e._Bn([O,C.s]),e.qOj],decls:41,vars:29,consts:[[1,"container-fluid"],[1,"forms-wrapper"],[1,"row","g-0"],[1,"col-md-12"],[1,"card","bdt-0"],["id","stickyHeaderID",1,"card-header","card-header-primary"],["class","subpage-header-title w-100",3,"pageName","pageTitle","selectedMenuId","selectedSubMenuId","showPageHeaderItems","showDependencySubMenu","isEditActionEnable",4,"ngIf"],[1,"card-body"],[1,"row","form-bs"],[1,"col-md-4"],["mandatory","true","disabled","true","id","email-view-enterprise",3,"label","value"],["label","Object Type","mandatory","true","disabled","true","id","email-view-objectType",3,"value"],["mandatory","true","disabled","true","id","email-view-objectname",3,"label","value"],["label","From","mandatory","true","disabled","true","id","email-view-from",3,"value"],["label","Cc","mandatory","true","disabled","true","id","email-view-cc",3,"value"],["label","Subject","mandatory","true","disabled","true","id","email-view-subject",3,"value"],[1,"col-md-12","pdt-14"],[1,"fs-12"],["ng-disabled","true",3,"ngModel","config","ngModelChange"],[1,"col-md-12","text-end","mt-2"],["className","btn btn-danger btn-sm","id","notification-create-cancle",3,"label","buttonOnClick"],[1,"card"],["id","extraPaddingBottomID",1,"card-content"],[3,"multiple"],[3,"selected"],[1,"d-flex","justify-content-between","w-100","accordion-header"],["class","col-md-8",4,"ngIf"],[3,"createdBy","lastUpdatedBy","showrecordhistory","creationDate","lastUpdatedDate"],[1,"subpage-header-title","w-100",3,"pageName","pageTitle","selectedMenuId","selectedSubMenuId","showPageHeaderItems","showDependencySubMenu","isEditActionEnable"],[1,"col-md-8"],[1,"card-header"],[4,"ngFor","ngForOf"],[3,"href"]],template:function(i,t){1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5),e.YNc(6,de,1,7,"app-pageheader",6),e.qZA(),e.TgZ(7,"div",7)(8,"div",8)(9,"div",9),e._UZ(10,"app-input",10),e.ALo(11,"translate"),e.qZA(),e.TgZ(12,"div",9),e._UZ(13,"app-input",11),e.qZA(),e.TgZ(14,"div",9),e._UZ(15,"app-input",12),e.ALo(16,"translate"),e.qZA(),e.TgZ(17,"div",3),e._UZ(18,"app-input",13),e.qZA(),e.TgZ(19,"div",3),e._UZ(20,"app-input",14),e.qZA(),e.TgZ(21,"div",3),e._UZ(22,"app-input",15),e.qZA(),e.TgZ(23,"div",16)(24,"ion-label",17),e._uU(25,"Message*"),e.qZA(),e.TgZ(26,"angular-editor",18),e.NdJ("ngModelChange",function(n){return t.ckeitor_message=n}),e.qZA()(),e.TgZ(27,"div",19)(28,"app-button",20),e.NdJ("buttonOnClick",function(){return t.cancelButton()}),e.ALo(29,"translate"),e.qZA()()()()()(),e.TgZ(30,"div",3)(31,"div",21)(32,"div",22)(33,"p-accordion",23)(34,"p-accordionTab",24)(35,"p-header",25)(36,"span"),e._uU(37),e.ALo(38,"translate"),e.qZA()(),e.YNc(39,me,4,1,"div",26),e.qZA(),e._UZ(40,"app-recordhistory",27),e.qZA()()()()()()()),2&i&&(e.xp6(6),e.Q6J("ngIf",t.emailData),e.xp6(4),e.s9C("label",e.lcZ(11,21,"COMMON_PAGE_TITLES.ENTERPRISE")),e.s9C("value",null==t.emailData||null==t.emailData.enterprise?null:t.emailData.enterprise.short_name),e.xp6(3),e.s9C("value",null==t.emailData||null==t.emailData.object||null==t.emailData.object.object_type?null:t.emailData.object.object_type.page_display_name),e.xp6(2),e.s9C("label",e.lcZ(16,23,"COMMON_FIELDS.OBJECT_NAME")),e.s9C("value",null==t.emailData||null==t.emailData.object?null:t.emailData.object.object_name),e.xp6(3),e.s9C("value",null==t.emailData?null:t.emailData.from),e.xp6(2),e.s9C("value",null==t.emailData?null:t.emailData.cc),e.xp6(2),e.s9C("value",null==t.emailData?null:t.emailData.subject),e.xp6(4),e.Q6J("ngModel",t.ckeitor_message)("config",t.editorConfig),e.xp6(2),e.s9C("label",e.lcZ(29,25,"COMMON_BUTTONS.BUTTON_CLOSE")),e.xp6(5),e.Q6J("multiple",!0),e.xp6(1),e.Q6J("selected",!0),e.xp6(3),e.Oqu(e.lcZ(38,27,"ATTACHMENTS.ATTACHMENTS")),e.xp6(2),e.Q6J("ngIf",t.selectedFiles.length>0),e.xp6(1),e.Q6J("createdBy",t.createdBy)("lastUpdatedBy",t.lastUpdatedBy)("showrecordhistory",t.dataJsonObj.showrecordhistory)("creationDate",null==t.emailData?null:t.emailData.createdAt)("lastUpdatedDate",null==t.emailData?null:t.emailData.updatedAt))},dependencies:[T.sg,T.O5,f.JJ,f.On,J.h4,v.UQ,v.US,U.r,w.a,q.W,A.q,N.s6,S.X$]})}return l})();const pe=["ccinput"],ge=["subjectvalidation"];function be(l,p){if(1&l&&(e.TgZ(0,"ul")(1,"li")(2,"a",38),e._uU(3),e.qZA()()()),2&l){const a=p.$implicit;e.xp6(2),e.s9C("href",a.name,e.LSH),e.xp6(1),e.Oqu(a.name)}}function fe(l,p){if(1&l&&(e.TgZ(0,"div",35)(1,"div",36),e._uU(2,"List of Files"),e.qZA(),e.YNc(3,be,4,2,"ul",37),e.qZA()),2&l){const a=e.oxw();e.xp6(3),e.Q6J("ngForOf",a.selectedFiles)}}let Se=(()=>{class l extends D.O{emailService;commonService;activatedRoute;router;loggerService;navigationService;translateService;route;uiUtils;ccinput;subjectvalidation;ckeitor_message;createdBy;creationDate;defaultCC;defaultFrom;defaultSubject;emailData;emailEditObj=new Oe;emailObject;error;lastUpdatedBy;lastUpdatedDate;published;recordId;subject;selectedFiles=[];file;editorConfig={editable:!0,spellcheck:!0,height:"15rem",minHeight:"5rem",maxHeight:"auto",width:"auto",minWidth:"0",translate:"yes",enableToolbar:!0,showToolbar:!0,placeholder:"Enter text here...",defaultParagraphSeparator:"",defaultFontName:"",defaultFontSize:"",fonts:[{class:"arial",name:"Arial"},{class:"times-new-roman",name:"Times New Roman"},{class:"calibri",name:"Calibri"},{class:"comic-sans-ms",name:"Comic Sans MS"}],customClasses:[{name:"quote",class:"quote"},{name:"redText",class:"redText"},{name:"titleText",class:"titleText",tag:"h1"}],uploadUrl:"v1/image",uploadWithCredentials:!1,sanitize:!0,toolbarPosition:"top",toolbarHiddenButtons:[["justifyLeft","justifyCenter","justifyRight","justifyFull","indent","outdent"],["customClasses","link","unlink","insertImage","insertVideo","removeFormat","backgroundColor"]]};dataJsonObj={};constructor(a,i,t,s,n,c,m,u,h){super(u,i),this.emailService=a,this.commonService=i,this.activatedRoute=t,this.router=s,this.loggerService=n,this.navigationService=c,this.translateService=m,this.route=u,this.uiUtils=h,this.activatedRoute.params.subscribe(g=>{this.recordId=g.id})}ngOnInit(){document.getElementsByTagName("body"),this.initializeComponent()}initializeComponent(){this.dataJsonObj.pageName=r.hf.EMAILS,this.getRecordById(),this.dataJsonObj.showrecordhistory=this.roleRightsValidationByPage(r.hf.EMAILS,r.AM.ACTIONS,r.In.RECORD_HISTORY)}getRecordById(){try{this.emailService.get(this.recordId).subscribe(a=>{this.emailData=a,this.emailObject=a.object,this.defaultFrom=a.from,this.defaultCC=a.cc,this.defaultSubject=a.subject,this.ckeitor_message=a.email_message,this.createdBy=this.emailData.created_by,this.dataJsonObj.pageTitle=[{key:"COMMON_PAGE_TITLES.EMAILS",value:this.defaultSubject,showSubMenuDisplayName:!1},{key:"",value:"-",showSubMenuDisplayName:!1},{key:"COMMON_BUTTONS.BUTTON_EDIT",value:"",showSubMenuDisplayName:!1}],this.lastUpdatedBy=this.emailData.updated_by},a=>{this.loggerService.setLoggerError(this.constructor.name,"getRecordById",a)})}catch(a){this.loggerService.setLoggerError(this.constructor.name,"getRecordById",a)}}changeEmailCc(a){try{this.defaultCC=a.value}catch(i){this.loggerService.setLoggerError(this.constructor.name,"changeEmailCc",i)}}changeSubject(a){try{this.defaultSubject=a.value}catch(i){this.loggerService.setLoggerError(this.constructor.name,"changeSubject",i)}}cancelButton(){this.commonService.redirectToPreviousUrl()}updateRecord(a){try{if((!this.defaultCC||this.ccinput.isValid())&&this.subjectvalidation.isValid()){this.emailEditObj.enterprise=this.emailData.enterprise;const i=this.emailObject;this.emailEditObj.email_message=this.ckeitor_message,this.emailEditObj.object=i,this.emailEditObj.from=this.defaultFrom,this.emailEditObj.cc=this.defaultCC,this.emailEditObj.subject=this.defaultSubject,this.emailEditObj.type=a,this.emailService.update(this.emailEditObj,this.recordId).then(t=>{this.uiUtils.displaytoastMessage("COMMON_TOAST_MESSAGES.TOAST_SUCCESS_EDIT"),this.commonService.redirectToPreviousUrl()},t=>{})}}catch(i){this.loggerService.setLoggerError(this.constructor.name,"updateRecord",i)}}selectFiles(a){if(a){const i=a.target.files;document.getElementById("importFile"),this.file=i[0],this.selectedFiles.push(this.file)}}commonErrorCodes(a){409===JSON.parse(a[r.BU.STATUS])&&(this.error=this.translateService.instant("LOOKUPS.LOOKUPS_UNIQUENESS"))}static \u0275fac=function(i){return new(i||l)(e.Y36(O),e.Y36(E.v),e.Y36(d.gz),e.Y36(d.F0),e.Y36(j.m),e.Y36(L.f),e.Y36(S.sK),e.Y36(d.gz),e.Y36(C.s))};static \u0275cmp=e.Xpm({type:l,selectors:[["app-email-edit"]],viewQuery:function(i,t){if(1&i&&(e.Gf(pe,5),e.Gf(ge,5)),2&i){let s;e.iGM(s=e.CRH())&&(t.ccinput=s.first),e.iGM(s=e.CRH())&&(t.subjectvalidation=s.first)}},features:[e._Bn([O,C.s]),e.qOj],decls:54,vars:41,consts:[[1,"container-fluid"],[1,"forms-wrapper"],[1,"row","g-0"],[1,"col-md-12"],[1,"card","bdt-0"],["id","stickyHeaderID",1,"card-header","card-header-primary"],[1,"subpage-header-title","w-100",3,"pageName","pageTitle","showPageHeaderItems","showDependencySubMenu"],[1,"card-body"],[1,"row","form-bs"],[1,"col-md-4"],["mandatory","true","disabled","true","id","email-edit-enterprise",3,"label","value"],["label","Object Type","mandatory","true","disabled","true","id","email-edit-objectType",3,"value"],["mandatory","true","disabled","true","id","email-edit-objectName",3,"label","value"],["label","From","mandatory","true","disabled","true","id","email-edit-from",3,"value"],["type","email","label","Cc","mandatory","false","disabled","false","id","email-edit-cc",3,"value","valueChange"],["ccinput",""],["label","Subject","mandatory","true","disabled","false","id","email-edit-subject",3,"value","valueChange"],["subjectvalidation",""],[1,"col-md-12","pdt-14"],[1,"fs-12"],[3,"ngModel","config","ngModelChange"],[1,"col-md-12","text-end","mt-2"],["className","btn btn-primary btn-sm","id","notification-create-submit",1,"mgr-5",3,"label","buttonOnClick"],["className","btn btn-danger btn-sm","id","notification-create-cancle",3,"label","buttonOnClick"],[1,"text-danger","text-center"],[1,"card"],["id","extraPaddingBottomID",1,"card-content"],[3,"multiple"],[3,"selected"],[1,"d-flex","justify-content-between","w-100","accordion-header"],[1,"position-relative"],["type","file","id","excelfile","name","file-input",1,"form-control",3,"change"],["id","importFile","for","customFile",1,"custom-file-label"],["class","col-md-8",4,"ngIf"],[3,"createdBy","lastUpdatedBy","showrecordhistory","creationDate","lastUpdatedDate"],[1,"col-md-8"],[1,"card-header"],[4,"ngFor","ngForOf"],[3,"href"]],template:function(i,t){1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5),e._UZ(6,"app-pageheader",6),e.qZA(),e.TgZ(7,"div",7)(8,"div",8)(9,"div",9),e._UZ(10,"app-input",10),e.ALo(11,"translate"),e.qZA(),e.TgZ(12,"div",9),e._UZ(13,"app-input",11),e.qZA(),e.TgZ(14,"div",9),e._UZ(15,"app-input",12),e.ALo(16,"translate"),e.qZA(),e.TgZ(17,"div",3),e._UZ(18,"app-input",13),e.qZA(),e.TgZ(19,"div",3)(20,"app-input",14,15),e.NdJ("valueChange",function(n){return t.changeEmailCc(n)}),e.qZA()(),e.TgZ(22,"div",3)(23,"app-input",16,17),e.NdJ("valueChange",function(n){return t.changeSubject(n)}),e.qZA()(),e.TgZ(25,"div",18)(26,"ion-label",19),e._uU(27,"Message*"),e.qZA(),e.TgZ(28,"angular-editor",20),e.NdJ("ngModelChange",function(n){return t.ckeitor_message=n}),e.qZA()(),e.TgZ(29,"div",21)(30,"app-button",22),e.NdJ("buttonOnClick",function(){return t.updateRecord("PUBLISH")}),e.ALo(31,"translate"),e.qZA(),e.TgZ(32,"app-button",22),e.NdJ("buttonOnClick",function(){return t.updateRecord("DRAFT")}),e.ALo(33,"translate"),e.qZA(),e.TgZ(34,"app-button",23),e.NdJ("buttonOnClick",function(){return t.cancelButton()}),e.ALo(35,"translate"),e.qZA()()(),e.TgZ(36,"div",24),e._uU(37),e.ALo(38,"translate"),e.qZA()()()(),e.TgZ(39,"div",3)(40,"div",25)(41,"div",26)(42,"p-accordion",27)(43,"p-accordionTab",28)(44,"p-header",29)(45,"span"),e._uU(46),e.ALo(47,"translate"),e.qZA()(),e.TgZ(48,"div",9)(49,"div",30)(50,"input",31),e.NdJ("change",function(n){return t.selectFiles(n)}),e.qZA(),e._UZ(51,"label",32),e.qZA()(),e.YNc(52,fe,4,1,"div",33),e.qZA(),e._UZ(53,"app-recordhistory",34),e.qZA()()()()()()()),2&i&&(e.xp6(6),e.Q6J("pageName",t.dataJsonObj.pageName)("pageTitle",t.dataJsonObj.pageTitle)("showPageHeaderItems",!1)("showDependencySubMenu",!1),e.xp6(4),e.s9C("label",e.lcZ(11,27,"COMMON_PAGE_TITLES.ENTERPRISE")),e.s9C("value",null==t.emailData||null==t.emailData.enterprise?null:t.emailData.enterprise.short_name),e.xp6(3),e.s9C("value",null==t.emailData||null==t.emailData.object||null==t.emailData.object.object_type?null:t.emailData.object.object_type.page_display_name),e.xp6(2),e.s9C("label",e.lcZ(16,29,"COMMON_FIELDS.OBJECT_NAME")),e.s9C("value",null==t.emailData||null==t.emailData.object?null:t.emailData.object.object_name),e.xp6(3),e.s9C("value",null==t.emailData?null:t.emailData.from),e.xp6(2),e.s9C("value",t.defaultCC),e.xp6(3),e.s9C("value",t.defaultSubject),e.xp6(5),e.Q6J("ngModel",t.ckeitor_message)("config",t.editorConfig),e.xp6(2),e.s9C("label",e.lcZ(31,31,"COMMON_BUTTONS.BUTTON_PUBLISH")),e.xp6(2),e.s9C("label",e.lcZ(33,33,"POSTS.POST_DRAFT")),e.xp6(2),e.s9C("label",e.lcZ(35,35,"COMMON_BUTTONS.BUTTON_CANCEL")),e.xp6(3),e.hij(" ",e.lcZ(38,37,t.error)," "),e.xp6(5),e.Q6J("multiple",!0),e.xp6(1),e.Q6J("selected",!0),e.xp6(3),e.Oqu(e.lcZ(47,39,"ATTACHMENTS.ATTACHMENTS")),e.xp6(6),e.Q6J("ngIf",t.selectedFiles.length>0),e.xp6(1),e.Q6J("createdBy",t.createdBy)("lastUpdatedBy",t.lastUpdatedBy)("showrecordhistory",t.dataJsonObj.showrecordhistory)("creationDate",null==t.emailData?null:t.emailData.createdAt)("lastUpdatedDate",null==t.emailData?null:t.emailData.updatedAt))},dependencies:[T.sg,T.O5,f.JJ,f.On,J.h4,v.UQ,v.US,U.r,w.a,q.W,A.q,N.s6,S.X$]})}return l})();class Oe{enterprise;object;email_message;from;cc;type;subject;email_status}var M=o(11210);const Ce=[{path:"",data:{title:"Emails"},children:[{path:"list",canActivate:[M.P],component:X,data:{responsibilityParam:r.bP.MENUS+"."+r.w1.PROFILE_MENU+"."+r.bP.SUBMENUS+"."+r.w1.EMAILS+"."+r.In.ENABLED,pageName:r.hf.EMAILS}},{path:"create",canActivate:[M.P],component:oe,data:{responsibilityParam:r.bP.MENUS+"."+r.w1.PROFILE_MENU+"."+r.bP.SUBMENUS+"."+r.w1.EMAILS+"."+r.In.CREATE,pageName:r.hf.EMAILS,pageSetting:r.AM.ACTIONS,settingField:r.In.CREATE}},{path:":id/view",canActivate:[M.P],component:he,data:{responsibilityParam:r.bP.MENUS+"."+r.w1.PROFILE_MENU+"."+r.bP.SUBMENUS+"."+r.w1.EMAILS+"."+r.In.VIEW,pageName:r.hf.EMAILS,pageSetting:r.AM.ACTIONS,settingField:r.In.VIEW}},{path:":id/edit",canActivate:[M.P],component:Se,data:{responsibilityParam:r.bP.MENUS+"."+r.w1.PROFILE_MENU+"."+r.bP.SUBMENUS+"."+r.w1.EMAILS+"."+r.In.EDIT,pageName:r.hf.EMAILS,pageSetting:r.AM.ACTIONS,settingField:r.In.EDIT}}]}];let Te=(()=>{class l{static \u0275fac=function(i){return new(i||l)};static \u0275mod=e.oAB({type:l});static \u0275inj=e.cJS({imports:[d.Bz.forChild(Ce),d.Bz]})}return l})();var ve=o(32137),ye=o(10841),Ee=o(3848);let je=(()=>{class l{static \u0275fac=function(i){return new(i||l)};static \u0275mod=e.oAB({type:l});static \u0275inj=e.cJS({imports:[T.ez,S.aw,f.u5,f.UX,Y.U$,v.fx,H.Q,ve.D,Te,ye.ii,Ee.Nh,V.JF,N.UM]})}return l})()}}]);