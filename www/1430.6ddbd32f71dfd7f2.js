"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1430],{41430:(j,g,n)=>{n.r(g),n.d(g,{ChangepasswordModule:()=>J});var v=n(36895),h=n(24006),w=n(65673),f=n(93144),p=n(54463),d=n(62510),C=n(75875),r=n(32236),e=n(94650),O=n(80529);let m=(()=>{class o{http;authService;userToken=localStorage.getItem(r.BU.TOKEN);constructor(t,a){this.http=t,this.authService=a}resetpassword(t,a,s){return new Promise((i,l)=>{this.authService.patchApiCall("api/v1/users/"+t+"?action=ChangePassword&enterprise_id="+s,a).subscribe(c=>{i(c)},c=>{l(c)})})}static \u0275fac=function(a){return new(a||o)(e.LFG(O.eN),e.LFG(C.e))};static \u0275prov=e.Yz7({token:o,factory:o.\u0275fac})}return o})();var I=n(42786),u=n(30294),S=n(46560),E=n(71568),P=n(46448),N=n(30958),y=n(93795),A=n(2387),U=n(56368),M=n(37415);const R=["confirmPasswordInput"],T=["passwordInput"];let _=(()=>{class o{changePasswordService;router;navigationService;route;loggerService;loginService;generalSettings;commonService;platform;deviceService;translateService;confirmPasswordInput;passwordInput;changeApiEndPoint;confirmPassword;enterpriseName;error;dataJsonObj={};password;passwordIcon="fa-eye-slash";passwordType="password";reset=[];userId;userName;instance;landingPageUrl;constructor(t,a,s,i,l,c,Z,F,G,W,V){this.changePasswordService=t,this.router=a,this.navigationService=s,this.route=i,this.loggerService=l,this.loginService=c,this.generalSettings=Z,this.commonService=F,this.platform=G,this.deviceService=W,this.translateService=V}ngOnInit(){this.initializeComponent()}initializeComponent(){this.dataJsonObj.pageName=r.hf.CHANGE_PASSWORD,this.dataJsonObj.pageTitle=[{key:"COMMON_PAGE_TITLES.CHANGE_PASSWORD",value:"",showSubMenuDisplayName:!1}],this.userId=localStorage.getItem(r.BU.USER_ID),this.dataJsonObj.enterpriseId=localStorage.getItem(r.BU.SELECTED_ENTERPRISE),this.enterpriseName=JSON.parse(localStorage.getItem(r.BU.ENTERPRISE)),this.enterpriseName=this.enterpriseName.short_name,this.userName=JSON.parse(localStorage.getItem(r.BU.USER)),this.userName=this.userName.user_account,this.getWorkresourceName()}changePassword(t){this.password=t.value.replace(/\s/g,""),this.error=""}preventSpaces(t){" "===t.key&&t.preventDefault()}changeConfirmPassword(t){this.confirmPassword=t.value.replace(/\s/g,""),this.error=""}getWorkresourceName(){try{this.loginService.getworkresource(localStorage.getItem(r.BU.LOG_IN_USER_ID),localStorage.getItem(r.BU.SELECTED_ENTERPRISE)).then(t=>{t.length>0&&(localStorage.setItem(r.BU.WORK_RESOURCE_NAME,t[0].NAME),localStorage.setItem(r.BU.WORK_RESOURCE_ID,t[0].ID),localStorage.setItem(r.BU.WORK_RESOURCE_ID,t[0].ID),localStorage.setItem(r.BU.WORK_RESOURCE_ROLE,t[0].employment_profiles.employment_role.lookup_name),localStorage.setItem(r.BU.WORK_RESOURCE_DEPT_HEAD,t[0].employment_profiles.department_head?t[0].employment_profiles.department_head.work_resource_id:""),localStorage.setItem(r.BU.WORK_RESOURCE_SUPERVISOR,t[0].employment_profiles.supervisor?t[0].employment_profiles.supervisor.work_resource_id:""))})}catch(t){this.loggerService.setLoggerError(this.constructor.name,"getWorkresourceName",t)}}hideShowPassword(){this.passwordType="text"===this.passwordType?"password":"text",this.passwordIcon="fa-eye-slash"===this.passwordIcon?"fa-eye":"fa-eye-slash"}cancelBtn(){"/login"==this.navigationService.getPreviousPageUrlValue()?this.getgeneralsettingsJson():this.commonService.redirectToPreviousUrl()}validatePassword(){(this.password.length<5||this.password.length>15)&&(this.error=this.translateService.instant("COMMON_VALIDATION_MESSAGES.VALID_CONFIRM_PASSWORD")),this.confirmPassword!==this.password&&(this.error=this.translateService.instant("COMMON_VALIDATION_MESSAGES.VALID_PASSWORD"))}submit(){if(this.reset={newPassword:this.password,confirmnewPassword:this.confirmPassword},this.passwordInput.isValid()&&this.confirmPasswordInput.isValid())if(this.password!==this.confirmPassword)this.error=this.translateService.instant("COMMON_VALIDATION_MESSAGES.VALID_PASSWORD");else if(this.password.length<5||this.password.length>15)this.error=this.translateService.instant("COMMON_VALIDATION_MESSAGES.VALID_CONFIRM_PASSWORD");else if(this.confirmPassword.length<5||this.confirmPassword.length>15)this.error=this.translateService.instant("COMMON_VALIDATION_MESSAGES.VALID_PASSWORD");else try{this.changePasswordService.resetpassword(this.userId,this.reset,this.dataJsonObj.enterpriseId).then(t=>{this.logoutFromChangePassword()},t=>{})}catch(t){this.loggerService.setLoggerError(this.constructor.name,"submit",t)}}logoutFromChangePassword(){let t=this.deviceService.getDeviceInfo();const a=localStorage.getItem(r.BU.USER_ID);let s="Desktop";this.platform.ready().then(()=>{(this.platform.is("android")||this.platform.is("ios"))&&(s="Mobile")});let i={device_type:s,user_agent:window.navigator.userAgent,browser_name:t.browser,ip_address:localStorage.getItem(r.BU.IPADDRESS),browser_version:t.browser_version,OS:t.os,user_id:a};try{this.loginService.getlogoutData(localStorage.getItem(r.BU.LOG_IN_USER_ID),i).then(l=>{},l=>{}),this.commonService.logoutUser()}catch(l){this.loggerService.setLoggerError(this.constructor.name,"logout",l)}}getgeneralsettingsJson(){try{this.commonService.getDefaultSettingsData(localStorage.getItem(r.BU.SELECTED_ENTERPRISE)).then(t=>{this.instance=localStorage.getItem(r.BU.INSTANCE);const s=[r.EJ.DEMO,r.EJ.DSUP,r.EJ.UAT];-1!==[r._y.DEMO_ADMIN,r._y.DEMO_USER].indexOf(this.userName)&&-1!==s.indexOf(this.instance)?(this.landingPageUrl="/industries/industries/list",this.router.navigate([this.landingPageUrl])):t&&t.homeScreen&&t.homeScreen.shortcutFilter&&(t.homeScreen.shortcutFilter.home_screen_path||t.homeScreenMobile.home_screen_path)?this.platform.is("desktop")?(this.landingPageUrl=t.homeScreen.shortcutFilter.home_screen_path,this.router.navigate([this.landingPageUrl])):(this.landingPageUrl=t.homeScreenMobile.home_screen_path,this.router.navigate([this.landingPageUrl])):(this.landingPageUrl="/posts/posts/list",this.router.navigate([this.landingPageUrl]))},t=>{this.landingPageUrl="/posts/posts/list",this.router.navigate([this.landingPageUrl])})}catch(t){this.loggerService.setLoggerError(this.constructor.name,"getgeneralsettingsJson",t)}}ngAfterContentInit(){this.commonService.showHeaderFooter()}static \u0275fac=function(a){return new(a||o)(e.Y36(m),e.Y36(d.F0),e.Y36(P.f),e.Y36(d.gz),e.Y36(I.m),e.Y36(u.r),e.Y36(S.G),e.Y36(E.v),e.Y36(N.t4),e.Y36(y.x0),e.Y36(p.sK))};static \u0275cmp=e.Xpm({type:o,selectors:[["app-changepassword"]],viewQuery:function(a,s){if(1&a&&(e.Gf(R,5),e.Gf(T,5)),2&a){let i;e.iGM(i=e.CRH())&&(s.confirmPasswordInput=i.first),e.iGM(i=e.CRH())&&(s.passwordInput=i.first)}},features:[e._Bn([m,u.r,S.G])],decls:36,vars:34,consts:[[1,"container-fluid"],[1,"forms-wrapper"],[1,"row","g-0"],[1,"col-md-12"],[1,"card","bdt-0"],["id","stickyHeaderID",1,"card-header","card-header-primary"],[1,"subpage-header-title","w-100",3,"pageName","pageTitle","showPageHeaderItems","showDependencySubMenu"],[1,"card-body"],[1,"register-wrapper"],[1,"register-fields-wrapper","w-100"],[1,"register-container","pd-0"],[1,"card","bd-0","mgt-10"],[1,"card-body","p-3","pdb-10"],[1,"row","form-bs"],["disabled","true","id","changepassword-username",3,"label","value"],[1,"password-field"],["autoCaseFlag","false","autocomplete","new-password","mandatory","true","disabled","false",3,"type","label","minlength","maxlength","value","valueChange","keydown"],["passwordInput",""],["autoCaseFlag","false","mandatory","true","disabled","false",3,"type","label","minlength","maxlength","value","valueChange","keydown","input"],["confirmPasswordInput",""],[3,"click"],[1,"error-msg","col-md-12","text-danger","text-center","mb-0"],[1,"col-md-12","text-end","mt-2"],["id","submit","className","btn btn-primary btn-sm",1,"mgr-5",3,"label","buttonOnClick"],["id","cancel","className","btn btn-danger btn-sm",3,"label","buttonOnClick"]],template:function(a,s){1&a&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5),e._UZ(6,"app-pageheader",6),e.qZA(),e.TgZ(7,"div",7)(8,"div",8)(9,"div",9)(10,"div",10)(11,"div",11)(12,"div",12)(13,"div",13)(14,"div",3),e._UZ(15,"app-input",14),e.ALo(16,"translate"),e.qZA(),e.TgZ(17,"div",3)(18,"div",15)(19,"app-input",16,17),e.NdJ("valueChange",function(l){return s.changePassword(l)})("keydown",function(l){return s.preventSpaces(l)}),e.ALo(21,"translate"),e.qZA()()(),e.TgZ(22,"div",3)(23,"div",15)(24,"app-input",18,19),e.NdJ("valueChange",function(l){return s.changeConfirmPassword(l)})("keydown",function(l){return s.preventSpaces(l)})("input",function(){return s.validatePassword()}),e.ALo(26,"translate"),e.qZA(),e.TgZ(27,"span",20),e.NdJ("click",function(){return s.hideShowPassword()}),e.qZA()()(),e.TgZ(28,"div",21),e._uU(29),e.ALo(30,"translate"),e.qZA(),e.TgZ(31,"div",22)(32,"app-button",23),e.NdJ("buttonOnClick",function(){return s.submit()}),e.ALo(33,"translate"),e.qZA(),e.TgZ(34,"app-button",24),e.NdJ("buttonOnClick",function(){return s.cancelBtn()}),e.ALo(35,"translate"),e.qZA()()()()()()()()()()()()()()),2&a&&(e.xp6(6),e.Q6J("pageName",s.dataJsonObj.pageName)("pageTitle",s.dataJsonObj.pageTitle)("showPageHeaderItems",!1)("showDependencySubMenu",!1),e.xp6(9),e.s9C("label",e.lcZ(16,22,"COMMON_FIELDS.USER_NAME")),e.s9C("value",s.userName),e.xp6(4),e.s9C("type",s.passwordType),e.s9C("label",e.lcZ(21,24,"USERS.PASSWORD")),e.s9C("value",s.password),e.Q6J("minlength",5)("maxlength",15),e.xp6(5),e.s9C("type",s.passwordType),e.s9C("label",e.lcZ(26,26,"USERS.CONFIRM_PASSWORD")),e.s9C("value",s.confirmPassword),e.Q6J("minlength",5)("maxlength",15),e.xp6(3),e.Gre("password-show fas ",s.passwordIcon,""),e.xp6(2),e.hij(" ",e.lcZ(30,28,s.error)," "),e.xp6(3),e.s9C("label",e.lcZ(33,30,"COMMON_BUTTONS.BUTTON_SUBMIT")),e.xp6(2),e.s9C("label",e.lcZ(35,32,"COMMON_BUTTONS.BUTTON_CANCEL")))},dependencies:[A.r,U.a,M.q,p.X$],styles:[".register-wrapper[_ngcontent-%COMP%]{margin:0 auto;width:100%;height:100%;display:flex;justify-content:center}.register-fields-wrapper[_ngcontent-%COMP%]{position:relative;margin:0 auto;height:100%;overflow-y:auto;display:flex;align-items:center;justify-content:center;z-index:1}.register-container[_ngcontent-%COMP%]{height:100%;width:30%;position:relative;z-index:1;display:grid;place-items:center}.register-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{position:relative;padding:0;display:flex;flex-direction:column;align-items:center;animation-name:card;animation-duration:.6s;animation-fill-mode:forwards;border:0px;box-shadow:0 2px 15px -3px #00000012,0 10px 20px -2px #0000000a;border-radius:30px}.register-container[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{background-color:var(--form-bg-color);width:100%;border:1px solid rgba(0,0,0,.125);border-radius:30px}@media (max-width: 430px){.register-container[_ngcontent-%COMP%]{width:96%}}@media only screen and (min-width: 431px) and (max-width: 767px){.register-container[_ngcontent-%COMP%]{width:70%}}@media (min-width: 768px){.register-container[_ngcontent-%COMP%]{width:60%}}@media (min-width: 1200px){.register-container[_ngcontent-%COMP%]{width:30%}}"]})}return o})();const D=[{path:"",canActivate:[n(11210).P],component:_,data:{module:r.w1.MY_PROFILE,pageName:r.hf.CHANGE_PASSWORD}}];let L=(()=>{class o{static \u0275fac=function(a){return new(a||o)};static \u0275mod=e.oAB({type:o});static \u0275inj=e.cJS({imports:[d.Bz.forChild(D),d.Bz]})}return o})();var B=n(32174),x=n(73162);let J=(()=>{class o{static \u0275fac=function(a){return new(a||o)};static \u0275mod=e.oAB({type:o});static \u0275inj=e.cJS({imports:[L,v.ez,p.aw,h.u5,h.UX,f.U$,B.fx,w.Q,x.Cv]})}return o})()}}]);