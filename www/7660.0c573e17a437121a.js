"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7660],{77660:(he,w,d)=>{d.r(w),d.d(w,{FunfactsModule:()=>ce});var H=d(36895),g=d(62510),n=d(32236),v=d(11210),Z=d(15861),Q=d(35226),q=d.n(Q),C=d(42863),S=d(71568),E=d(47561),J=d(28168),y=d(90313),G=d(75875),e=d(94650);let D=(()=>{class c{authService;constructor(a){this.authService=a}getAll(a,s,t,i,r,h,l,u,m,f,p){const T=f||"",z=y.L.isEmpty(p)?"":"&advSearchString="+JSON.stringify(p);return this.authService.getApiCall(!0===l?"api/v1/funfacts?&enterprise.enterprise_id="+a+"&skip="+s+"&limit="+t+"&sort="+i+"&type=list&search="+r+(h?"&"+h+"=true":"")+(u?"&is"+u+"=true":"")+m+z+T:"api/v1/funfacts?&enterprise.enterprise_id="+a+"&skip="+s+"&limit="+t+"&sort="+i+"&type=list&search="+r+m+z+T,!0)}get(a){return this.authService.getApiCall("api/v1/funfacts/"+a,!0)}create(a){return new Promise((s,t)=>{this.authService.postApiCall("api/v1/funfacts/",a).subscribe(i=>{s(i)},i=>{t(i)})})}update(a,s){return new Promise((t,i)=>{this.authService.putApiCall("api/v1/funfacts/"+s,a).subscribe(r=>{t(r)},r=>{i(r)})})}delete(a){return new Promise((s,t)=>{this.authService.deleteApiCall("api/v1/funfacts/"+a).subscribe(i=>{s(i)},i=>{t(i)})})}static \u0275fac=function(s){return new(s||c)(e.LFG(G.e))};static \u0275prov=e.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})();var N=d(30578),M=d(42786),O=d(27601),K=d(70057),b=d(54463),A=d(37415),W=d(88425);const X=["datatableComponent"];let Y=(()=>{class c extends E.O{actionSheetController;columnHeader;commonService;funfactsService;loggerService;router;translateService;uiUtils;listingVariables;route;datatablecomponent;actions;activeObj;datatableComponent;defaultTimeZone;enabledFlag=!1;enterpriseId;fabMobileactions;funfactsListData;funfactsMobileListData;header;isFilterClicked=!1;noDuplicates=void 0;show=!0;searchString;status;userId;value;utcTimeZoneString;mobileroutesArray;dataJsonObj={};set data(a){this.value=a,this.value&&(this.userId=this.value.userId,this.enabledFlag=!0,this.getAllRecords())}constructor(a,s,t,i,r,h,l,u,m,f){super(f,t),this.actionSheetController=a,this.columnHeader=s,this.commonService=t,this.funfactsService=i,this.loggerService=r,this.router=h,this.translateService=l,this.uiUtils=u,this.listingVariables=m,this.route=f,this.route.params.subscribe(p=>{this.enterpriseId=y.L.isEmpty(p.parentId)?localStorage.getItem(n.BU.SELECTED_ENTERPRISE):p.parentId}),this.route.queryParams.subscribe(p=>{this.dataJsonObj.queryParamsObj={defaultView:p.default_view,selectedMenuId:p.selectedMenuId,selectedSubMenuId:p.selectedSubMenuId}})}ngOnInit(){this.initializeComponent()}initializeComponent(){this.dataJsonObj.pageName=n.hf.FUNFACTS,this.commonService.trackView(n.sn.FUNFACT_LIST),document.getElementsByTagName("body");const s=JSON.parse(localStorage.getItem(n.BU.TIMEZONE_OBJ));this.defaultTimeZone=s.lookup_name;const r=s.description.split("(UTC")[1].split(")");this.utcTimeZoneString=r[0].toString(),this.header=this.columnHeader.getFunfactColumnHeaders(),this.listingVariables.pageNumbers=1,this.listingVariables.totalRecords=1,this.searchString="",this.dataJsonObj.advancedSearchObj={},this.actions={EDIT:this.roleRightsValidationByPage(n.hf.FUNFACTS,n.AM.ACTIONS,n.In.EDIT),DELETE:this.roleRightsValidationByPage(n.hf.FUNFACTS,n.AM.ACTIONS,n.In.DELETE)},this.dataJsonObj.addFiltersList=[],this.dataJsonObj.pageActionsList=[],this.roleRightsValidationByPage(n.hf.FUNFACTS,n.AM.ACTIONS,n.In.CREATE)&&this.dataJsonObj.pageActionsList.push({actionName:"CREATE",displayName:"COMMON_BUTTONS.BUTTON_CREATE",actionType:n.gL.URL,redirectURL:"/enterprises/"+this.enterpriseId+"/funfacts/create",queryParams:"",iconClass:"fas fa-plus"}),this.roleRightsValidationByPage(n.hf.FUNFACTS,n.AM.ACTIONS,n.In.FILTERS),this.dataJsonObj.pageTitle=[{key:"COMMON_FIELDS.ALL",value:"",showSubMenuDisplayName:!1},{key:"COMMON_PAGE_TITLES.FUNFACT",value:"",showSubMenuDisplayName:!0}]}getSearchResult(a){this.listingVariables.pageNumbers=1,this.listingVariables.totalRecords=1,this.searchString=a,this.getAllRecords(),this.datatableComponent.reset()}searchClose(){this.searchString="",this.listingVariables.pageNumbers=1,this.listingVariables.totalRecords=1,this.getAllRecords(),this.datatableComponent.reset()}getAllRecords(){try{const a=this.commonService.getMobileViewCondition(this.dataJsonObj.selectedDisplayView);this.funfactsService.getAll(this.enterpriseId,this.listingVariables.pageNumbers,this.listingVariables.rowsPerPage,this.listingVariables.sortOrderColumn,this.searchString,this.status,this.isFilterClicked,this.activeObj,a,this.dataJsonObj.selectedFilter?"&filtertype="+this.dataJsonObj.selectedFilter:"",this.dataJsonObj.advancedSearchObj.inputAdvSearchObj).subscribe(t=>{if(t.rows.length>0){this.funfactsMobileListData&&this.funfactsMobileListData.length>0||(this.funfactsMobileListData=[]);for(let i=0;i<t.rows.length;i++)t.rows[i].display_start_datetime=this.commonService.convertToUserTimeZone(t.rows[i].display_start_datetime,this.utcTimeZoneString),t.rows[i].display_start_datetime=t.rows[i].display_start_datetime+" "+this.defaultTimeZone,t.rows[i].display_end_datetime=this.commonService.convertToUserTimeZone(t.rows[i].display_end_datetime,this.utcTimeZoneString),t.rows[i].display_end_datetime=t.rows[i].display_end_datetime+" "+this.defaultTimeZone,t.rows[i].funfact='<a class="enable" id="funfact'+t.rows[i]._id+'" href="enterprises/'+t.rows[i]._id+'/funfacts/view" >'+t.rows[i].funfact,t.rows[i].enterprise.short_name=t.rows[i].enterprise.short_name,t.rows[i].is_enabled=!0===t.rows[i].is_enabled?"Yes":"No",this.funfactsMobileListData=this.funfactsMobileListData.filter(r=>r._id!==t.rows[i]._id),this.funfactsMobileListData.push(t.rows[i]);t.totalCount&&(this.listingVariables.totalRecords=t.totalCount),1===this.listingVariables.pageNumbers&&(this.listingVariables.totalpages=t.pages),this.dataJsonObj.isLoadMoreClicked?(this.dataJsonObj.isLoadMoreClicked=!1,this.funfactsListData=this.funfactsListData.concat(t.rows)):this.funfactsListData=t.rows}else this.funfactsListData=[],this.funfactsMobileListData=[]}).catch(t=>{this.loggerService.setLoggerError(this.constructor.name,"getAll",t)})}catch(a){this.loggerService.setLoggerError(this.constructor.name,"getAllRecords",a)}}loadPageData(a){this.listingVariables.pageNumbers=a.listingVariables.pageNumbers,a.clearMobileData&&(this.funfactsMobileListData=this.noDuplicates),a.isPaginationChange&&(this.dataJsonObj.selectedFilter=a.selectedFilterType,this.dataJsonObj.isLoadMoreClicked=a.isLoadMoreClicked,this.dataJsonObj.advancedSearchObj.inputAdvSearchObj=a.selectedAdvancedSearchObj),this.getAllRecords()}onActionClicked(a){a.action===n.A0.EDIT?this.router.navigate(["/enterprises/funfacts/"+a.data._id+"/edit"]):a.action===n.A0.DELETE&&this.delete(a.data._id)}delete(a){try{q().fire({title:"",text:this.translateService.instant("COMMON_CONFIRM_MESSAGES.CONFIRM_RECORD_DELETE"),showCancelButton:!0,cancelButtonText:this.translateService.instant("COMMON_BUTTONS.BUTTON_NO"),confirmButtonText:this.translateService.instant("COMMON_BUTTONS.BUTTON_YES"),customClass:{confirmButton:"btn btn-primary btn-sm mgr-5 mat-raised-button mr-1",cancelButton:"btn btn-danger btn-sm mat-raised-button"}}).then(s=>{s.value?this.funfactsService.delete(a).then(t=>{this.uiUtils.displaytoastMessage("COMMON_TOAST_MESSAGES.TOAST_SUCCESS_DELETE"),this.router.routeReuseStrategy.clearModuleRouteCache("funfacts"),this.funfactsListData=[],this.funfactsMobileListData=this.noDuplicates,this.getAllRecords()}).catch(t=>{this.loggerService.setLoggerError(this.constructor.name,"delete",t)}):this.getAllRecords()})}catch(s){this.loggerService.setLoggerError(this.constructor.name,"delete",s)}}mobileEventAction(a){try{this.mobileroutesArray=[],this.roleRightsValidationByPage(n.hf.FUNFACTS,n.AM.ACTIONS,n.In.DELETE)&&this.mobileroutesArray.push({text:this.translateService.instant("COMMON_BUTTONS.BUTTON_DELETE"),handler:()=>{this.delete(a._id),this.router.routeReuseStrategy.clearModuleRouteCache("funfacts")}}),this.roleRightsValidationByPage(n.hf.FUNFACTS,n.AM.ACTIONS,n.In.EDIT)&&this.mobileroutesArray.push({text:this.translateService.instant("COMMON_BUTTONS.BUTTON_EDIT"),handler:()=>{this.router.navigate(["/enterprises/funfacts/"+a._id+"/edit"]),this.router.routeReuseStrategy.clearModuleRouteCache("funfacts")}}),this.presentActionSheet(a)}catch(s){this.loggerService.setLoggerError(this.constructor.name,"mobileEventAction",s)}}presentActionSheet(a){var s=this;return(0,Z.Z)(function*(){s.mobileroutesArray.length>0&&(yield(yield s.actionSheetController.create({cssClass:"actionsheet",buttons:s.mobileroutesArray})).present())})()}Create(){this.route.params.subscribe(a=>{this.enterpriseId=a.parentId}),this.router.navigate(["/enterprises/"+this.enterpriseId+"/funfacts/create"])}onItemClicked(a){try{this.commonService.redirectToUrl(["..",a._id,"view"],!0,!0,this.dataJsonObj.queryParamsObj?this.dataJsonObj.queryParamsObj:"",this.route)}catch(s){this.loggerService.setLoggerError(this.constructor.name,"onItemClicked",s)}}selectedFilterType(a){a?this.dataJsonObj.selectedFilter=a:(this.dataJsonObj.selectedFilter="",this.dataJsonObj.selectedAdvancedSearchObj={})}selectedViewType(a){this.dataJsonObj.selectedDisplayView=a}onPageLevelActionClicked(a){}advancedSearchFilterClicked(a){this.dataJsonObj.selectedAdvancedSearchObj=a}onHeaderItemClick(a){switch(a.type){case"search":this.getSearchResult(a.event);break;case"search_close":this.searchClose();break;case"display_views":this.selectedViewType(a.event);break;case"filters":this.selectedFilterType(a.event);break;case"advanced_search":this.advancedSearchFilterClicked(a.event);break;case"page_actions":this.onPageLevelActionClicked(a.event)}}static \u0275fac=function(s){return new(s||c)(e.Y36(K.BX),e.Y36(C.Y),e.Y36(S.v),e.Y36(D),e.Y36(M.m),e.Y36(g.F0),e.Y36(b.sK),e.Y36(O.s),e.Y36(N.v),e.Y36(g.gz))};static \u0275cmp=e.Xpm({type:c,selectors:[["app-funfacts-list"]],viewQuery:function(s,t){if(1&s&&e.Gf(X,5),2&s){let i;e.iGM(i=e.CRH())&&(t.datatablecomponent=i.first)}},inputs:{data:"data"},features:[e._Bn([N.v,C.Y,D,O.s,J.n]),e.qOj],decls:9,vars:26,consts:[[1,"container-fluid"],[1,"card","bd-0"],["id","stickyHeaderID",1,"card-header","card-header-primary"],[1,"subpage-header-title","w-100",3,"pageName","defaultView","isFabDisplay","pageActionsList","pageTitle","selectedMenuId","selectedSubMenuId","showPageHeaderItems","showDependencySubMenu","headerItemClick"],["id","extraPaddingBottomID",1,"card-body","pdt-0"],["id","tagid",1,"",3,"header","totalRecords","actions","data","expand","totalPages","paginator","mobileListData","listingVariables","selectedDisplayViewType","selectedFilterType","selectedAdvancedSearchObj","pageName","selectedMenuId","selectedSubMenuId","redirectionEvent","actionClicked","itemClickEvent","loadPageData"],["datatableComponent",""],[1,"mgt-5"],[3,"isFabDisplay","actionsList","selectedAction"]],template:function(s,t){1&s&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"app-pageheader",3),e.NdJ("headerItemClick",function(r){return t.onHeaderItemClick(r)}),e.qZA()(),e.TgZ(4,"div",4)(5,"app-datatable",5,6),e.NdJ("redirectionEvent",function(r){return t.mobileEventAction(r)})("actionClicked",function(r){return t.onActionClicked(r)})("itemClickEvent",function(r){return t.onItemClicked(r)})("loadPageData",function(r){return t.loadPageData(r)}),e.qZA(),e.TgZ(7,"div",7)(8,"app-page-actions",8),e.NdJ("selectedAction",function(r){return t.onPageLevelActionClicked(r)}),e.qZA()()()()()),2&s&&(e.xp6(3),e.Q6J("pageName",t.dataJsonObj.pageName)("defaultView",null==t.dataJsonObj.queryParamsObj?null:t.dataJsonObj.queryParamsObj.defaultView)("isFabDisplay",!1)("pageActionsList",t.dataJsonObj.pageActionsList)("pageTitle",t.dataJsonObj.pageTitle)("selectedMenuId",null==t.dataJsonObj.queryParamsObj?null:t.dataJsonObj.queryParamsObj.selectedMenuId)("selectedSubMenuId",null==t.dataJsonObj.queryParamsObj?null:t.dataJsonObj.queryParamsObj.selectedSubMenuId)("showPageHeaderItems",!0)("showDependencySubMenu",!1),e.xp6(2),e.Q6J("header",t.header)("totalRecords",t.listingVariables.totalRecords)("actions",t.actions)("data",t.funfactsListData)("expand",!1)("totalPages",t.listingVariables.totalpages)("paginator",!0)("mobileListData",t.funfactsMobileListData)("listingVariables",t.listingVariables)("selectedDisplayViewType",t.dataJsonObj.selectedDisplayView)("selectedFilterType",t.dataJsonObj.selectedFilter)("selectedAdvancedSearchObj",t.dataJsonObj.selectedAdvancedSearchObj)("pageName",t.dataJsonObj.pageName)("selectedMenuId",null==t.dataJsonObj.queryParamsObj?null:t.dataJsonObj.queryParamsObj.selectedMenuId)("selectedSubMenuId",null==t.dataJsonObj.queryParamsObj?null:t.dataJsonObj.queryParamsObj.selectedSubMenuId),e.xp6(3),e.Q6J("isFabDisplay",!0)("actionsList",t.dataJsonObj.pageActionsList))},dependencies:[J.n,A.q,W.y]})}return c})();var $=d(71238),_=d(46448),I=d(32174),L=d(2387),U=d(56368),F=d(93837),j=d(24929),V=d(11735);let x=(()=>{class c extends E.O{listingVariables;FunfactsService;route;router;navigationService;apiEndPointUrl;translateService;commonService;columnsheaders;_sharedService;loggerService;actionType;apiEndPoint;checkboxOptions;funfact;createdUser;creationDate;defaultTimeZone;endDate;funfactViewData;isEnabled;lastUpdateDate;lastUpdatedUser;loginUserDateFormat;objectType;show;recordId;startDate;utcTimeZone;utcTimeZoneString;dataJsonObj={};constructor(a,s,t,i,r,h,l,u,m,f,p){super(t,u),this.listingVariables=a,this.FunfactsService=s,this.route=t,this.router=i,this.navigationService=r,this.apiEndPointUrl=h,this.translateService=l,this.commonService=u,this.columnsheaders=m,this._sharedService=f,this.loggerService=p,this.route.queryParams.subscribe(T=>{this.dataJsonObj.queryParamsObj={defaultView:T.defaultView,selectedMenuId:T.selectedMenuId,selectedSubMenuId:T.selectedSubMenuId}})}ngOnInit(){this.initializeComponent()}initializeComponent(){this.dataJsonObj.pageName=n.hf.FUNFACTS,this.dataJsonObj.pageTitle=[{key:"COMMON_PAGE_TITLES.FUNFACT",value:"",showSubMenuDisplayName:!1},{key:"",value:"-",showSubMenuDisplayName:!1},{key:"COMMON_BUTTONS.BUTTON_VIEW",value:"",showSubMenuDisplayName:!1}],this.apiEndPoint=localStorage.getItem(n.BU.S3_URL)?localStorage.getItem(n.BU.S3_URL):this.apiEndPointUrl,this.commonService.trackView(n.sn.FUNFACT_VIEW),this.dataJsonObj.showrecordhistory=this.roleRightsValidationByPage(n.hf.FUNFACTS,n.AM.ACTIONS,n.In.RECORD_HISTORY),this.show=!0,this.objectType=this.route.snapshot.data.object_type,document.getElementsByTagName("body"),this.route.params.subscribe(m=>{this.recordId=m.parentId}),this._sharedService.emitChangeLoaders(!0),this.checkboxOptions=[{value:"112",displayname:this.translateService.instant("COMMON_FIELDS.ENABLED"),key:"checkbox1"}];const s=JSON.parse(localStorage.getItem(n.BU.TIMEZONE_OBJ));this.defaultTimeZone=s.lookup_name;const r=s.description.split("(UTC")[1].split(")");this.utcTimeZone=r[0],this.utcTimeZoneString=r[0].toString();const h=JSON.parse(localStorage.getItem(n.BU.DATE_FORMATE_OBJ));this.loginUserDateFormat=h.lookup_name,this.getRecordById(this.recordId),this.actionType=n.In.VIEW;const l=JSON.parse(localStorage.getItem(n.BU.ENTERPRISE));this.dataJsonObj.enterpriseId=l.enterprise_id,this.dataJsonObj.selectedPage=n.hf.FUNFACTS,this.getDynamicJson([{folderName:"menu_manager",jsonType:"",storingFieldName:"menuDataJson"}])}getDynamicJson(a){var s=this;return(0,Z.Z)(function*(){for(let t of a)s.dataJsonObj[t.storingFieldName]=yield s.commonService.getDynamicJson(s.dataJsonObj.enterpriseId,t.folderName,t.jsonType);s.dataJsonObj.selectedObj={},s.dataJsonObj.selectedObj.recordId=s.recordId,s.dataJsonObj.selectedObj.pageObj=s.dataJsonObj.menuDataJson.filter(t=>t.menu_page.page_name===s.dataJsonObj.selectedPage),s.dataJsonObj.selectedObjEnabled=!0})()}getRecordById(a){try{this.FunfactsService.get(a).subscribe(s=>{this.funfactViewData=s,this.funfact=this.funfactViewData.funfact,this.startDate=this.commonService.convertToUserTimeZone(this.funfactViewData.display_start_datetime,this.utcTimeZoneString),this.startDate=this.startDate+" "+this.defaultTimeZone,this.endDate=this.commonService.convertToUserTimeZone(this.funfactViewData.display_end_datetime,this.utcTimeZoneString),this.endDate=this.endDate+" "+this.defaultTimeZone,this.creationDate=this.funfactViewData.createdAt,this.createdUser=this.funfactViewData.created_by,this.lastUpdatedUser=this.funfactViewData.updated_by,this.lastUpdateDate=this.funfactViewData.updatedAt,this.isEnabled=this.funfactViewData.is_enabled}).catch(s=>{this.loggerService.setLoggerError(this.constructor.name,"getRecordById",s)})}catch(s){this.loggerService.setLoggerError(this.constructor.name,"getRecordById",s)}}Close(){this.commonService.redirectToPreviousUrl()}static \u0275fac=function(s){return new(s||c)(e.Y36(N.v),e.Y36(D),e.Y36(g.gz),e.Y36(g.F0),e.Y36(_.f),e.Y36("apiEndPoint"),e.Y36(b.sK),e.Y36(S.v),e.Y36(C.Y),e.Y36($.F),e.Y36(M.m))};static \u0275cmp=e.Xpm({type:c,selectors:[["app-funfacts-view"]],features:[e._Bn([N.v,S.v,C.Y,O.s,D]),e.qOj],decls:37,vars:42,consts:[[1,"container-fluid"],[1,"forms-wrapper"],[1,"row","g-0"],[1,"col-md-12"],[1,"card"],["id","stickyHeaderID",1,"card-header","card-header-primary"],[1,"subpage-header-title","w-100",3,"pageName","pageTitle","selectedMenuId","selectedSubMenuId","showPageHeaderItems","showDependencySubMenu"],[1,"card-body"],[1,"row","form-bs"],[1,"col-md-4"],["disabled","true","id","funfacts-view-enterprisesname",3,"label","value"],["disabled","true","id","funfacts-view-funfactname",3,"label","value"],["disabled","true","id","funfacts-view-satrtdate",3,"label","value"],["disabled","true","id","funfacts-view-enddate",3,"label","value"],["disabled","true","id","funfacts-view-duration",3,"label","value"],[1,"col-md-1","d-flex","align-items-center"],["label","","disabled","true","id","funfacts-view-enabled","mandatory","false",3,"options","checked"],["mandatory","false","disabled","true","id","funfacts-view-description",3,"label","defaultvalue","maxlength"],[1,"col-md-12","text-end","mt-2"],["id","funfacts-view-close","className","btn btn-danger btn-sm",3,"label","buttonOnClick"],["id","extraPaddingBottomID",1,"card-content"],[3,"multiple"],[3,"createdBy","lastUpdatedBy","showrecordhistory","creationDate","lastUpdatedDate"]],template:function(s,t){1&s&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5),e._UZ(6,"app-pageheader",6),e.qZA(),e.TgZ(7,"div",7)(8,"div",8)(9,"div",9),e._UZ(10,"app-input",10),e.ALo(11,"translate"),e.qZA(),e.TgZ(12,"div",9),e._UZ(13,"app-input",11),e.ALo(14,"translate"),e.qZA(),e.TgZ(15,"div",9),e._UZ(16,"app-input",12),e.ALo(17,"translate"),e.qZA(),e.TgZ(18,"div",9),e._UZ(19,"app-input",13),e.ALo(20,"translate"),e.qZA(),e.TgZ(21,"div",9),e._UZ(22,"app-input",14),e.ALo(23,"translate"),e.qZA(),e.TgZ(24,"div",15),e._UZ(25,"app-checkbox",16),e.qZA(),e.TgZ(26,"div",3),e._UZ(27,"app-textarea",17),e.ALo(28,"translate"),e.qZA(),e.TgZ(29,"div",18)(30,"app-button",19),e.NdJ("buttonOnClick",function(){return t.Close()}),e.ALo(31,"translate"),e.qZA()()()()()(),e.TgZ(32,"div",3)(33,"div",4)(34,"div",20)(35,"p-accordion",21),e._UZ(36,"app-recordhistory",22),e.qZA()()()()()()()),2&s&&(e.xp6(6),e.Q6J("pageName",t.dataJsonObj.pageName)("pageTitle",t.dataJsonObj.pageTitle)("selectedMenuId",null==t.dataJsonObj.queryParamsObj?null:t.dataJsonObj.queryParamsObj.selectedMenuId)("selectedSubMenuId",null==t.dataJsonObj.queryParamsObj?null:t.dataJsonObj.queryParamsObj.selectedSubMenuId)("showPageHeaderItems",!1)("showDependencySubMenu",!0),e.xp6(4),e.s9C("label",e.lcZ(11,28,"COMMON_PAGE_TITLES.ENTERPRISE")),e.s9C("value",null==t.funfactViewData||null==t.funfactViewData.enterprise?null:t.funfactViewData.enterprise.short_name),e.xp6(3),e.s9C("label",e.lcZ(14,30,"NEW_VARIABLES.FUNFACT")),e.s9C("value",null==t.funfactViewData?null:t.funfactViewData.funfact),e.xp6(3),e.s9C("label",e.lcZ(17,32,"COMMON_FIELDS.START_DATE")),e.s9C("value",t.startDate),e.xp6(3),e.s9C("label",e.lcZ(20,34,"COMMON_FIELDS.END_DATE")),e.s9C("value",t.endDate),e.xp6(3),e.s9C("label",e.lcZ(23,36,"COMMON_FIELDS.DURATION")),e.s9C("value",null==t.funfactViewData?null:t.funfactViewData.duration),e.xp6(3),e.Q6J("options",t.checkboxOptions)("checked",t.isEnabled),e.xp6(2),e.s9C("label",e.lcZ(28,38,"COMMON_FIELDS.NOTES")),e.s9C("defaultvalue",null==t.funfactViewData?null:t.funfactViewData.description),e.Q6J("maxlength",2e3),e.xp6(3),e.s9C("label",e.lcZ(31,40,"COMMON_BUTTONS.BUTTON_CLOSE")),e.xp6(5),e.Q6J("multiple",!0),e.xp6(1),e.Q6J("createdBy",t.createdUser)("lastUpdatedBy",t.lastUpdatedUser)("showrecordhistory",t.dataJsonObj.showrecordhistory)("creationDate",t.creationDate)("lastUpdatedDate",t.lastUpdateDate))},dependencies:[I.UQ,L.r,U.a,F.b,j.R,V.W,A.q,b.X$]})}return c})();var o=d(15439),R=d(47386),B=d(42919),P=d(89520);let ee=(()=>{class c extends E.O{route;translateService;router;navigationService;funfactsService;commonService;uiUtils;loggerService;recordId;checkboxOptions;funfactViewData;enterpriseData;creationDate;createdUser;lastUpdatedUser;lastUpdateDate;isEnabled;dayOptions;days;defaultDuration;defaultTimeZone;description;duration;durationList;durationObj;durationOptions;durationinMinutes;endDate;enddate1;error;hourOptions;hours;hoursList;lastUpdatedBy;lastUpdatedDate;minutes;objectType;selectedData;selectedDays;selectedDuration;selectedHours;startDate;startdate1;timezoneOptions;utctimezone;utctimezonestring;enterpriseId;funfactEditObj=new te;dataJsonObj={};constructor(a,s,t,i,r,h,l,u){super(a,h),this.route=a,this.translateService=s,this.router=t,this.navigationService=i,this.funfactsService=r,this.commonService=h,this.uiUtils=l,this.loggerService=u,this.route.params.subscribe(m=>{this.recordId=m.id})}ngOnInit(){this.initializeComponent()}initializeComponent(){let t;for(this.dataJsonObj.pageName=n.hf.FUNFACTS,this.dataJsonObj.pageTitle=[{key:"COMMON_PAGE_TITLES.FUNFACT",value:"",showSubMenuDisplayName:!1},{key:"",value:"-",showSubMenuDisplayName:!1},{key:"COMMON_BUTTONS.BUTTON_EDIT",value:"",showSubMenuDisplayName:!1}],this.enterpriseId=JSON.parse(localStorage.getItem(n.BU.SELECTED_ENTERPRISE)),this.checkboxOptions=[{value:"112",displayname:this.translateService.instant("COMMON_FIELDS.ENABLED"),key:"checkbox1"}],this.dataJsonObj.showrecordhistory=this.roleRightsValidationByPage(n.hf.FUNFACTS,n.AM.ACTIONS,n.In.RECORD_HISTORY),document.getElementsByTagName("body"),this.defaultDuration=n.ox.DEFAULT_DURATION,this.durationOptions=[],t=0;t<=11;t++)0===t?(this.durationList={ID:"00",NAME:"00"},this.durationOptions.push(this.durationList)):1===t?(this.durationList={ID:"0"+t*this.defaultDuration,NAME:"0"+t*this.defaultDuration},this.durationOptions.push(this.durationList)):(this.durationList={ID:t*this.defaultDuration,NAME:t*this.defaultDuration},this.durationOptions.push(this.durationList));this.dayOptions="00",this.hourOptions=[];for(let u=0;u<=23;u++)u<10?(this.hoursList={ID:"0"+u,NAME:"0"+u},this.hourOptions.push(this.hoursList)):(this.hoursList={ID:u,NAME:u},this.hourOptions.push(this.hoursList));this.days="00",this.hours="00",this.minutes="05",this.durationObj=[],this.durationObj.durationOptions=this.durationOptions,this.durationObj.hourOptions=this.hourOptions,this.durationObj.daysList=this.dayOptions,this.funfactEditObj.duration=this.durationObj.daysList+this.durationObj.hourOptions+this.durationObj.durationOptions;const i=JSON.parse(localStorage.getItem(n.BU.TIMEZONE_OBJ));this.defaultTimeZone=i.lookup_name;const r=i.description;this.commonService.getLookupCodesListJson(this.enterpriseId,"list").then(u=>{this.dataJsonObj.lookupCodesListJSON=u,this.getTimeZone(this.defaultTimeZone)});const l=r.split("(UTC")[1].split(")");this.utctimezone=l[0],this.utctimezonestring=l[0].toString(),this.durationChanged(),this.getRecordById(this.recordId)}getRecordById(a){try{this.funfactsService.get(a).subscribe(s=>{this.funfactViewData=s,this.enterpriseData=this.funfactViewData.enterprise,this.description=this.funfactViewData.description,this.createdUser=this.funfactViewData.created_by,this.lastUpdatedUser=this.funfactViewData.updated_by,this.isEnabled=this.funfactViewData.is_enabled,this.startDate=this.commonService.convertToUserTimeZoneWithoutTime(this.funfactViewData.display_start_datetime,this.utctimezonestring),this.startDate=o(this.startDate).format("YYYY-MM-DDTHH:mm:ss"),this.endDate=this.commonService.convertToUserTimeZone(this.funfactViewData.display_end_datetime,this.utctimezonestring),this.endDate=o(this.endDate).format("YYYY-MM-DDTHH:mm:ss"),this.funfactViewData.display_start_datetime=this.commonService.convertToUserTimeZone(this.funfactViewData.display_start_datetime,this.utctimezonestring),this.funfactViewData.display_start_datetime=this.funfactViewData.display_start_datetime+" "+this.defaultTimeZone;const t=this.funfactViewData.duration.split(" ");this.selectedDays=t[0],this.selectedDuration=t[4],this.selectedHours=t[2];const i={ID:t[2],NAME:t[2]},r={ID:t[4],NAME:t[4]};this.selectedData=[],this.selectedData.durationOptions=r,this.selectedData.hourOptions=i,this.selectedData.daysList=this.selectedDays,this.funfactEditObj.duration=this.funfactViewData.duration}).catch(s=>{this.loggerService.setLoggerError(this.constructor.name,"getRecordById",s)})}catch(s){this.loggerService.setLoggerError(this.constructor.name,"getRecordById",s)}}changeEnabledvalue(a){this.isEnabled=a.value}changeDescription(a){this.description=a.value}durationChange(a){try{this.days=a.days,this.hours=a.hours,this.minutes=a.minutes,this.durationChanged()}catch(s){this.loggerService.setLoggerError(this.constructor.name,"durationChange",s)}}startDateChange(a){try{const s=o(a).format("YYYY-MM-DD HH:mm");if("-"===this.utctimezonestring.charAt(0)){const i=this.utctimezone.split("-")[1].split(":");this.startdate1=o(s).add(i[0],"hours"),this.startdate1=o(this.startdate1).add(i[1],"minutes")}else{const i=this.utctimezone.split("+")[1].split(":");this.startdate1=o(s).subtract(i[0],"hours"),this.startdate1=o(this.startdate1).subtract(i[1],"minutes")}o(this.startdate1).format("YYYY-MM-DD HH:mm")<o(this.utctimezonestring).utc().format("YYYY-MM-DD HH:mm")?(this.startDate=new Date(3e5*Math.ceil(this.startDate.getTime()/3e5)),this.error="COMMON_VALIDATION_MESSAGES.VALID_NOBLANK_START_END_DATE"):(this.startDate=new Date(3e5*Math.ceil(this.startDate.getTime()/3e5)),this.endDate=o(o(this.startDate).minutes(o(this.startDate).minutes()+Number(this.duration))).format("YYYY-MM-DD HH:mm"))}catch(s){this.loggerService.setLoggerError(this.constructor.name,"startDateChange",s)}}changeEndDate(a){try{this.endDate=a.value;const s=o(a.value).format("YYYY-MM-DD HH:mm");if("-"===this.utctimezonestring.charAt(0)){const i=this.utctimezone.split("-")[1].split(":");this.enddate1=o(s).add(i[0],"hours"),this.enddate1=o(this.enddate1).add(i[1],"minutes")}else{const i=this.utctimezone.split("+")[1].split(":");this.enddate1=o(s).subtract(i[0],"hours"),this.enddate1=o(this.enddate1).subtract(i[1],"minutes")}if(new Date(this.startDate)>=new Date(this.endDate))this.endDate=new Date(3e5*Math.ceil(this.endDate.getTime()/3e5)),this.error="COMMON_VALIDATION_MESSAGES.VALID_NOBLANK_START_END_DATE";else{let t,i,r;this.endDate=new Date(3e5*Math.ceil(this.endDate.getTime()/3e5)),r=o.utc(o(this.endDate,"YYYY-MM-DD HH:mm").diff(o(this.startDate,"YYYY-MM-DD HH:mm"))).format("m"),i=Number(r)<=5?"0"+Number(5*Math.ceil(r/5)):Number(5*Math.ceil(r/5));const l=o.utc(o(this.endDate,"YYYY-MM-DD HH:mm").diff(o(this.startDate,"YYYY-MM-DD HH:mm"))).format("H");t=Number(l)<10?"0"+Number(l):Number(l);const u=o.utc(o(this.endDate,"YYYY-MM-DD HH:mm").diff(o(this.startDate,"YYYY-MM-DD HH:mm")));this.hours=t,this.days=Math.floor(Number(u)/864e5),this.minutes=i,this.selectedDays=this.days,this.selectedDuration=this.minutes,this.selectedHours=this.hours;const m={ID:this.hours,NAME:this.hours},f={ID:this.minutes,NAME:this.minutes};this.selectedData=[],this.selectedData.durationOptions=f,this.selectedData.hourOptions=m,this.selectedData.daysList=this.selectedDays,this.endDate=new Date(o(this.endDate).format("YYYY-MM-DD HH:mm").replace(/-/g,"/")),this.funfactEditObj.duration=this.commonService.changeDurationFormat({days:this.days,hours:this.hours,minutes:this.minutes})}}catch(s){this.loggerService.setLoggerError(this.constructor.name,"changeEndDate",s)}}getTimeZone(a){try{this.commonService.getFilteredLookupCodes(this.dataJsonObj.lookupCodesListJSON[n.ox.TIME_ZONES],a).then(s=>{if(this.timezoneOptions=s,this.timezoneOptions.length>0){for(let t=0;t<this.timezoneOptions.length;t++)this.timezoneOptions[t].NAME=this.timezoneOptions[t].NAME+" - "+this.timezoneOptions[t].description;this.timezoneOptions=this.timezoneOptions}},s=>{this.loggerService.setLoggerError(this.constructor.name,"getLookupTypes",s)})}catch(s){this.loggerService.setLoggerError(this.constructor.name,"getTimeZone",s)}}changeTimeZone(a){try{this.defaultTimeZone=this.lookupLanguageTranslations(a.lookup_id);const i=a.description.split("(UTC")[1].split(")");this.utctimezone=i[0],this.utctimezonestring=i[0].toString()}catch(s){this.loggerService.setLoggerError(this.constructor.name,"changeTimeZone",s)}}durationChanged(){try{this.error="";const a=new Date(this.startDate),s=Number(this.minutes);this.funfactEditObj.minutes=this.minutes;const t=Number(this.hours);if(this.funfactEditObj.hours=this.hours,null!==this.days){this.funfactEditObj.days=this.days;const i=Number(this.funfactEditObj.days);this.endDate=o(new Date(a.setDate(a.getDate()+i))).format("DD-MMM-YYYY HH:mm").replace(/-/g,"/")}if(y.L.isEmpty(this.days)){this.funfactEditObj.days="0";const i=Number(this.funfactEditObj.days);this.endDate=o(new Date(a.setDate(a.getDate()+i))).format("DD-MMM-YYYY HH:mm").replace(/-/g,"/")}this.endDate=new Date(a.setHours(a.getHours()+t)),this.endDate=new Date(a.setMinutes(a.getMinutes()+s)),this.funfactEditObj.duration=this.commonService.changeDurationFormat(this.funfactEditObj)}catch(a){this.loggerService.setLoggerError(this.constructor.name,"durationChanged",a)}}updateRecord(){try{this.funfactEditObj.enterprise=this.enterpriseData,this.funfactEditObj.display_start_datetime=this.funfactViewData.display_start_datetime,this.funfactEditObj.display_end_datetime=this.endDate,this.funfactEditObj.description=this.description,this.funfactEditObj.is_enabled=this.isEnabled,this.funfactsService.update(this.funfactEditObj,this.recordId).then(a=>{this.uiUtils.displaytoastMessage("COMMON_TOAST_MESSAGES.TOAST_SUCCESS_EDIT"),this.commonService.redirectToPreviousUrl()},a=>{this.commonErrorCodes(JSON.parse(a)),this.loggerService.setLoggerError(this.constructor.name,"update",a)})}catch(a){this.loggerService.setLoggerError(this.constructor.name,"updateRecord",a)}}commonErrorCodes(a){const s=JSON.parse(a[n.BU.STATUS]);switch(s){case 409:case 412:this.error="COMMON_STATUS_CODES."+s}}cancelBtn(){this.commonService.redirectToPreviousUrl()}static \u0275fac=function(s){return new(s||c)(e.Y36(g.gz),e.Y36(b.sK),e.Y36(g.F0),e.Y36(_.f),e.Y36(D),e.Y36(S.v),e.Y36(O.s),e.Y36(M.m))};static \u0275cmp=e.Xpm({type:c,selectors:[["app-funfacts-edit"]],features:[e.qOj],decls:44,vars:46,consts:[[1,"container-fluid"],[1,"forms-wrapper"],[1,"row","g-0"],[1,"col-md-12"],[1,"card","bdt-0"],["id","stickyHeaderID",1,"card-header","card-header-primary"],[1,"subpage-header-title","w-100",3,"pageName","pageTitle","showPageHeaderItems","showDependencySubMenu"],[1,"card-body"],[1,"row","form-bs"],[1,"col-md-3"],["mandatory","true","disabled","true","id","funfacts-edit-enterprisename",3,"label","value"],[1,"col-md-8"],["disabled","true","id","funfacts-create-contractname",3,"label","value"],["funfactvalidation",""],[1,"col-md-1","d-flex","align-items-center"],["label","","id","funfacts-edit-enabled","mandatory","false",3,"options","checked","valueChange"],[1,"col-md-4"],["mandatory","false","disabled","true","id","start_datetime",3,"label","value"],[3,"data","selectedInfoData","changeDuration"],[1,"col-lg-3","col-md-6","datetimepicker"],[1,"row"],[1,"col-8","col-md-8","pe-0"],["mandatory","true","dateformat","dd-MMM-yyyy","disabled","false","id","funfacts-edit-end-date",3,"placeholder","defaultDate","editvalueChange"],[1,"col-4","col-md-4","ps-2"],["disabled","false","mandatory","true",3,"label","options","defaultValue","selectedOption","searchValueChange"],[1,"col-lg-12","col-md-9"],["mandatory","false","disabled","false","id","funfacts-edit-notes",3,"label","defaultvalue","maxlength","valueChange"],[1,"col-md-12","text-end","mt-2","btns-group"],["className","btn btn-primary btn-sm","id","contracts-edit-submit",1,"mgr-5",3,"label","buttonOnClick"],["className","btn btn-danger btn-sm","id","contracts-edit-cancel",3,"label","buttonOnClick"],[1,"card"],["id","extraPaddingBottomID",1,"card-content"],[3,"multiple"],[3,"createdBy","lastUpdatedBy","showrecordhistory","creationDate","lastUpdatedDate"]],template:function(s,t){1&s&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5),e._UZ(6,"app-pageheader",6),e.qZA(),e.TgZ(7,"div",7)(8,"div",8)(9,"div",9),e._UZ(10,"app-input",10),e.ALo(11,"translate"),e.qZA(),e.TgZ(12,"div",11),e._UZ(13,"app-input",12,13),e.ALo(15,"translate"),e.qZA(),e.TgZ(16,"div",14)(17,"app-checkbox",15),e.NdJ("valueChange",function(r){return t.changeEnabledvalue(r)}),e.qZA()(),e.TgZ(18,"div",16),e._UZ(19,"app-input",17),e.ALo(20,"translate"),e.qZA(),e.TgZ(21,"div",16)(22,"app-event-duration",18),e.NdJ("changeDuration",function(r){return t.durationChange(r)}),e.qZA()(),e.TgZ(23,"div",19)(24,"div",20)(25,"div",21)(26,"app-datetimepicker",22),e.NdJ("editvalueChange",function(r){return t.changeEndDate(r)}),e.ALo(27,"translate"),e.qZA()(),e.TgZ(28,"div",23)(29,"app-dropdown-search",24),e.NdJ("selectedOption",function(r){return t.changeTimeZone(r)})("searchValueChange",function(r){return t.getTimeZone(r)}),e.ALo(30,"translate"),e.qZA()()()(),e.TgZ(31,"div",25)(32,"app-textarea",26),e.NdJ("valueChange",function(r){return t.changeDescription(r)}),e.ALo(33,"translate"),e.qZA()(),e.TgZ(34,"div",27)(35,"app-button",28),e.NdJ("buttonOnClick",function(){return t.updateRecord()}),e.ALo(36,"translate"),e.qZA(),e.TgZ(37,"app-button",29),e.NdJ("buttonOnClick",function(){return t.cancelBtn()}),e.ALo(38,"translate"),e.qZA()()()()()(),e.TgZ(39,"div",3)(40,"div",30)(41,"div",31)(42,"p-accordion",32),e._UZ(43,"app-recordhistory",33),e.qZA()()()()()()()),2&s&&(e.xp6(6),e.Q6J("pageName",t.dataJsonObj.pageName)("pageTitle",t.dataJsonObj.pageTitle)("showPageHeaderItems",!1)("showDependencySubMenu",!1),e.xp6(4),e.s9C("label",e.lcZ(11,30,"COMMON_PAGE_TITLES.ENTERPRISE")),e.s9C("value",null==t.funfactViewData||null==t.funfactViewData.enterprise?null:t.funfactViewData.enterprise.short_name),e.xp6(3),e.s9C("label",e.lcZ(15,32,"NEW_VARIABLES.FUNFACT")),e.s9C("value",null==t.funfactViewData?null:t.funfactViewData.funfact),e.xp6(4),e.Q6J("options",t.checkboxOptions)("checked",t.isEnabled),e.xp6(2),e.s9C("label",e.lcZ(20,34,"COMMON_FIELDS.START_DATE")),e.s9C("value",null==t.funfactViewData?null:t.funfactViewData.display_start_datetime),e.xp6(3),e.Q6J("data",t.durationObj)("selectedInfoData",t.selectedData),e.xp6(4),e.s9C("placeholder",e.lcZ(27,36,"COMMON_FIELDS.END_DATE")),e.Q6J("defaultDate",t.endDate),e.xp6(3),e.s9C("label",e.lcZ(30,38,"PREFERENCES.TIMEZONE")),e.s9C("defaultValue",t.defaultTimeZone),e.Q6J("options",t.timezoneOptions),e.xp6(3),e.s9C("label",e.lcZ(33,40,"COMMON_FIELDS.NOTES")),e.s9C("defaultvalue",t.description),e.Q6J("maxlength",2e3),e.xp6(3),e.s9C("label",e.lcZ(36,42,"COMMON_BUTTONS.BUTTON_SUBMIT")),e.xp6(2),e.s9C("label",e.lcZ(38,44,"COMMON_BUTTONS.BUTTON_CANCEL")),e.xp6(5),e.Q6J("multiple",!0),e.xp6(1),e.Q6J("createdBy",t.createdUser)("lastUpdatedBy",t.lastUpdatedUser)("showrecordhistory",t.dataJsonObj.showrecordhistory)("creationDate",null==t.funfactViewData?null:t.funfactViewData.createdAt)("lastUpdatedDate",null==t.funfactViewData?null:t.funfactViewData.updatedAt))},dependencies:[I.UQ,L.r,U.a,F.b,j.R,R.L,B.C,V.W,P.w,A.q,b.X$]})}return c})();class te{enterprise;display_end_datetime;display_start_datetime;duration;description;days;minutes;hours;is_enabled}const ae=["funfactvalidation"];let se=(()=>{class c extends E.O{router;route;navigationService;funfactsService;uiUtils;commonService;translateService;loggerService;funfactvalidation;checkboxOptions;funfactCreateObj=new ie;description;endDate;enterpriseId;enterpriseName;enterpriseShortName;error1;error;isEnabled=!0;loginUserDateFormat;recordId;startDate;funfact;duration;durationList;durationObj;durationOptions;defaultDuration;dayOptions;days;daysList;hourOptions;hours;hoursList;minutes;defaultTimeZone;utctimezone;utctimezonestring;timezoneOptions;enddate1;selectedData;selecteddays;selectedduration;selectedhours;headerAction;dataJsonObj={};constructor(a,s,t,i,r,h,l,u){super(s,h),this.router=a,this.route=s,this.navigationService=t,this.funfactsService=i,this.uiUtils=r,this.commonService=h,this.translateService=l,this.loggerService=u,this.route.params.subscribe(m=>{this.recordId=m.parentId})}ngOnInit(){this.initializeComponent()}initializeComponent(){let s;for(this.dataJsonObj.pageName=n.hf.FUNFACTS,this.headerAction={BACK:!0},this.dataJsonObj.pageTitle=[{key:"COMMON_PAGE_TITLES.FUNFACT",value:"",showSubMenuDisplayName:!1},{key:"",value:"-",showSubMenuDisplayName:!1},{key:"COMMON_BUTTONS.BUTTON_CREATE",value:"",showSubMenuDisplayName:!1}],this.getEnterprisesViewData(),this.checkboxOptions=[{value:"112",displayname:this.translateService.instant("COMMON_FIELDS.ENABLED"),key:"checkbox1"}],this.startDate=new Date,this.endDate=new Date,this.defaultDuration=n.ox.DEFAULT_DURATION,this.durationOptions=[],s=0;s<=11;s++)0===s?(this.durationList={ID:"00",NAME:"00"},this.durationOptions.push(this.durationList)):1===s?(this.durationList={ID:"0"+s*this.defaultDuration,NAME:"0"+s*this.defaultDuration},this.durationOptions.push(this.durationList)):(this.durationList={ID:s*this.defaultDuration,NAME:s*this.defaultDuration},this.durationOptions.push(this.durationList));this.dayOptions="00",this.hourOptions=[];for(let l=0;l<=23;l++)l<10?(this.hoursList={ID:"0"+l,NAME:"0"+l},this.hourOptions.push(this.hoursList)):(this.hoursList={ID:l,NAME:l},this.hourOptions.push(this.hoursList));this.days="00",this.hours="00",this.minutes="05",this.durationObj=[],this.durationObj.durationOptions=this.durationOptions,this.durationObj.hourOptions=this.hourOptions,this.durationObj.daysList=this.dayOptions,this.funfactCreateObj.duration=this.durationObj.daysList+this.durationObj.hourOptions+this.durationObj.durationOptions;const t=JSON.parse(localStorage.getItem(n.BU.TIMEZONE_OBJ));this.defaultTimeZone=t.lookup_name;const i=t.description;this.commonService.getLookupCodesListJson(this.enterpriseId,"list").then(l=>{this.dataJsonObj.lookupCodesListJSON=l,this.getTimeZone(this.defaultTimeZone)});const h=i.split("(UTC")[1].split(")");this.utctimezone=h[0],this.utctimezonestring=h[0].toString(),this.durationChanged()}getEnterprisesViewData(){try{this.commonService.getEnterprisesViewData(this.recordId).then(a=>{this.enterpriseName=a.enterprise_name,this.enterpriseId=a._id,this.enterpriseShortName=a.short_name}).catch(a=>{this.loggerService.setLoggerError(this.constructor.name,"getEnterprisesViewData",a)})}catch(a){this.loggerService.setLoggerError(this.constructor.name,"getEnterprisesViewData",a)}}changeFunfact(a){this.funfact=a.value}changeEnabledvalue(a){this.isEnabled=a.value}changeStartDate(a){try{this.startDate=a.value,this.durationChanged()}catch(s){this.loggerService.setLoggerError(this.constructor.name,"changeStartDate",s)}}getDuration(a){try{this.durationOptions=this.durationList}catch(s){this.loggerService.setLoggerError(this.constructor.name,"getDuration",s)}}changeDuration(a){try{this.days=a.days,this.hours=a.hours,this.minutes=a.minutes,this.durationChanged()}catch(s){this.loggerService.setLoggerError(this.constructor.name,"changeDuration",s)}}durationChanged(){try{this.error="";const a=new Date(this.startDate);this.funfactCreateObj.display_start_datetime=this.startDate;const s=Number(this.minutes);this.funfactCreateObj.minutes=this.minutes;const t=Number(this.hours);if(this.funfactCreateObj.hours=this.hours,null!==this.days){this.funfactCreateObj.days=this.days;const i=Number(this.funfactCreateObj.days);this.endDate=o(new Date(a.setDate(a.getDate()+i))).format("DD-MMM-YYYY HH:mm").replace(/-/g,"/")}if(y.L.isEmpty(this.days)){this.funfactCreateObj.days="0";const i=Number(this.funfactCreateObj.days);this.endDate=o(new Date(a.setDate(a.getDate()+i))).format("DD-MMM-YYYY HH:mm").replace(/-/g,"/")}this.endDate=new Date(a.setHours(a.getHours()+t)),this.endDate=new Date(a.setMinutes(a.getMinutes()+s)),this.funfactCreateObj.duration=this.commonService.changeDurationFormat(this.funfactCreateObj),this.funfactCreateObj.display_end_datetime=this.endDate}catch(a){this.loggerService.setLoggerError(this.constructor.name,"durationChanged",a)}}getTimeZone(a){try{this.commonService.getFilteredLookupCodes(this.dataJsonObj.lookupCodesListJSON[n.ox.TIME_ZONES],a).then(s=>{if(this.timezoneOptions=s,this.timezoneOptions.length>0){for(let t=0;t<this.timezoneOptions.length;t++)this.timezoneOptions[t].NAME=this.timezoneOptions[t].NAME+" - "+this.timezoneOptions[t].description;this.timezoneOptions=this.timezoneOptions}},s=>{this.loggerService.setLoggerError(this.constructor.name,"getLookupTypes",s)})}catch(s){this.loggerService.setLoggerError(this.constructor.name,"getTimeZone",s)}}changeTimeZone(a){try{this.defaultTimeZone=this.lookupLanguageTranslations(a.lookup_id);const i=a.description.split("(UTC")[1].split(")");this.utctimezone=i[0],this.utctimezonestring=i[0].toString()}catch(s){this.loggerService.setLoggerError(this.constructor.name,"changeTimeZone",s)}}getEndDate(a){try{this.error="",this.endDate=a.value;const s=o(a.value).format("YYYY-MM-DD HH:mm");if("-"===this.utctimezonestring.charAt(0)){const i=this.utctimezone.split("-")[1].split(":");this.enddate1=o(s).add(i[0],"hours"),this.enddate1=o(this.enddate1).add(i[1],"minutes")}else{const i=this.utctimezone.split("+")[1].split(":");this.enddate1=o(s).subtract(i[0],"hours"),this.enddate1=o(this.enddate1).subtract(i[1],"minutes")}if(new Date(this.startDate)>=new Date(this.endDate))this.endDate=new Date(3e5*Math.ceil(this.endDate.getTime()/3e5)),this.error="COMMON_VALIDATION_MESSAGES.VALID_NOBLANK_START_END_DATE";else{let t,i;this.endDate=new Date(3e5*Math.ceil(this.endDate.getTime()/3e5));const h=o.utc(o(this.endDate,"YYYY-MM-DD HH:mm").diff(o(this.startDate,"YYYY-MM-DD HH:mm"))).format("m");i=Number(h)<10?"0"+Number(h):Number(h);const l=o.utc(o(this.endDate,"YYYY-MM-DD HH:mm").diff(o(this.startDate,"YYYY-MM-DD HH:mm"))).format("H");t=Number(l)<10?"0"+Number(l):Number(l);const u=o.utc(o(this.endDate,"YYYY-MM-DD HH:mm").diff(o(this.startDate,"YYYY-MM-DD HH:mm")));this.hours=t,this.days=Math.floor(Number(u)/864e5),this.minutes=i,this.selecteddays=this.days,this.selectedduration=this.minutes,this.selectedhours=this.hours;const m={ID:this.hours,NAME:this.hours},f={ID:this.minutes,NAME:this.minutes};this.selectedData=[],this.selectedData.durationOptions=f,this.selectedData.hourOptions=m,this.selectedData.daysList=this.selecteddays,this.endDate=new Date(o(this.endDate).format("YYYY-MM-DD HH:mm").replace(/-/g,"/")),this.funfactCreateObj.duration=this.commonService.changeDurationFormat({days:this.days,hours:this.hours,minutes:this.minutes})}}catch(s){this.loggerService.setLoggerError(this.constructor.name,"getEndDate",s)}}changeDescription(a){this.description=a.value}cancel(){this.commonService.redirectToPreviousUrl()}createRecord(){try{new Date(this.endDate)<new Date(this.startDate)?this.error=this.translateService.instant("COMMON_VALIDATION_MESSAGES.VALID_NOBLANK_END_DATE_GREATER_START"):this.funfactvalidation.isValid()&&(this.funfactCreateObj.enterprise={enterprise_id:this.enterpriseId,enterprise_name:this.enterpriseName,short_name:this.enterpriseShortName},this.funfactCreateObj.funfact=this.funfact,this.funfactCreateObj.description=this.description,this.funfactCreateObj.is_enabled=this.isEnabled,this.funfactsService.create(this.funfactCreateObj).then(a=>{this.uiUtils.displaytoastMessage("COMMON_TOAST_MESSAGES.TOAST_SUCCESS_CREATE"),this.commonService.redirectToPreviousUrl()},a=>{this.commonErrorCodes(JSON.parse(a)),this.loggerService.setLoggerError(this.constructor.name,"createRecord",a)}))}catch(a){this.loggerService.setLoggerError(this.constructor.name,"createRecord",a)}}commonErrorCodes(a){switch(JSON.parse(a[n.BU.STATUS])){case 500:case 404:default:break;case 409:this.error=this.translateService.instant("COMMON_STATUS_CODES.409")}}pageheadeActionClick(a){"BACK"==a.value&&this.cancel()}static \u0275fac=function(s){return new(s||c)(e.Y36(g.F0),e.Y36(g.gz),e.Y36(_.f),e.Y36(D),e.Y36(O.s),e.Y36(S.v),e.Y36(b.sK),e.Y36(M.m))};static \u0275cmp=e.Xpm({type:c,selectors:[["app-funfacts-create"]],viewQuery:function(s,t){if(1&s&&e.Gf(ae,5),2&s){let i;e.iGM(i=e.CRH())&&(t.funfactvalidation=i.first)}},features:[e._Bn([D,O.s]),e.qOj],decls:47,vars:48,consts:[[1,"container-fluid"],[1,"forms-wrapper"],[1,"row","g-0"],[1,"col-md-12"],[1,"card","bdt-0"],["id","stickyHeaderID",1,"card-header","card-header-primary"],[1,"subpage-header-title","w-100",3,"pageName","pageTitle","showPageHeaderItems","showDependencySubMenu"],["id","extraPaddingBottomID",1,"card-body"],[1,"row","form-bs"],[1,"col-md-3"],["mandatory","true","disabled","true","id","funfacts-create-enterprisename",3,"label","value"],[1,"col-md-8"],["mandatory","true","autoCaseFlag","false","disabled","false","id","funfacts-create-contractname",3,"label","value","valueChange"],["funfactvalidation",""],[1,"col-md-1","d-flex","align-items-center"],["label","","id","funfacts-create-enabled","mandatory","false",3,"options","checked","valueChange"],[1,"col-lg-3","col-md-6","datetimepicker"],[1,"row"],[1,"col-8","col-md-8","pe-0"],["mandatory","true","dateformat","dd-MMM-yyyy","disabled","false","id","reservation-create-start-date",3,"placeholder","defaultDate","editvalueChange"],[1,"col-4","col-md-4","ps-2"],["disabled","false","mandatory","true",3,"label","options","defaultValue","selectedOption","searchValueChange"],[1,"col-md-4"],[3,"data","selectedInfoData","changeDuration"],["mandatory","true","dateformat","dd-MMM-yyyy","disabled","false","id","reservation-create-end-date",3,"placeholder","defaultDate","editvalueChange"],[1,"col-lg-12","col-md-9"],["mandatory","false","disabled","false","id","funfacts-create-notes",3,"label","defaultvalue","maxlength","valueChange"],[1,"error-msg","col-md-12","text-danger","text-center","mb-0"],[1,"col-md-12","text-end","mt-2","btns-group","pdl-0"],["className","btn btn-primary btn-sm","id","funfacts-create-submit",1,"mgr-5",3,"label","buttonOnClick"],["className","btn btn-danger btn-sm","id","funfacts-create-cancel",3,"label","buttonOnClick"]],template:function(s,t){1&s&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5),e._UZ(6,"app-pageheader",6),e.qZA(),e.TgZ(7,"div",7)(8,"div",8)(9,"div",9),e._UZ(10,"app-input",10),e.ALo(11,"translate"),e.qZA(),e.TgZ(12,"div",11)(13,"app-input",12,13),e.NdJ("valueChange",function(r){return t.changeFunfact(r)}),e.ALo(15,"translate"),e.qZA()(),e.TgZ(16,"div",14)(17,"app-checkbox",15),e.NdJ("valueChange",function(r){return t.changeEnabledvalue(r)}),e.qZA()(),e.TgZ(18,"div",16)(19,"div",17)(20,"div",18)(21,"app-datetimepicker",19),e.NdJ("editvalueChange",function(r){return t.changeStartDate(r)}),e.ALo(22,"translate"),e.qZA()(),e.TgZ(23,"div",20)(24,"app-dropdown-search",21),e.NdJ("selectedOption",function(r){return t.changeTimeZone(r)})("searchValueChange",function(r){return t.getTimeZone(r)}),e.ALo(25,"translate"),e.qZA()()()(),e.TgZ(26,"div",22)(27,"app-event-duration",23),e.NdJ("changeDuration",function(r){return t.changeDuration(r)}),e.qZA()(),e.TgZ(28,"div",16)(29,"div",17)(30,"div",18)(31,"app-datetimepicker",24),e.NdJ("editvalueChange",function(r){return t.getEndDate(r)}),e.ALo(32,"translate"),e.qZA()(),e.TgZ(33,"div",20)(34,"app-dropdown-search",21),e.NdJ("selectedOption",function(r){return t.changeTimeZone(r)})("searchValueChange",function(r){return t.getTimeZone(r)}),e.ALo(35,"translate"),e.qZA()()()(),e.TgZ(36,"div",25)(37,"app-textarea",26),e.NdJ("valueChange",function(r){return t.changeDescription(r)}),e.ALo(38,"translate"),e.qZA()(),e.TgZ(39,"div",27),e._uU(40),e.ALo(41,"translate"),e.qZA(),e.TgZ(42,"div",28)(43,"app-button",29),e.NdJ("buttonOnClick",function(){return t.createRecord()}),e.ALo(44,"translate"),e.qZA(),e.TgZ(45,"app-button",30),e.NdJ("buttonOnClick",function(){return t.cancel()}),e.ALo(46,"translate"),e.qZA()()()()()()()()()),2&s&&(e.xp6(6),e.Q6J("pageName",t.dataJsonObj.pageName)("pageTitle",t.dataJsonObj.pageTitle)("showPageHeaderItems",!1)("showDependencySubMenu",!1),e.xp6(4),e.s9C("label",e.lcZ(11,28,"COMMON_PAGE_TITLES.ENTERPRISE")),e.s9C("value",t.enterpriseShortName),e.xp6(3),e.s9C("label",e.lcZ(15,30,"NEW_VARIABLES.FUNFACT")),e.s9C("value",t.funfact),e.xp6(4),e.Q6J("options",t.checkboxOptions)("checked",t.isEnabled),e.xp6(4),e.s9C("placeholder",e.lcZ(22,32,"COMMON_FIELDS.START_DATE")),e.Q6J("defaultDate",t.startDate),e.xp6(3),e.s9C("label",e.lcZ(25,34,"PREFERENCES.TIMEZONE")),e.s9C("defaultValue",t.defaultTimeZone),e.Q6J("options",t.timezoneOptions),e.xp6(3),e.Q6J("data",t.durationObj)("selectedInfoData",t.selectedData),e.xp6(4),e.s9C("placeholder",e.lcZ(32,36,"COMMON_FIELDS.END_DATE")),e.Q6J("defaultDate",t.endDate),e.xp6(3),e.s9C("label",e.lcZ(35,38,"PREFERENCES.TIMEZONE")),e.s9C("defaultValue",t.defaultTimeZone),e.Q6J("options",t.timezoneOptions),e.xp6(3),e.s9C("label",e.lcZ(38,40,"COMMON_FIELDS.NOTES")),e.s9C("defaultvalue",t.description),e.Q6J("maxlength",2e3),e.xp6(3),e.hij(" ",e.lcZ(41,42,t.error)," "),e.xp6(3),e.s9C("label",e.lcZ(44,44,"COMMON_BUTTONS.BUTTON_SUBMIT")),e.xp6(2),e.s9C("label",e.lcZ(46,46,"COMMON_BUTTONS.BUTTON_CANCEL")))},dependencies:[L.r,U.a,F.b,j.R,R.L,B.C,P.w,A.q,b.X$]})}return c})();class ie{enterprise;display_start_datetime;display_end_datetime;description;is_enabled;days;hours;minutes;duration;funfact}const ne=[{path:"",data:{title:"funfacts"},children:[{path:"list",canActivate:[v.P],component:Y,data:{object_type:n.hf.FUNFACTS,title:"",responsibilityParam:n.bP.MENUS+"."+n.w1.ENTERPRISES+"."+n.bP.SUBMENUS+"."+n.w1.FUNFACTS+"."+n.Iu.ENABLED,pageName:n.hf.FUNFACTS}},{path:":id/edit",canActivate:[v.P],component:ee,data:{object_type:n.hf.FUNFACTS,title:"",responsibilityParam:n.bP.MENUS+"."+n.w1.ENTERPRISES+"."+n.bP.SUBMENUS+"."+n.w1.FUNFACTS+"."+n.In.EDIT,pageName:n.hf.FUNFACTS,pageSetting:n.AM.ACTIONS,settingField:n.In.EDIT}},{path:"create",canActivate:[v.P],component:se,data:{object_type:n.hf.FUNFACTS,title:"",responsibilityParam:n.bP.MENUS+"."+n.w1.ENTERPRISES+"."+n.bP.SUBMENUS+"."+n.w1.FUNFACTS+"."+n.In.CREATE,pageName:n.hf.FUNFACTS,pageSetting:n.AM.ACTIONS,settingField:n.In.CREATE}},{path:"view",canActivate:[v.P],component:x,data:{object_type:n.hf.FUNFACTS,title:"",responsibilityParam:n.bP.MENUS+"."+n.w1.ENTERPRISES+"."+n.bP.SUBMENUS+"."+n.w1.FUNFACTS+"."+n.In.VIEW,pageName:n.hf.FUNFACTS,pageSetting:n.AM.ACTIONS,settingField:n.In.VIEW}},{path:"enterprisesfunfacts-list",canActivate:[v.P],component:Y,data:{object_type:n.hf.FUNFACTS,title:"",responsibilityParam:n.bP.MENUS+"."+n.w1.ENTERPRISES+"."+n.bP.SUBMENUS+"."+n.w1.FUNFACTS+"."+n.Iu.ENABLED,pageName:n.hf.FUNFACTS}}]}];let re=(()=>{class c{static \u0275fac=function(s){return new(s||c)};static \u0275mod=e.oAB({type:c});static \u0275inj=e.cJS({imports:[g.Bz.forChild(ne),g.Bz]})}return c})();var k=d(24006),oe=d(93144),de=d(65673);let ce=(()=>{class c{static \u0275fac=function(s){return new(s||c)};static \u0275mod=e.oAB({type:c});static \u0275inj=e.cJS({imports:[H.ez,re,b.aw,k.u5,k.UX,oe.U$,I.fx,de.Q]})}return c})()}}]);