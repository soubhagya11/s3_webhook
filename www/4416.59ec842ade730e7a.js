"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4416],{74416:(Je,V,d)=>{d.r(V),d.d(V,{MenusettingsbyroleModule:()=>Se});var T=d(32174),f=d(36895),m=d(24006),E=d(93144),j=d(54463),G=d(73518),q=d(65673),N=d(11210),r=d(32236),y=d(62510),h=d(15861),e=d(94650),F=d(42863),I=d(71568),M=d(47561),Q=d(28168),k=d(30578),A=d(42786),C=d(27601),H=d(75875),Z=d(90313);let S=(()=>{class o{authService;constructor(t){this.authService=t}getAll(t,s,a,n,i,l,u,c,p){var g=this;return(0,h.Z)(function*(){const O=l?"&condition="+l:"",D=c||"",J=Z.L.isEmpty(p)?"":"&advSearchString="+JSON.stringify(p);return Z.L.isEmpty(O)?yield g.authService.getApiCallAsync("api/v1/menusettingsbyrole?enterprise.enterprise_id="+i+"&skip="+t+"&limit="+s+"&sort="+a+"&type=list&search="+n+u+D+J,!0):yield g.authService.getApiCallAsync("api/v1/menusettingsbyrole?enterprise.enterprise_id="+i+"&skip="+t+"&limit="+s+"&sort="+a+"&type=list&search="+n+O+u+D+J,!0)})()}get(t){return new Promise((s,a)=>{this.authService.getApiCall("api/v1/menusettingsbyrole/"+t).subscribe(n=>{s(n)},n=>{a(n)})})}update(t,s){return new Promise((a,n)=>{this.authService.putApiCall("api/v1/menusettingsbyrole/"+t,s).subscribe(i=>{a(i)},i=>{n(i)})})}create(t){return new Promise((s,a)=>{this.authService.postApiCall("api/v1/menusettingsbyrole",t).subscribe(n=>{s(n)},n=>{a(n)})})}getModuleConfigurations(t){return new Promise((s,a)=>{this.authService.getApiCall("api/v1/moduleviewconfigurations?type=drop&ENTERPRISE_ID="+t).subscribe(n=>{s(n)},n=>{a(n)})})}getUserRoleListById(){const t=localStorage.getItem(r.BU.USER_ID);return new Promise((s,a)=>{this.authService.getApiCall("api/v1/userroles?type=drop&UserId="+t).subscribe(n=>{s(n)},n=>{a(n)})})}getOperatingUnitData(t){return new Promise((s,a)=>{this.authService.getApiCall("api/v1/enterprises?type=drop&search="+t).subscribe(n=>{s(n)},n=>{a(n)})})}getUserRolesFromRoleRights(t){return new Promise((s,a)=>{this.authService.getApiCall("api/v1/menusettingsbyrole?type=drop&enterprise.enterprise_id="+t).subscribe(n=>{s(n)},n=>{a(n)})})}getDynamicFieldsList(t,s){return(0,h.Z)(function*(){const a={},n=Object.keys(s);for(let l of n)for(let u of s[l]){const c=[],p=Object.keys(u.actions);for(let g of p)if(u.actions[g]){const O={field:g,is_enabled:u.actions[g],value:"",displayname:g.split("_").join(" ")};c.push(O)}c.length>0&&(a[u.module.page_id+""]={actions:c,is_enabled:!0,page_name:u.module.page_name})}const i=[];for(let l of t){const u={menu_management_id:l._id,menu_name:l.menu_name,displayname:l.menu_display_name,is_enabled:!0,value:"",submenu:[]};for(let c of l.submenu){const p=a[c.submenu_page.page_id+""];p&&u.submenu.push({submenu_id:c.submenu_id,submenu_page:{page_id:c.submenu_page.page_id,page_name:c.submenu_page.page_name},displayname:c.submenu_display_name,value:"",is_enabled:p.is_enabled,actions:p.actions,page_name:p.page_name,settings:{display_name:c.submenu_display_name}})}u.submenu.length>0&&i.push(u)}return i})()}getSelectedRolesRightsDataJsonObj(t){return(0,h.Z)(function*(){const s={};for(let a of t){s[a.menu_management_id+""]||(s[a.menu_management_id+""]={}),s[a.menu_management_id+""].is_enabled=a.is_enabled;for(let n of a.submenu)s[a.menu_management_id+""].submenuJson||(s[a.menu_management_id+""].submenuJson={}),s[a.menu_management_id+""].submenuJson[n.submenu_page.page_id+""]||(s[a.menu_management_id+""].submenuJson[n.submenu_page.page_id+""]={}),s[a.menu_management_id+""].submenuJson[n.submenu_page.page_id+""].is_enabled=n.is_enabled}return s})()}updateSelectedRoleRightInRoleRightsArray(t,s){return(0,h.Z)(function*(){for(let a of t)if(s[a.menu_management_id+""]){a.is_enabled=s[a.menu_management_id+""].is_enabled;for(let n of a.submenu)n.is_enabled=s[a.menu_management_id+""].submenuJson[n.submenu_page.page_id+""].is_enabled}})()}static \u0275fac=function(s){return new(s||o)(e.LFG(H.e))};static \u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var K=d(70057),R=d(37415),$=d(88425);const z=["datatableComponent"];let W=(()=>{class o extends M.O{actionSheetController;columnsHeaders;loggerService;router;translateService;commonService;listingVariables;route;uiUtils;menuSettingsByRoleService;datatableComponent;searchValueChange=new e.vpe;dataJsonObj={};errorObj={};fabMobileactions;constructor(t,s,a,n,i,l,u,c,p,g){super(c,l),this.actionSheetController=t,this.columnsHeaders=s,this.loggerService=a,this.router=n,this.translateService=i,this.commonService=l,this.listingVariables=u,this.route=c,this.uiUtils=p,this.menuSettingsByRoleService=g,this.route.queryParams.subscribe(O=>{this.dataJsonObj.queryParamsObj={defaultView:O.default_view,selectedMenuId:O.selectedMenuId,selectedSubMenuId:O.selectedSubMenuId}})}ngOnInit(){this.initializeComponent()}initializeComponent(){this.showSpinner(),this.dataJsonObj.advancedSearchObj={},this.dataJsonObj.pageName=r.hf.MENU_SETTINGS_BY_ROLE,this.dataJsonObj.htmlPageRolesEnumValuesJson={pageEnum:r.hf,pageSettingEnum:r.AM,pageSettingFieldsEnum:r.In},this.dataJsonObj.pageTitle=[{key:"COMMON_FIELDS.ALL",value:"",showSubMenuDisplayName:!1},{key:"COMMON_PAGE_TITLES.ROLE_RIGHTS",value:"",showSubMenuDisplayName:!0}],this.dataJsonObj.noDuplicates=void 0,this.commonService.trackView(r.sn.ROLERIGHTS_LIST),this.dataJsonObj.selectedEnterpriseId=localStorage.getItem(r.BU.SELECTED_ENTERPRISE),this.dataJsonObj.selectedMenu=JSON.parse(localStorage.getItem(r.BU.SELECTED_MENU)),this.dataJsonObj.selectedSubMenu=JSON.parse(localStorage.getItem(r.BU.MENU_CLICK_ITEM)),this.getDynamicJson([{folderName:"lookup_codes",jsonType:"view",storingFieldName:"lookupCodesViewJson"},{folderName:r.sb.USER_TYPES,jsonType:"view",storingFieldName:"userTypesViewJson"}]),this.dataJsonObj.mobilePageTitle=this.translateService.instant("COMMON_PAGE_TITLES.ROLE_RIGHTS"),this.dataJsonObj.header=this.columnsHeaders.getRoleRightsColumnHeaders(),this.dataJsonObj.searchString="",this.dataJsonObj.actionBoolean=!(!this.roleRightsValidationByPage(r.hf.MENU_SETTINGS_BY_ROLE,r.AM.ACTIONS,r.In.ACTIVATE)||!this.roleRightsValidationByPage(r.hf.MENU_SETTINGS_BY_ROLE,r.AM.ACTIONS,r.In.INACTIVATE)),this.dataJsonObj.actions={EDIT:!0,CHECKBOX:this.dataJsonObj.actionBoolean,VIEW:this.roleRightsValidationByPage(r.hf.MENU_SETTINGS_BY_ROLE,r.AM.ACTIONS,r.In.VIEW)},this.dataJsonObj.addFiltersList=[],this.dataJsonObj.pageActionsList=[],this.roleRightsValidationByPage(r.hf.MENU_SETTINGS_BY_ROLE,r.AM.ACTIONS,r.In.CREATE)&&this.dataJsonObj.pageActionsList.push({actionName:"CREATE",displayName:"COMMON_BUTTONS.BUTTON_CREATE",actionType:r.gL.URL,redirectURL:"/configoptions/menusettingsbyrole/create",queryParams:"",iconClass:"fas fa-plus"}),this.roleRightsValidationByPage(r.hf.MENU_SETTINGS_BY_ROLE,r.AM.ACTIONS,r.In.FILTERS)}getSearchResult(t){}ionViewWillEnter(){this.dataJsonObj.actions={EDIT:!0,CHECKBOX:this.dataJsonObj.actionBoolean,VIEW:this.roleRightsValidationByPage(r.hf.MENU_SETTINGS_BY_ROLE,r.AM.ACTIONS,r.In.VIEW)}}getDynamicJson(t){var s=this;return(0,h.Z)(function*(){for(let a of t)try{s.dataJsonObj[a.storingFieldName]=yield s.commonService.getDynamicJson(s.dataJsonObj.selectedEnterpriseId,a.folderName,a.jsonType)}catch{s.dataJsonObj[a.storingFieldName]={}}})()}getSearchItem(t){try{this.listingVariables.pageNumbers=1,this.listingVariables.totalRecords=1,this.dataJsonObj.searchString=t,this.getAllRecords(),this.datatableComponent.reset(),this.searchValueChange.emit(t)}catch(s){this.loggerService.setLoggerError(this.constructor.name,"getSearchItem",s)}}searchClose(){try{this.dataJsonObj.searchString="",this.listingVariables.pageNumbers=1,this.listingVariables.totalRecords=1,this.getAllRecords(),this.datatableComponent.reset(),this.searchValueChange.emit("")}catch(t){this.loggerService.setLoggerError(this.constructor.name,"searchClose",t)}}showSpinner(){this.dataJsonObj.showSpinner=!0}hideSpinner(){this.dataJsonObj.showSpinner=!1}getAllRecords(){var t=this;return(0,h.Z)(function*(){try{const s=t.commonService.getMobileViewCondition(t.dataJsonObj.selectedDisplayView),a=t.dataJsonObj.selectedFilter?"&filtertype="+t.dataJsonObj.selectedFilter:"";t.showSpinner();const n=yield t.menuSettingsByRoleService.getAll(t.listingVariables.pageNumbers,t.listingVariables.rowsPerPage,t.listingVariables.sortOrderColumn,t.dataJsonObj.searchString,t.dataJsonObj.selectedEnterpriseId,t.dataJsonObj.statusObj,s,a,t.dataJsonObj.advancedSearchObj.inputAdvSearchObj);if(t.hideSpinner(),n.rows.length>0){t.dataJsonObj.mobileDataList||(t.dataJsonObj.mobileDataList=[]);for(let i=0;i<n.rows.length;i++)n.rows[i].firstLineDisplay=n.rows[i].role_display_name,n.rows[i].secondLineDisplay=!0===n.rows[i].is_enabled?"Status : Active":"Status : Inactive",n.rows[i].updated_by&&(n.rows[i].thirdLineDisplay="Updated By: "+n.rows[i].updated_by.l_name+" "+n.rows[i].updated_by.f_name,n.rows[i].updated_by=n.rows[i].updated_by.l_name+" "+n.rows[i].updated_by.f_name),n.rows[i].enterprise.short_name='<a class="enable" id="enterprise.short_name'+n.rows[i]._id+'" href="enterprises/enterprises/'+n.rows[i].enterprise.enterprise_id+'/view">'+n.rows[i].enterprise.short_name+"</a>",n.rows[i].is_enabled=!0===n.rows[i].is_enabled?"Yes":"No",n.rows[i].user_type_display_name=t.dataJsonObj.userTypesViewJson&&t.dataJsonObj.userTypesViewJson[n.rows[i].user_type_id+""]?t.dataJsonObj.userTypesViewJson[n.rows[i].user_type_id+""].user_type_display_name:"--",t.dataJsonObj.mobileDataList=t.dataJsonObj.mobileDataList.filter(l=>l._id!==n.rows[i]._id),t.dataJsonObj.mobileDataList.push(n.rows[i]);n.totalCount&&(t.listingVariables.totalRecords=n.totalCount),1===t.listingVariables.pageNumbers&&(t.listingVariables.totalpages=n.pages),t.dataJsonObj.isLoadMoreClicked?(t.dataJsonObj.isLoadMoreClicked=!1,t.dataJsonObj.dataList=t.dataJsonObj.dataList.concat(n.rows)):t.dataJsonObj.dataList=n.rows}else t.dataJsonObj.dataList=[],t.dataJsonObj.mobileDataList=[]}catch(s){t.hideSpinner(),t.loggerService.setLoggerError(t.constructor.name,"getAllRecords",s)}})()}loadPageData(t){this.listingVariables.pageNumbers=t.listingVariables.pageNumbers,t.clearMobileData&&(this.dataJsonObj.mobileDataList=this.dataJsonObj.noDuplicates),t.isPaginationChange&&(this.dataJsonObj.selectedFilter=t.selectedFilterType,this.dataJsonObj.isLoadMoreClicked=t.isLoadMoreClicked,this.dataJsonObj.advancedSearchObj.inputAdvSearchObj=t.selectedAdvancedSearchObj),this.getAllRecords()}onActionClicked(t){try{t.action===r.A0.EDIT?this.router.navigate(["/configoptions/menusettingsbyrole/"+t.data._id+"/edit"]):t.action===r.A0.VIEW?this.commonService.redirectToUrl(["..",t.data._id,"view"],!0,!0,this.dataJsonObj.queryParamsObj?this.dataJsonObj.queryParamsObj:"",this.route):t.action===r.A0.CHECKBOX&&(this.dataJsonObj.actionStatus=t.data.isEnabled,this.menuSettingsByRoleService.update(t.data._id,{is_enabled:this.dataJsonObj.actionStatus}).then(a=>{this.uiUtils.displaytoastMessage(!0===this.dataJsonObj.actionStatus?"COMMON_TOAST_MESSAGES.TOAST_SUCCESS_ACTIVATE":"COMMON_TOAST_MESSAGES.TOAST_SUCCESS_INACTIVATE"),this.getAllRecords()}).catch(a=>{this.loggerService.setLoggerError(this.constructor.name,"onActionClicked",a)}))}catch(s){this.loggerService.setLoggerError(this.constructor.name,"onActionClicked",s)}}toggle(){this.dataJsonObj.show=!this.dataJsonObj.show}statusData(t){try{this.dataJsonObj.statusObj=t.value,this.getAllRecords()}catch(s){this.loggerService.setLoggerError(this.constructor.name,"statusData",s)}}mobileEventAction(t){this.presentActionSheet(t)}presentActionSheet(t){var s=this;return(0,h.Z)(function*(){try{const a=[];s.roleRightsValidationByPage(r.hf.MENU_SETTINGS_BY_ROLE,r.AM.ACTIONS,r.In.EDIT)&&a.push({text:s.translateService.instant("COMMON_BUTTONS.BUTTON_EDIT"),handler:()=>{s.router.navigate(["/configoptions/menusettingsbyrole/"+t._id+"/edit"])}}),s.roleRightsValidationByPage(r.hf.MENU_SETTINGS_BY_ROLE,r.AM.ACTIONS,r.In.VIEW)&&a.push({text:s.translateService.instant("COMMON_BUTTONS.BUTTON_VIEW"),handler:()=>{s.commonService.redirectToUrl(["..",t._id,"view"],!0,!0,s.dataJsonObj.queryParamsObj?s.dataJsonObj.queryParamsObj:"",s.route)}}),!0===t.isEnabled&&s.roleRightsValidationByPage(r.hf.MENU_SETTINGS_BY_ROLE,r.AM.ACTIONS,r.In.INACTIVATE)?a.push({text:s.translateService.instant("COMMON_BUTTONS.BUTTON_INACTIVATE"),handler:()=>{s.editRecord(t)}}):s.roleRightsValidationByPage(r.hf.MENU_SETTINGS_BY_ROLE,r.AM.ACTIONS,r.In.ACTIVATE)&&a.push({text:s.translateService.instant("COMMON_BUTTONS.BUTTON_ACTIVATE"),handler:()=>{s.editRecord(t)}}),yield(yield s.actionSheetController.create({cssClass:"actionsheet",buttons:a})).present()}catch(a){s.loggerService.setLoggerError(s.constructor.name,"presentActionSheet",a)}})()}editRecord(t){this.dataJsonObj.actionStatus=!t.isEnabled;const s=this.dataJsonObj.actionStatus?"COMMON_TOAST_MESSAGES.TOAST_SUCCESS_ACTIVATE":"COMMON_TOAST_MESSAGES.TOAST_SUCCESS_INACTIVATE";this.menuSettingsByRoleService.update(t._id,{is_enabled:this.dataJsonObj.actionStatus}).then(n=>{this.uiUtils.displaytoastMessage(s),this.dataJsonObj.mobileDataList=[],this.getAllRecords()})}Create(){try{this.router.navigate(["/configoptions/menusettingsbyrole/create"])}catch(t){this.loggerService.setLoggerError(this.constructor.name,"Create",t)}}createRolerights(){try{return this.roleRightsValidation(this.dataJsonObj.selectedMenu.menu_name,this.dataJsonObj.selectedSubMenu.submenu_page.page_name,r.A0.CREATE)}catch(t){this.loggerService.setLoggerError(this.constructor.name,"createRolerights",t)}}selectedViewType(t){this.dataJsonObj.selectedDisplayView=t}selectedFilterType(t){t?this.dataJsonObj.selectedFilter=t:(this.dataJsonObj.selectedFilter="",this.dataJsonObj.selectedAdvancedSearchObj={})}onPageLevelActionClicked(t){}advancedSearchFilterClicked(t){this.dataJsonObj.selectedAdvancedSearchObj=t}onHeaderItemClick(t){switch(t.type){case"search":this.getSearchResult(t.event);break;case"search_close":this.searchClose();break;case"display_views":this.selectedViewType(t.event);break;case"filters":this.selectedFilterType(t.event);break;case"advanced_search":this.advancedSearchFilterClicked(t.event);break;case"page_actions":this.onPageLevelActionClicked(t.event)}}static \u0275fac=function(s){return new(s||o)(e.Y36(K.BX),e.Y36(F.Y),e.Y36(A.m),e.Y36(y.F0),e.Y36(j.sK),e.Y36(I.v),e.Y36(k.v),e.Y36(y.gz),e.Y36(C.s),e.Y36(S))};static \u0275cmp=e.Xpm({type:o,selectors:[["app-menusettingsbyrole-list"]],viewQuery:function(s,a){if(1&s&&e.Gf(z,5),2&s){let n;e.iGM(n=e.CRH())&&(a.datatableComponent=n.first)}},outputs:{searchValueChange:"searchValueChange"},features:[e._Bn([k.v,F.Y,S,C.s]),e.qOj],decls:8,vars:30,consts:[[1,"container-fluid"],[1,"card","bd-0"],["id","stickyHeaderID",1,"card-header","card-header-primary"],[1,"subpage-header-title","w-100",3,"pageName","defaultView","isFabDisplay","pageActionsList","pageTitle","selectedMenuId","selectedSubMenuId","showPageHeaderItems","showDependencySubMenu","headerItemClick"],["id","extraPaddingBottomID",1,"card-body","pdt-0"],[1,"",3,"header","listingVariables","totalRecords","actions","paginator","totalPages","mobileListData","data","expand","statsShow","showRights","statsSearch","selectedDisplayViewType","selectedFilterType","selectedAdvancedSearchObj","pageName","selectedMenuId","selectedSubMenuId","redirectionEvent","actionClicked","changeStats","loadPageData"],[1,"mgt-5"],[3,"isFabDisplay","actionsList","selectedAction"]],template:function(s,a){1&s&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"app-pageheader",3),e.NdJ("headerItemClick",function(i){return a.onHeaderItemClick(i)}),e.qZA()(),e.TgZ(4,"div",4)(5,"app-datatable",5),e.NdJ("redirectionEvent",function(i){return a.mobileEventAction(i)})("actionClicked",function(i){return a.onActionClicked(i)})("changeStats",function(i){return a.statusData(i)})("loadPageData",function(i){return a.loadPageData(i)}),e.qZA(),e.TgZ(6,"div",6)(7,"app-page-actions",7),e.NdJ("selectedAction",function(i){return a.onPageLevelActionClicked(i)}),e.qZA()()()()()),2&s&&(e.xp6(3),e.Q6J("pageName",a.dataJsonObj.pageName)("defaultView",null==a.dataJsonObj.queryParamsObj?null:a.dataJsonObj.queryParamsObj.defaultView)("isFabDisplay",!1)("pageActionsList",a.dataJsonObj.pageActionsList)("pageTitle",a.dataJsonObj.pageTitle)("selectedMenuId",null==a.dataJsonObj.queryParamsObj?null:a.dataJsonObj.queryParamsObj.selectedMenuId)("selectedSubMenuId",null==a.dataJsonObj.queryParamsObj?null:a.dataJsonObj.queryParamsObj.selectedSubMenuId)("showPageHeaderItems",!0)("showDependencySubMenu",!1),e.xp6(2),e.Q6J("header",a.dataJsonObj.header)("listingVariables",a.listingVariables)("totalRecords",a.listingVariables.totalRecords)("actions",a.dataJsonObj.actions)("listingVariables",a.listingVariables)("paginator",!0)("totalPages",a.listingVariables.totalpages)("mobileListData",a.dataJsonObj.mobileDataList)("data",a.dataJsonObj.dataList)("expand",!1)("statsShow",a.dataJsonObj.show)("showRights",a.roleRightsValidationByPage(a.dataJsonObj.htmlPageRolesEnumValuesJson.pageEnum.ROLE_RIGHTS,a.dataJsonObj.htmlPageRolesEnumValuesJson.pageSettingEnum.ACTIONS,a.dataJsonObj.htmlPageRolesEnumValuesJson.pageSettingFieldsEnum.STATS))("statsSearch",a.dataJsonObj.searchString)("selectedDisplayViewType",a.dataJsonObj.selectedDisplayView)("selectedFilterType",a.dataJsonObj.selectedFilter)("selectedAdvancedSearchObj",a.dataJsonObj.selectedAdvancedSearchObj)("pageName",a.dataJsonObj.pageName)("selectedMenuId",null==a.dataJsonObj.queryParamsObj?null:a.dataJsonObj.queryParamsObj.selectedMenuId)("selectedSubMenuId",null==a.dataJsonObj.queryParamsObj?null:a.dataJsonObj.queryParamsObj.selectedSubMenuId),e.xp6(2),e.Q6J("isFabDisplay",!0)("actionsList",a.dataJsonObj.pageActionsList))},dependencies:[Q.n,R.q,$.y]})}return o})();var v=d(10805),L=d(2387),w=d(56368),B=d(93837),P=d(11735);const x=function(o){return[o]};function X(o,b){if(1&o){const t=e.EpF();e.TgZ(0,"tr")(1,"td",30)(2,"app-checkbox",31),e.NdJ("valueChange",function(a){const i=e.CHM(t).$implicit,l=e.oxw(4);return e.KtG(l.changeCheckBoxValue(a,"is_enabled",i))}),e.qZA()()()}if(2&o){const t=b.$implicit;e.xp6(2),e.Q6J("options",e.VKq(2,x,t))("checked",null==t?null:t.is_enabled)}}function ee(o,b){if(1&o&&e.YNc(0,X,3,4,"tr",29),2&o){const t=e.oxw().$implicit;e.Q6J("ngForOf",t.submenu)}}function te(o,b){if(1&o){const t=e.EpF();e.TgZ(0,"p-accordionTab",25)(1,"p-header")(2,"app-checkbox",26),e.NdJ("click",function(a){e.CHM(t);const n=e.oxw(2);return e.KtG(n.onMouseClick(a))})("valueChange",function(a){const i=e.CHM(t).$implicit,l=e.oxw(2);return e.KtG(l.changeCheckBoxValue(a,"is_enabled",i))}),e.qZA()(),e.TgZ(3,"p-table",27),e.YNc(4,ee,1,1,"ng-template",28),e.qZA()()}if(2&o){const t=b.$implicit,s=e.oxw(2);e.MGl("id","",t.menu_management_id,"_tab_id"),e.Q6J("selected",!1),e.xp6(2),e.Q6J("options",e.VKq(8,x,t))("checked",null==t?null:t.is_enabled),e.xp6(1),e.Q6J("value",s.dataJsonObj.data)("rows",1)("responsive",!0)("autoLayout",!1)}}function ae(o,b){if(1&o&&(e.TgZ(0,"span"),e.YNc(1,te,5,10,"p-accordionTab",24),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.dataJsonObj.inputObj.role_rights)}}let se=(()=>{class o extends M.O{formBuilder;loggerService;translateService;commonService;route;router;uiUtils;menuSettingsByRoleService;dataJsonObj={};errorObj={};pageTitle;constructor(t,s,a,n,i,l,u,c){super(i,n),this.formBuilder=t,this.loggerService=s,this.translateService=a,this.commonService=n,this.route=i,this.router=l,this.uiUtils=u,this.menuSettingsByRoleService=c}ngOnInit(){this.initializeComponent()}initializeComponent(){this.dataJsonObj.pageName=r.hf.ROLE_RIGHTS,this.commonService.trackView(r.sn.ROLERIGHTS_EDIT),this.route.params.subscribe(s=>{this.dataJsonObj.recordId=s.id}),this.dataJsonObj.selectedEnterpriseId=localStorage.getItem(r.BU.SELECTED_ENTERPRISE),this.dataJsonObj.data=[{}],this.dataJsonObj.isSubmitButtonDisabled=!1,this.dataJsonObj.inputObj={is_enabled:!0},this.dataJsonObj.showrecordhistory=this.roleRightsValidationByPage(r.hf.ROLE_RIGHTS,r.AM.ACTIONS,r.In.RECORD_HISTORY),this.getDynamicJson([{folderName:"lookup_codes",jsonType:"view",storingFieldName:"lookupCodesViewJson"},{folderName:"module_manager",jsonType:"list",storingFieldName:"moduleManagerListJson"},{folderName:"module_manager",jsonType:"view",storingFieldName:"moduleManagerViewJson"},{folderName:"menu_manager",jsonType:"",storingFieldName:"menuManagerJson"},{folderName:r.sb.USER_TYPES,jsonType:"view",storingFieldName:"userTypesViewJson"}]),this.dataJsonObj.enabledOptions=[{value:"",displayname:this.translateService.instant("COMMON_FIELDS.ENABLED"),key:"checkbox1"}],this.dataJsonObj.selectedEnterpriseObj=this.commonService.getSelcetedEnterpriseObj(),this.dataJsonObj.inputObj.enterprise=this.dataJsonObj.selectedEnterpriseObj,this.dataJsonObj.firstFormGroup=this.formBuilder.group({firstCtrl:["",m.kI.required]})}getDynamicJson(t){var s=this;return(0,h.Z)(function*(){for(let a of t)try{s.dataJsonObj[a.storingFieldName]=yield s.commonService.getDynamicJson(s.dataJsonObj.selectedEnterpriseId,a.folderName,a.jsonType)}catch{s.dataJsonObj[a.storingFieldName]={}}s.getRecordById(s.dataJsonObj.recordId)})()}getDynamicFieldsList(){var t=this;return(0,h.Z)(function*(){try{t.dataJsonObj.inputObj.role_rights=yield t.menuSettingsByRoleService.getDynamicFieldsList(t.dataJsonObj.menuManagerJson,t.dataJsonObj.moduleManagerListJson),t.applyExistingRoleRightData(t.dataJsonObj.recordData.role_rights)}catch(s){t.loggerService.setLoggerError(t.constructor.name,"getDynamicFieldsList",s)}})()}getRecordById(t){try{this.menuSettingsByRoleService.get(t).then(s=>{this.dataJsonObj.recordData=s,this.dataJsonObj.inputObj=JSON.parse(JSON.stringify(s)),this.dataJsonObj.inputObj.user_type_display_name=this.dataJsonObj.inputObj.user_type_id&&this.dataJsonObj.userTypesViewJson&&this.dataJsonObj.userTypesViewJson[this.dataJsonObj.inputObj.user_type_id+""]?this.dataJsonObj.userTypesViewJson[this.dataJsonObj.inputObj.user_type_id+""].user_type_display_name:"",this.dataJsonObj.pageTitle=[{key:"COMMON_PAGE_TITLES.ROLE_RIGHTS",value:this.dataJsonObj?.inputObj?.user_type_display_name,showSubMenuDisplayName:!1},{key:"",value:"-",showSubMenuDisplayName:!1},{key:"COMMON_BUTTONS.BUTTON_EDIT",value:"",showSubMenuDisplayName:!1}],this.getDynamicFieldsList()},s=>{this.loggerService.setLoggerError(this.constructor.name,"getRecordById",s)})}catch(s){this.loggerService.setLoggerError(this.constructor.name,"getRecordById",s)}}applyExistingRoleRightData(t){var s=this;return(0,h.Z)(function*(){const a=yield s.menuSettingsByRoleService.getSelectedRolesRightsDataJsonObj(t);a&&(yield s.menuSettingsByRoleService.updateSelectedRoleRightInRoleRightsArray(s.dataJsonObj.inputObj.role_rights,a))})()}changeCheckBoxValue(t,s,a){try{a[s]=t.value}catch(n){this.loggerService.setLoggerError(this.constructor.name,"changeCheckBoxValue",n)}}onMouseClick(t){t.stopPropagation()}cancel(){try{this.commonService.redirectToPreviousUrl()}catch(t){this.loggerService.setLoggerError(this.constructor.name,"cancel",t)}}updateRecord(){try{this.dataJsonObj.isSubmitButtonDisabled=!0,this.menuSettingsByRoleService.update(this.dataJsonObj.recordId,{enterprise:this.dataJsonObj.inputObj.enterprise,user_type_id:this.dataJsonObj.inputObj.user_type_id,role_rights:this.dataJsonObj.inputObj.role_rights,is_enabled:!!this.dataJsonObj.inputObj.is_enabled&&this.dataJsonObj.inputObj.is_enabled}).then(s=>{this.uiUtils.displaytoastMessage("COMMON_TOAST_MESSAGES.TOAST_SUCCESS_EDIT"),this.commonService.redirectToPreviousUrl()},s=>{this.commonErrorCodes(JSON.parse(s)),this.loggerService.setLoggerError(this.constructor.name,"updateRecord",s)})}catch(t){this.loggerService.setLoggerError(this.constructor.name,"updateRecord",t)}}commonErrorCodes(t){try{const s=JSON.parse(t[r.BU.STATUS]);409===s&&(this.errorObj.error="COMMON_STATUS_CODES."+s)}catch(s){this.loggerService.setLoggerError(this.constructor.name,"commonErrorCodes",s)}}static \u0275fac=function(s){return new(s||o)(e.Y36(m.qu),e.Y36(A.m),e.Y36(j.sK),e.Y36(I.v),e.Y36(y.gz),e.Y36(y.F0),e.Y36(C.s),e.Y36(S))};static \u0275cmp=e.Xpm({type:o,selectors:[["app-menusettingsbyrole-edit"]],features:[e._Bn([S]),e.qOj],decls:32,vars:33,consts:[[1,"forms-wrapper"],[1,"row","g-0"],[1,"col-md-12"],[1,"card","bdt-0"],["id","stickyHeaderID",1,"card-header","card-header-primary"],[1,"subpage-header-title","w-100",3,"pageName","pageTitle","selectedMenuId","selectedSubMenuId","showPageHeaderItems","showDependencySubMenu"],[1,"card-body"],[3,"formGroup"],[1,"row","form-bs"],[1,"col-md-3"],["disabled","true","id","rolerights-view-enterprise",3,"label","value"],["disabled","true","id","rolerights-view-role",3,"label","value"],[1,"col-md-2","d-flex","align-items-center"],["label","","id","rolerights-view-enabled","disabled","true","mandatory","false",3,"options","checked"],[1,"col-lg-12","col-md-12","text-end","mt-2","mb-2","pdl-0"],["className","btn btn-primary btn-sm",1,"mgr-5",3,"label","buttonOnClick"],["className","btn btn-danger btn-sm",3,"label","buttonOnClick"],[1,"error-msg","col-md-12","text-danger","text-center","mb-0"],[1,"row"],[1,"card"],["id","extraPaddingBottomID",1,"card-content"],[3,"multiple"],[4,"ngIf"],[3,"createdBy","showrecordhistory","lastUpdatedBy","creationDate","lastUpdatedDate"],[3,"selected","id",4,"ngFor","ngForOf"],[3,"selected","id"],["label","","psClassName","accordion-checkbox",1,"rolerights-checkbox",3,"options","checked","click","valueChange"],[1,"ptable","rolerights",3,"value","rows","responsive","autoLayout"],["pTemplate","body"],[4,"ngFor","ngForOf"],["width","160px"],["label","",3,"options","checked","valueChange"]],template:function(s,a){1&s&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),e._UZ(5,"app-pageheader",5),e.qZA(),e.TgZ(6,"div",6)(7,"form",7)(8,"div",8)(9,"div",9),e._UZ(10,"app-input",10),e.ALo(11,"translate"),e.qZA(),e.TgZ(12,"div",9),e._UZ(13,"app-input",11),e.ALo(14,"translate"),e.qZA(),e.TgZ(15,"div",12),e._UZ(16,"app-checkbox",13),e.qZA(),e.TgZ(17,"div",14)(18,"app-button",15),e.NdJ("buttonOnClick",function(){return a.updateRecord()}),e.ALo(19,"translate"),e.qZA(),e.TgZ(20,"app-button",16),e.NdJ("buttonOnClick",function(){return a.cancel()}),e.ALo(21,"translate"),e.qZA()(),e.TgZ(22,"div",17),e._uU(23),e.ALo(24,"translate"),e.qZA()()(),e.TgZ(25,"div",18)(26,"div",2)(27,"div",19)(28,"div",20)(29,"p-accordion",21),e.YNc(30,ae,2,1,"span",22),e._UZ(31,"app-recordhistory",23),e.qZA()()()()()()()()()()),2&s&&(e.xp6(5),e.Q6J("pageName",a.dataJsonObj.pageName)("pageTitle",a.dataJsonObj.pageTitle)("selectedMenuId",null==a.dataJsonObj.queryParamsObj?null:a.dataJsonObj.queryParamsObj.selectedMenuId)("selectedSubMenuId",null==a.dataJsonObj.queryParamsObj?null:a.dataJsonObj.queryParamsObj.selectedSubMenuId)("showPageHeaderItems",!1)("showDependencySubMenu",!1),e.xp6(2),e.Q6J("formGroup",a.dataJsonObj.firstFormGroup),e.xp6(3),e.s9C("label",e.lcZ(11,23,"COMMON_PAGE_TITLES.ENTERPRISE")),e.s9C("value",null==a.dataJsonObj.inputObj||null==a.dataJsonObj.inputObj.enterprise?null:a.dataJsonObj.inputObj.enterprise.short_name),e.xp6(3),e.s9C("label",e.lcZ(14,25,"COMMON_FIELDS.ROLE")),e.s9C("value",null==a.dataJsonObj.inputObj?null:a.dataJsonObj.inputObj.user_type_display_name),e.xp6(3),e.Q6J("options",a.dataJsonObj.enabledOptions)("checked",null==a.dataJsonObj.inputObj?null:a.dataJsonObj.inputObj.is_enabled),e.xp6(2),e.s9C("label",e.lcZ(19,27,"COMMON_BUTTONS.BUTTON_SUBMIT")),e.xp6(2),e.s9C("label",e.lcZ(21,29,"COMMON_BUTTONS.BUTTON_CANCEL")),e.xp6(3),e.hij(" ",e.lcZ(24,31,a.errorObj.error)," "),e.xp6(6),e.Q6J("multiple",!0),e.xp6(1),e.Q6J("ngIf",a.dataJsonObj.inputObj.role_rights),e.xp6(1),e.Q6J("createdBy",null==a.dataJsonObj.recordData?null:a.dataJsonObj.recordData.created_by)("showrecordhistory",a.dataJsonObj.showrecordhistory)("lastUpdatedBy",null==a.dataJsonObj.recordData?null:a.dataJsonObj.recordData.updated_by)("creationDate",null==a.dataJsonObj.recordData?null:a.dataJsonObj.recordData.createdAt)("lastUpdatedDate",null==a.dataJsonObj.recordData?null:a.dataJsonObj.recordData.updatedAt))},dependencies:[T.UQ,T.US,v.h4,v.jx,f.sg,f.O5,m._Y,m.JL,m.sg,E.iA,L.r,w.a,B.b,P.W,R.q,j.X$]})}return o})();var ne=d(42919);const ie=["roleName"],Y=function(o){return[o]};function oe(o,b){if(1&o){const t=e.EpF();e.TgZ(0,"tr")(1,"td",32)(2,"app-checkbox",33),e.NdJ("valueChange",function(a){const i=e.CHM(t).$implicit,l=e.oxw(4);return e.KtG(l.changeCheckBoxValue(a,"is_enabled",i))}),e.qZA()()()}if(2&o){const t=b.$implicit;e.xp6(2),e.Q6J("options",e.VKq(2,Y,t))("checked",null==t?null:t.is_enabled)}}function re(o,b){if(1&o&&e.YNc(0,oe,3,4,"tr",31),2&o){const t=e.oxw().$implicit;e.Q6J("ngForOf",t.submenu)}}function le(o,b){if(1&o){const t=e.EpF();e.TgZ(0,"p-accordionTab",26)(1,"p-header",27)(2,"app-checkbox",28),e.NdJ("click",function(a){e.CHM(t);const n=e.oxw(2);return e.KtG(n.onMouseClick(a))})("valueChange",function(a){const i=e.CHM(t).$implicit,l=e.oxw(2);return e.KtG(l.changeCheckBoxValue(a,"is_enabled",i))}),e.qZA()(),e.TgZ(3,"p-table",29),e.YNc(4,re,1,1,"ng-template",30),e.qZA()()}if(2&o){const t=b.$implicit,s=e.oxw(2);e.MGl("id","",t.menu_management_id,"_tab_id"),e.Q6J("selected",!1),e.xp6(2),e.Q6J("options",e.VKq(8,Y,t))("checked",null==t?null:t.is_enabled),e.xp6(1),e.Q6J("value",s.dataJsonObj.data)("rows",1)("responsive",!0)("autoLayout",!1)}}function de(o,b){if(1&o&&(e.TgZ(0,"div",2)(1,"div",23)(2,"div",24)(3,"p-accordion"),e.YNc(4,le,5,10,"p-accordionTab",25),e.qZA()()()()),2&o){const t=e.oxw();e.xp6(4),e.Q6J("ngForOf",t.dataJsonObj.inputObj.role_rights)}}let ce=(()=>{class o extends M.O{formBuilder;loggerService;translateService;commonService;route;router;uiUtils;menuSettingsByRoleService;roleName;dataJsonObj={};errorObj={};constructor(t,s,a,n,i,l,u,c){super(i,n),this.formBuilder=t,this.loggerService=s,this.translateService=a,this.commonService=n,this.route=i,this.router=l,this.uiUtils=u,this.menuSettingsByRoleService=c}ngOnInit(){this.dataJsonObj.headerAction={BACK:!0},this.initializeComponent()}initializeComponent(){this.dataJsonObj.pageName=r.hf.MENU_SETTINGS_BY_ROLE,this.commonService.trackView(r.sn.ROLERIGHTS_CREATE),this.dataJsonObj.pageTitle=[{key:"COMMON_PAGE_TITLES.MENU_SETTINGS_BY_ROLE",value:"",showSubMenuDisplayName:!1},{key:"",value:"-",showSubMenuDisplayName:!1},{key:"COMMON_BUTTONS.BUTTON_CREATE",value:"",showSubMenuDisplayName:!1}],this.dataJsonObj.selectedEnterpriseId=localStorage.getItem(r.BU.SELECTED_ENTERPRISE),this.dataJsonObj.data=[{}],this.dataJsonObj.isSubmitButtonDisabled=!1,this.dataJsonObj.inputObj={is_enabled:!0},this.getDynamicJson([{folderName:"lookup_codes",jsonType:"list",storingFieldName:"lookupCodesListJson"},{folderName:"module_manager",jsonType:"list",storingFieldName:"moduleManagerListJson"},{folderName:"menu_manager",jsonType:"",storingFieldName:"menuManagerJson"},{folderName:r.sb.USER_TYPES,jsonType:"list",storingFieldName:"userTypesListJson"},{folderName:r.sb.USER_TYPES,jsonType:"view",storingFieldName:"userTypesViewJson"}]),this.dataJsonObj.inputObj.role_rights=[],this.dataJsonObj.existingUserTypeIds=[],this.dataJsonObj.existingUserTypesList=[],this.dataJsonObj.existingUserTypesByRole=[],this.dataJsonObj.availableUserTypesByRole=[],this.dataJsonObj.userTypepOptions=[],this.dataJsonObj.enabledOptions=[{value:"",displayname:this.translateService.instant("COMMON_FIELDS.ENABLED"),key:"checkbox1"}],this.dataJsonObj.selectedEnterpriseObj=this.commonService.getSelcetedEnterpriseObj(),this.dataJsonObj.inputObj.enterprise=this.dataJsonObj.selectedEnterpriseObj,this.dataJsonObj.firstFormGroup=this.formBuilder.group({firstCtrl:["",m.kI.required]})}getDynamicJson(t){var s=this;return(0,h.Z)(function*(){for(let a of t)try{s.dataJsonObj[a.storingFieldName]=yield s.commonService.getDynamicJson(s.dataJsonObj.selectedEnterpriseId,a.folderName,a.jsonType)}catch{s.dataJsonObj[a.storingFieldName]={}}s.getUserTypesByField()})()}getUserTypesByField(){var t=this;return(0,h.Z)(function*(){try{const s=yield t.menuSettingsByRoleService.getUserRolesFromRoleRights(t.dataJsonObj.selectedEnterpriseId);t.dataJsonObj.existingUserTypeIds=[],t.dataJsonObj.existingUserTypesList=[];for(let a of s)a.user_type_id&&(t.dataJsonObj.existingUserTypeIds.push(a.user_type_id),t.dataJsonObj.existingUserTypesList.push({ID:a.ID,NAME:t.dataJsonObj.userTypesViewJson&&t.dataJsonObj.userTypesViewJson[a.user_type_id+""]?t.dataJsonObj.userTypesViewJson[a.user_type_id+""].user_type_display_name:"",user_type_id:a.user_type_id}));t.dataJsonObj.userTypepOptions=t.dataJsonObj.userTypesListJson,t.dataJsonObj.availableUserTypes=t.dataJsonObj.userTypepOptions.filter(a=>-1===t.dataJsonObj.existingUserTypeIds.indexOf(a.ID)),yield t.getDynamicFieldsList()}catch(s){t.loggerService.setLoggerError(t.constructor.name,"getUserTypesByField",s)}})()}getDynamicFieldsList(){var t=this;return(0,h.Z)(function*(){try{t.dataJsonObj.inputObj.role_rights=yield t.menuSettingsByRoleService.getDynamicFieldsList(t.dataJsonObj.menuManagerJson,t.dataJsonObj.moduleManagerListJson)}catch(s){t.loggerService.setLoggerError(t.constructor.name,"getDynamicFieldsList",s)}})()}goBack(t){t.previous()}goForward(t){t.next()}onMouseClick(t){t.stopPropagation()}onAccordianClick(t){t.stopPropagation()}changeCheckBoxValue(t,s,a){try{a[s]=t.value}catch(n){this.loggerService.setLoggerError(this.constructor.name,"changeCheckBoxValue",n)}}changeInputFieldValue(t,s,a){const n=a?a.split("."):[];let i=this.dataJsonObj.inputObj;for(;n.length>0;){const l=n.shift();i[l]||(i[l]={}),i=i[l]}i[s]=t.value}changeDropDownFieldValue(t,s,a,n,i,l){try{if(t.value){this.errorObj.error="";const u=a.split(".");let c=this.dataJsonObj;for(let _ of u)c=c[_];const p=c.find(_=>_.ID===parseInt(t.value,10)),g={};for(let _ of i)g[_]=p[_],s===_&&!g[_]&&(g[_]=p.ID);const O=n.split("."),D=O.pop();let J=this.dataJsonObj.inputObj;for(;O.length>0;){const _=O.shift();J[_]||(J[_]={}),J=J[_]}J[D]=g,l&&this.dependencyFunction(l)}this.errorObj.error=""}catch(u){this.loggerService.setLoggerError(this.constructor.name,"changeApplication",u)}}changeSearchDropDownFieldValue(t,s,a,n,i){try{if(t){this.errorObj.error="";const l=t,u={};for(let p of n)u[p]=l[p],s===p&&!u[p]&&(u[p]=l.ID);let c=this.dataJsonObj.inputObj;if(a){const p=a.split("."),g=p.pop();for(;p.length>0;){const O=p.shift();c[O]||(c[O]={}),c=c[O]}c[g]=u}else{const p=Object.keys(u);for(let g of p)c[g]=u[g]}i&&this.dependencyFunction(i)}this.errorObj.error=""}catch(l){this.loggerService.setLoggerError(this.constructor.name,"changeApplication",l)}}dependencyFunction(t){"getExistingRoleInfo"===t&&this.getExistingRoleInfo(this.dataJsonObj.inputObj.originalUserType.ID)}getUserTypesData(t,s){var a=this;return(0,h.Z)(function*(){if(s){if(a.dataJsonObj.userTypepOptions.length>0){const n=yield a.commonService.getFilteredDynamicJSONData(a.dataJsonObj.userTypepOptions,"user_type_display_name",t);a.dataJsonObj.availableUserTypesByRole=a.dataJsonObj.existingUserTypeIds?.length>0?n.filter(i=>-1===a.dataJsonObj.existingUserTypeIds.indexOf(i.ID)):n}}else a.dataJsonObj.existingUserTypesByRole=yield a.commonService.getFilteredDynamicJSONData(a.dataJsonObj.existingUserTypesList,"NAME",t),a.getExistingRoleInfo(a.dataJsonObj.existingUserTypesByRole[0].ID)})()}getExistingRoleInfo(t){this.menuSettingsByRoleService.get(t).then(s=>{this.applyExistingRoleRightData(s.role_rights)},s=>{this.loggerService.setLoggerError(this.constructor.name,"getExistingRoleInfo",s)})}applyExistingRoleRightData(t){var s=this;return(0,h.Z)(function*(){const a=yield s.menuSettingsByRoleService.getSelectedRolesRightsDataJsonObj(t);a&&(yield s.menuSettingsByRoleService.updateSelectedRoleRightInRoleRightsArray(s.dataJsonObj.inputObj.role_rights,a))})()}cancel(){try{this.commonService.redirectToPreviousUrl()}catch(t){this.loggerService.setLoggerError(this.constructor.name,"cancel",t)}}createRecord(){try{this.roleName.isValid()&&(this.dataJsonObj.isSubmitButtonDisabled=!0,this.menuSettingsByRoleService.create({enterprise:this.dataJsonObj.inputObj.enterprise,user_type_id:this.dataJsonObj.inputObj.user_type_id,role_rights:this.dataJsonObj.inputObj.role_rights,is_enabled:!!this.dataJsonObj.inputObj.is_enabled&&this.dataJsonObj.inputObj.is_enabled}).then(s=>{this.uiUtils.displaytoastMessage("COMMON_TOAST_MESSAGES.TOAST_SUCCESS_CREATE"),this.commonService.redirectToPreviousUrl()},s=>{this.commonErrorCodes(JSON.parse(s)),this.loggerService.setLoggerError(this.constructor.name,"createRecord",s)}))}catch(t){this.loggerService.setLoggerError(this.constructor.name,"createRecord",t)}}commonErrorCodes(t){try{const s=JSON.parse(t[r.BU.STATUS]);409===s&&(this.errorObj.error="COMMON_STATUS_CODES."+s)}catch(s){this.loggerService.setLoggerError(this.constructor.name,"commonErrorCodes",s)}}pageheadeActionClick(t){"BACK"==t.value&&this.cancel()}static \u0275fac=function(s){return new(s||o)(e.Y36(m.qu),e.Y36(A.m),e.Y36(j.sK),e.Y36(I.v),e.Y36(y.gz),e.Y36(y.F0),e.Y36(C.s),e.Y36(S))};static \u0275cmp=e.Xpm({type:o,selectors:[["app-menusettingsbyrole-create"]],viewQuery:function(s,a){if(1&s&&e.Gf(ie,5),2&s){let n;e.iGM(n=e.CRH())&&(a.roleName=n.first)}},features:[e._Bn([S]),e.qOj],decls:31,vars:30,consts:[[1,"forms-wrapper"],[1,"row","g-0"],[1,"col-md-12"],[1,"card","bdt-0"],["id","stickyHeaderID",1,"card-header","card-header-primary"],[1,"subpage-header-title","w-100",3,"pageName","pageTitle","showPageHeaderItems","showDependencySubMenu"],[1,"card-body"],[3,"formGroup"],[1,"row","form-bs"],[1,"col-md-3"],["disabled","true","id","rolerights-create",3,"label","value"],[1,"col-md-4"],["mandatory","false","id","rolerights-create-existingusertype",3,"label","options","selectedOption","searchValueChange"],["mandatory","true","id","rolerights-create-usertype",3,"label","options","selectedOption","searchValueChange"],["roleName",""],[1,"col-md-2","d-flex","align-items-center"],["label","","mandatory","true","id","rolerights-create-checkboxoptions",3,"options","checked","valueChange"],[1,"col-md-12","text-end","mt-2","mb-2"],["className","btn btn-primary btn-sm",1,"mgr-5",3,"label","disabled","buttonOnClick"],["className","btn btn-danger btn-sm",3,"label","buttonOnClick"],[1,"error-msg","col-md-12","text-danger","text-center","mb-0"],[1,"row"],["class","col-md-12",4,"ngIf"],[1,"card"],["id","extraPaddingBottomID",1,"card-content"],[3,"selected","id",4,"ngFor","ngForOf"],[3,"selected","id"],[1,"d-flex","justify-content-between","w-100","accordion-header"],["label","","psClassName","accordion-checkbox",1,"rolerights-checkbox",3,"options","checked","click","valueChange"],[1,"ptable","rolerights",3,"value","rows","responsive","autoLayout"],["pTemplate","body"],[4,"ngFor","ngForOf"],["width","160px"],["label","",3,"options","checked","valueChange"]],template:function(s,a){1&s&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),e._UZ(5,"app-pageheader",5),e.qZA(),e.TgZ(6,"div",6)(7,"form",7)(8,"div",8)(9,"div",9),e._UZ(10,"app-input",10),e.ALo(11,"translate"),e.qZA(),e.TgZ(12,"div",11)(13,"app-dropdown-search",12),e.NdJ("selectedOption",function(i){return a.changeSearchDropDownFieldValue(i,"user_type_id","originalUserType",["ID","NAME","user_type_id"],"getExistingRoleInfo")})("searchValueChange",function(i){return a.getUserTypesData(i,!1)}),e.ALo(14,"translate"),e.qZA()(),e.TgZ(15,"div",9)(16,"app-dropdown-search",13,14),e.NdJ("selectedOption",function(i){return a.changeSearchDropDownFieldValue(i,"user_type_id","",["user_type_id"],"")})("searchValueChange",function(i){return a.getUserTypesData(i,!0)}),e.ALo(18,"translate"),e.qZA()(),e.TgZ(19,"div",15)(20,"app-checkbox",16),e.NdJ("valueChange",function(i){return a.changeCheckBoxValue(i,"is_enabled",a.dataJsonObj.inputObj)}),e.qZA()(),e.TgZ(21,"div",17)(22,"app-button",18),e.NdJ("buttonOnClick",function(){return a.createRecord()}),e.ALo(23,"translate"),e.qZA(),e.TgZ(24,"app-button",19),e.NdJ("buttonOnClick",function(){return a.cancel()}),e.ALo(25,"translate"),e.qZA()(),e.TgZ(26,"div",20),e._uU(27),e.ALo(28,"translate"),e.qZA()()(),e.TgZ(29,"div",21),e.YNc(30,de,5,1,"div",22),e.qZA()()()()()()),2&s&&(e.xp6(5),e.Q6J("pageName",a.dataJsonObj.pageName)("pageTitle",a.dataJsonObj.pageTitle)("showPageHeaderItems",!1)("showDependencySubMenu",!1),e.xp6(2),e.Q6J("formGroup",a.dataJsonObj.firstFormGroup),e.xp6(3),e.s9C("label",e.lcZ(11,18,"COMMON_PAGE_TITLES.ENTERPRISE")),e.s9C("value",null==a.dataJsonObj.inputObj.enterprise?null:a.dataJsonObj.inputObj.enterprise.short_name),e.xp6(3),e.s9C("label",e.lcZ(14,20,"ROLE_RIGHTS.EXISTING_ROLE")),e.Q6J("options",a.dataJsonObj.existingUserTypesByRole),e.xp6(3),e.s9C("label",e.lcZ(18,22,"COMMON_PAGE_TITLES.USER_ROLE")),e.Q6J("options",a.dataJsonObj.availableUserTypesByRole),e.xp6(4),e.Q6J("options",a.dataJsonObj.enabledOptions)("checked",null==a.dataJsonObj.inputObj?null:a.dataJsonObj.inputObj.is_enabled),e.xp6(2),e.s9C("label",e.lcZ(23,24,"COMMON_BUTTONS.BUTTON_SUBMIT")),e.s9C("disabled",a.dataJsonObj.isSubmitButtonDisabled),e.xp6(2),e.s9C("label",e.lcZ(25,26,"COMMON_BUTTONS.BUTTON_CANCEL")),e.xp6(3),e.hij(" ",e.lcZ(28,28,a.errorObj.error)," "),e.xp6(3),e.Q6J("ngIf",a.dataJsonObj.inputObj.role_rights))},dependencies:[T.UQ,T.US,v.h4,v.jx,f.sg,f.O5,m._Y,m.JL,m.sg,E.iA,L.r,w.a,B.b,ne.C,R.q,j.X$]})}return o})();var ue=d(60867);function pe(o,b){if(1&o&&(e.TgZ(0,"span",23),e._UZ(1,"app-page-dependency-menu",24),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("selectedObj",t.dataJsonObj.selectedObj)}}const U=function(o){return[o]};function ge(o,b){if(1&o&&(e.TgZ(0,"div",14),e._UZ(1,"app-checkbox",32),e.qZA()),2&o){const t=b.$implicit;e.xp6(1),e.Q6J("options",e.VKq(2,U,t))("checked",null==t?null:t.is_enabled)}}function be(o,b){if(1&o&&(e.TgZ(0,"tr")(1,"td",31),e._UZ(2,"app-checkbox",32),e.qZA(),e.TgZ(3,"td")(4,"div",18),e.YNc(5,ge,2,4,"div",33),e.qZA()()()),2&o){const t=b.$implicit;e.xp6(2),e.Q6J("options",e.VKq(3,U,t))("checked",null==t?null:t.is_enabled),e.xp6(3),e.Q6J("ngForOf",t.actions)}}function he(o,b){if(1&o&&e.YNc(0,be,6,5,"tr",30),2&o){const t=e.oxw().$implicit;e.Q6J("ngForOf",t.submenu)}}function me(o,b){if(1&o&&(e.TgZ(0,"p-accordionTab",26)(1,"p-header"),e._UZ(2,"app-checkbox",27),e.qZA(),e.TgZ(3,"p-table",28),e.YNc(4,he,1,1,"ng-template",29),e.qZA()()),2&o){const t=b.$implicit,s=e.oxw(2);e.MGl("id","",t.menu_management_id,"_tab_id"),e.Q6J("selected",!1),e.xp6(2),e.Q6J("options",e.VKq(8,U,t))("checked",null==t?null:t.is_enabled),e.xp6(1),e.Q6J("value",s.dataJsonObj.data)("rows",1)("responsive",!0)("autoLayout",!1)}}function Oe(o,b){if(1&o&&(e.TgZ(0,"span"),e.YNc(1,me,5,10,"p-accordionTab",25),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.dataJsonObj.dynamicRoleRights)}}const ye=[{path:"",data:{title:"Menu Settings List"},children:[{path:"list",canActivate:[N.P],component:W,data:{pageName:r.hf.MENU_SETTINGS_BY_ROLE}},{path:":id/edit",canActivate:[N.P],component:se,data:{pageName:r.hf.MENU_SETTINGS_BY_ROLE,pageSetting:r.AM.ACTIONS,settingField:r.In.EDIT}},{path:"create",canActivate:[N.P],component:ce,data:{pageName:r.hf.MENU_SETTINGS_BY_ROLE,pageSetting:r.AM.ACTIONS,settingField:r.In.CREATE}},{path:":id/view",canActivate:[N.P],component:(()=>{class o extends M.O{formBuilder;loggerService;translateService;commonService;route;router;uiUtils;menuSettingsByRoleService;dataJsonObj={};errorObj={};pageTitle;constructor(t,s,a,n,i,l,u,c){super(i,n),this.formBuilder=t,this.loggerService=s,this.translateService=a,this.commonService=n,this.route=i,this.router=l,this.uiUtils=u,this.menuSettingsByRoleService=c,this.route.queryParams.subscribe(p=>{this.dataJsonObj.queryParamsObj={defaultView:p.defaultView,selectedMenuId:p.selectedMenuId,selectedSubMenuId:p.selectedSubMenuId}})}ngOnInit(){this.dataJsonObj.headerAction={BACK:!0},this.initializeComponent()}initializeComponent(){this.dataJsonObj.pageName=r.hf.MENU_SETTINGS_BY_ROLE,this.commonService.trackView(r.sn.ROLERIGHTS_VIEW),this.route.params.subscribe(s=>{this.dataJsonObj.recordId=s.id}),this.dataJsonObj.selectedEnterpriseId=localStorage.getItem(r.BU.SELECTED_ENTERPRISE),this.dataJsonObj.data=[{}],this.getDynamicJson([{folderName:"lookup_codes",jsonType:"view",storingFieldName:"lookupCodesViewJson"},{folderName:"module_manager",jsonType:"list",storingFieldName:"moduleManagerListJson"},{folderName:"module_manager",jsonType:"view",storingFieldName:"moduleManagerViewJson"},{folderName:"menu_manager",jsonType:"",storingFieldName:"menuManagerJson"},{folderName:r.sb.USER_TYPES,jsonType:"view",storingFieldName:"userTypesViewJson"}]),this.dataJsonObj.dynamicRoleRights=[],this.dataJsonObj.showrecordhistory=this.roleRightsValidationByPage(r.hf.MENU_SETTINGS_BY_ROLE,r.AM.ACTIONS,r.In.RECORD_HISTORY),this.dataJsonObj.enabledOptions=[{value:"",displayname:this.translateService.instant("COMMON_FIELDS.ENABLED"),key:"checkbox1"}],this.dataJsonObj.firstFormGroup=this.formBuilder.group({firstCtrl:["",m.kI.required]}),this.dataJsonObj.selectedPage=r.hf.MENU_SETTINGS_BY_ROLE}getDynamicJson(t){var s=this;return(0,h.Z)(function*(){for(let a of t){try{s.dataJsonObj[a.storingFieldName]=yield s.commonService.getDynamicJson(s.dataJsonObj.selectedEnterpriseId,a.folderName,a.jsonType)}catch{s.dataJsonObj[a.storingFieldName]={}}s.getRecordById(s.dataJsonObj.recordId)}s.dataJsonObj.selectedObj={},s.dataJsonObj.selectedObj.recordId=s.dataJsonObj.recordId,s.dataJsonObj.selectedObj.pageObj=s.dataJsonObj.menuManagerJson.filter(a=>a.menu_page.page_name===s.dataJsonObj.selectedPage),s.dataJsonObj.selectedObjEnabled=!0})()}getDynamicFieldsList(){var t=this;return(0,h.Z)(function*(){try{t.dataJsonObj.dynamicRoleRights=yield t.menuSettingsByRoleService.getDynamicFieldsList(t.dataJsonObj.menuManagerJson,t.dataJsonObj.moduleManagerListJson),t.applyExistingRoleRightData(t.dataJsonObj.recordData.role_rights)}catch(s){t.loggerService.setLoggerError(t.constructor.name,"getDynamicFieldsList",s)}})()}getRecordById(t){try{this.menuSettingsByRoleService.get(t).then(s=>{this.dataJsonObj.recordData=s,this.dataJsonObj.recordData.user_type_display_name=this.dataJsonObj.recordData.user_type_id&&this.dataJsonObj.userTypesViewJson&&this.dataJsonObj.userTypesViewJson[this.dataJsonObj.recordData.user_type_id+""]?this.dataJsonObj.userTypesViewJson[this.dataJsonObj.recordData.user_type_id+""].user_type_display_name:"",this.dataJsonObj.pageTitle=[{key:"COMMON_PAGE_TITLES.SPORTS",value:this.dataJsonObj.recordData?.user_type_display_name,showSubMenuDisplayName:!1},{key:"",value:"-",showSubMenuDisplayName:!1},{key:"COMMON_BUTTONS.BUTTON_VIEW",value:"",showSubMenuDisplayName:!1}],this.getDynamicFieldsList()},s=>{this.loggerService.setLoggerError(this.constructor.name,"getRecordById",s)})}catch(s){this.loggerService.setLoggerError(this.constructor.name,"getRecordById",s)}}applyExistingRoleRightData(t){var s=this;return(0,h.Z)(function*(){const a=yield s.menuSettingsByRoleService.getSelectedRolesRightsDataJsonObj(t);a&&(yield s.menuSettingsByRoleService.updateSelectedRoleRightInRoleRightsArray(s.dataJsonObj.dynamicRoleRights,a))})()}cancel(){try{this.commonService.redirectToPreviousUrl()}catch(t){this.loggerService.setLoggerError(this.constructor.name,"cancel",t)}}pageheadeActionClick(t){"BACK"==t.value&&this.cancel()}static \u0275fac=function(s){return new(s||o)(e.Y36(m.qu),e.Y36(A.m),e.Y36(j.sK),e.Y36(I.v),e.Y36(y.gz),e.Y36(y.F0),e.Y36(C.s),e.Y36(S))};static \u0275cmp=e.Xpm({type:o,selectors:[["app-menusettingsbyrole-view"]],features:[e._Bn([S]),e.qOj],decls:29,vars:27,consts:[[1,"container-fluid"],[1,"forms-wrapper"],[1,"row","g-0"],[1,"col-md-12"],[1,"card","bdt-0"],["id","stickyHeaderID",1,"card-header","card-header-primary"],[1,"subpage-header-title","w-100",3,"pageName","pageTitle","selectedMenuId","selectedSubMenuId","showPageHeaderItems","showDependencySubMenu"],["class","d-flex align-items-center justify-content-center",4,"ngIf"],[1,"card-body"],[3,"formGroup"],[1,"row","form-bs"],[1,"col-md-3"],["disabled","true","id","rolerights-view-enterprise",3,"label","value"],["disabled","true","id","rolerights-view-role",3,"label","value"],[1,"col-md-2","d-flex","align-items-center"],["label","","id","rolerights-view-enabled","disabled","true","mandatory","false",3,"options","checked"],[1,"col-md-12","text-end","mt-2","mb-2"],["className","btn btn-danger btn-sm","id","rolerights-view-close",3,"label","buttonOnClick"],[1,"row"],[1,"card"],["id","extraPaddingBottomID",1,"card-content"],[4,"ngIf"],[3,"createdBy","showrecordhistory","lastUpdatedBy","creationDate","lastUpdatedDate"],[1,"d-flex","align-items-center","justify-content-center"],[3,"selectedObj"],[3,"selected","id",4,"ngFor","ngForOf"],[3,"selected","id"],["label","","disabled","true","psClassName","accordion-checkbox",1,"rolerights-checkbox",3,"options","checked"],[1,"ptable","rolerights",3,"value","rows","responsive","autoLayout"],["pTemplate","body"],[4,"ngFor","ngForOf"],["width","160px"],["label","","disabled","true",3,"options","checked"],["class","col-md-2 d-flex align-items-center",4,"ngFor","ngForOf"]],template:function(s,a){1&s&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"app-pageheader",6),e.YNc(7,pe,2,1,"span",7),e.qZA()(),e.TgZ(8,"div",8)(9,"form",9)(10,"div",10)(11,"div",11),e._UZ(12,"app-input",12),e.ALo(13,"translate"),e.qZA(),e.TgZ(14,"div",11),e._UZ(15,"app-input",13),e.ALo(16,"translate"),e.qZA(),e.TgZ(17,"div",14),e._UZ(18,"app-checkbox",15),e.qZA(),e.TgZ(19,"div",16)(20,"app-button",17),e.NdJ("buttonOnClick",function(){return a.cancel()}),e.ALo(21,"translate"),e.qZA()()()(),e.TgZ(22,"div",18)(23,"div",3)(24,"div",19)(25,"div",20)(26,"p-accordion"),e.YNc(27,Oe,2,1,"span",21),e._UZ(28,"app-recordhistory",22),e.qZA()()()()()()()()()()()),2&s&&(e.xp6(6),e.Q6J("pageName",a.dataJsonObj.pageName)("pageTitle",a.dataJsonObj.pageTitle)("selectedMenuId",null==a.dataJsonObj.queryParamsObj?null:a.dataJsonObj.queryParamsObj.selectedMenuId)("selectedSubMenuId",null==a.dataJsonObj.queryParamsObj?null:a.dataJsonObj.queryParamsObj.selectedSubMenuId)("showPageHeaderItems",!1)("showDependencySubMenu",!0),e.xp6(1),e.Q6J("ngIf",a.dataJsonObj.selectedObjEnabled),e.xp6(2),e.Q6J("formGroup",a.dataJsonObj.firstFormGroup),e.xp6(3),e.s9C("label",e.lcZ(13,21,"COMMON_PAGE_TITLES.ENTERPRISE")),e.s9C("value",null==a.dataJsonObj.recordData||null==a.dataJsonObj.recordData.enterprise?null:a.dataJsonObj.recordData.enterprise.short_name),e.xp6(3),e.s9C("label",e.lcZ(16,23,"COMMON_FIELDS.ROLE")),e.s9C("value",null==a.dataJsonObj.recordData?null:a.dataJsonObj.recordData.user_type_display_name),e.xp6(3),e.Q6J("options",a.dataJsonObj.enabledOptions)("checked",null==a.dataJsonObj.recordData?null:a.dataJsonObj.recordData.is_enabled),e.xp6(2),e.s9C("label",e.lcZ(21,25,"COMMON_BUTTONS.BUTTON_CLOSE")),e.xp6(7),e.Q6J("ngIf",a.dataJsonObj.dynamicRoleRights),e.xp6(1),e.Q6J("createdBy",null==a.dataJsonObj.recordData?null:a.dataJsonObj.recordData.created_by)("showrecordhistory",a.dataJsonObj.showrecordhistory)("lastUpdatedBy",null==a.dataJsonObj.recordData?null:a.dataJsonObj.recordData.updated_by)("creationDate",null==a.dataJsonObj.recordData?null:a.dataJsonObj.recordData.createdAt)("lastUpdatedDate",null==a.dataJsonObj.recordData?null:a.dataJsonObj.recordData.updatedAt))},dependencies:[T.UQ,T.US,v.h4,v.jx,f.sg,f.O5,m._Y,m.JL,m.sg,E.iA,L.r,w.a,B.b,P.W,R.q,ue.N,j.X$]})}return o})(),data:{pageName:r.hf.MENU_SETTINGS_BY_ROLE,pageSetting:r.AM.ACTIONS,settingField:r.In.VIEW}}]}];let je=(()=>{class o{static \u0275fac=function(s){return new(s||o)};static \u0275mod=e.oAB({type:o});static \u0275inj=e.cJS({imports:[y.Bz.forChild(ye),y.Bz]})}return o})(),Se=(()=>{class o{static \u0275fac=function(s){return new(s||o)};static \u0275mod=e.oAB({type:o});static \u0275inj=e.cJS({imports:[T.fx,f.ez,m.u5,m.UX,E.U$,j.aw,G.dp,q.Q,je]})}return o})()}}]);